{
  "version": "2.0.0",
  "pipeline_id": "join-demo-pipeline",
  "name": "Join Demo Pipeline",
  "source": {
    "type": "kafka",
    "connection_params": {
      "brokers": [
        "kafka.glassflow.svc.cluster.local:9092"
      ],
      "protocol": "SASL_PLAINTEXT",
      "mechanism": "PLAIN",
      "username": "user1",
      "password": "glassflow-demo-password"
    },
    "topics": [
      {
        "consumer_group_initial_offset": "latest",
        "name": "user_events",
        "deduplication": {
          "enabled": false
        }
      },
      {
        "consumer_group_initial_offset": "latest",
        "name": "orders",
        "deduplication": {
          "enabled": false
        }
      }
    ]
  },
  "join": {
    "enabled": true,
    "type": "temporal",
    "sources": [
      {
        "source_id": "user_events",
        "join_key": "user.id",
        "join_key_type": "string",
        "time_window": "1h",
        "orientation": "right"
      },
      {
        "source_id": "orders",
        "join_key": "user_id",
        "join_key_type": "string",
        "time_window": "1h",
        "orientation": "left"
      }
    ]
  },
  "sink": {
    "type": "clickhouse",
    "host": "clickhouse.glassflow.svc.cluster.local",
    "port": "9000",
    "http_port": "8123",
    "database": "default",
    "username": "default",
    "password": "Z2xhc3NmbG93LWRlbW8tcGFzc3dvcmQ=",
    "secure": false,
    "max_batch_size": 1000,
    "max_delay_time": "10s",
    "table": "orders_with_user_data"
  },
  "schema": {
    "fields": [
      {
        "source_id": "orders",
        "name": "order_id",
        "type": "string",
        "column_name": "order_id",
        "column_type": "UUID"
      },
      {
        "source_id": "orders",
        "name": "user_id",
        "type": "string",
        "column_name": "user_id",
        "column_type": "UUID"
      },
      {
        "source_id": "user_events",
        "name": "user.id",
        "type": "string"
      },
      {
        "source_id": "user_events",
        "name": "user.name",
        "type": "string",
        "column_name": "name",
        "column_type": "String"
      },
      {
        "source_id": "user_events",
        "name": "user.email",
        "type": "string",
        "column_name": "email",
        "column_type": "String"
      },
      {
        "source_id": "orders",
        "name": "amount",
        "type": "int32",
        "column_name": "amount",
        "column_type": "Int32"
      },
      {
        "source_id": "orders",
        "name": "price",
        "type": "float32",
        "column_name": "price",
        "column_type": "Float32"
      },
      {
        "source_id": "orders",
        "name": "created_at",
        "type": "string",
        "column_name": "created_at",
        "column_type": "DateTime"
      },
      {
        "source_id": "user_events",
        "name": "tags",
        "type": "array",
        "column_name": "tags",
        "column_type": "Array(String)"
      }
    ]
  }
}
