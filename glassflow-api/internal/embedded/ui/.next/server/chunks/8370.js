"use strict";exports.id=8370,exports.ids=[8370],exports.modules={3251:(a,b,c)=>{c.d(b,{A0:()=>g,BF:()=>h,Hj:()=>i,XI:()=>f,nA:()=>k,nd:()=>j});var d=c(48477);c(48296);var e=c(84621);function f({className:a,...b}){return(0,d.jsx)("div",{"data-slot":"table-container",className:"relative w-full overflow-x-auto",children:(0,d.jsx)("table",{"data-slot":"table",className:(0,e.cn)("w-full caption-bottom text-sm",a),...b})})}function g({className:a,...b}){return(0,d.jsx)("thead",{"data-slot":"table-header",className:(0,e.cn)("[&_tr]:border-b",a),...b})}function h({className:a,...b}){return(0,d.jsx)("tbody",{"data-slot":"table-body",className:(0,e.cn)("[&_tr:last-child]:border-0",a),...b})}function i({className:a,...b}){return(0,d.jsx)("tr",{"data-slot":"table-row",className:(0,e.cn)("hover:bg-muted/50 data-[state=selected]:bg-muted border-b transition-colors",a),...b})}function j({className:a,...b}){return(0,d.jsx)("th",{"data-slot":"table-head",className:(0,e.cn)("text-muted-foreground h-10 px-2 text-left align-middle font-medium whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",a),...b})}function k({className:a,...b}){return(0,d.jsx)("td",{"data-slot":"table-cell",className:(0,e.cn)("p-2 align-middle whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",a),...b})}},5862:(a,b,c)=>{c.d(b,{A:()=>d});let d={src:"/_next/static/media/loader-small.ac73cbe2.svg",height:24,width:24,blurWidth:0,blurHeight:0}},8527:(a,b,c)=>{c.d(b,{z:()=>n});var d=c(48477),e=c(48296),f=c(64708),g=c(98489),h=c(84621),i=c(65357),j=c(26186),k=c(39293),l=c(46298),m=c(65775);function n({onCompleteStep:a,index:b=0,readOnly:c,standalone:n,toggleEditMode:o,pipelineActionState:p,onCompleteStandaloneEditing:q}){let r=(0,k.U)(),s=(0,m.D)(),{coreStore:t}=(0,f.useStore)(),u=(0,f.useStore)(a=>a.deduplicationStore.getDeduplication(b)),v=(0,f.useStore)(a=>a.deduplicationStore.updateDeduplication),w=(0,f.useStore)(a=>a.topicsStore.getTopic(b)),x=w?.selectedEvent,y=x?.event||null,[z,A]=(0,e.useState)(!1),B=u||{enabled:!1,window:0,unit:"hours",key:"",keyType:"string"},C=!!(B.key&&B.window&&B.unit),D=(0,e.useCallback)(({key:a,keyType:c},{window:d,unit:e})=>{v(b,{enabled:!0,window:d,unit:e,key:a,keyType:c}),r.key.dedupKey({keyType:c,window:d,unit:e})},[b,v,r.key]),E=(0,e.useCallback)(()=>{w?.name&&(s.onSectionConfigured(i.Fn.DEDUPLICATION_CONFIGURATOR),n&&o?(A(!0),q?.()):a(i.Fn.DEDUPLICATION_CONFIGURATOR))},[w,a,s,n,o]),F=(0,e.useCallback)(()=>{t.discardSection("deduplication")},[t]);return w?y?(0,d.jsxs)("div",{className:"flex flex-col gap-8",children:[(0,d.jsxs)("div",{className:"flex gap-4",children:[(0,d.jsx)("div",{className:"flex flex-col gap-12 w-[40%]",children:(0,d.jsx)(j.A,{index:b,onChange:D,disabled:!w?.name,eventData:y,readOnly:c},`dedup-keys-${w.name}-${Date.now()}`)}),(0,d.jsx)("div",{className:"w-[60%] min-h-[400px]",children:(0,d.jsx)(g.E,{event:(0,h.$c)(y),topic:w?.name,isLoadingEvent:!1,eventError:"",isEmptyTopic:!1,onManualEventChange:()=>{},isEditingEnabled:!1,readOnly:c})})]}),(0,d.jsx)(l.A,{standalone:n,onSubmit:E,onDiscard:F,isLoading:!1,isSuccess:z,disabled:!C,successText:"Continue",loadingText:"Loading...",regularText:"Continue",actionType:"primary",showLoadingIcon:!1,readOnly:c,toggleEditMode:o,pipelineActionState:p,onClose:q})]}):(0,d.jsxs)("div",{children:['No event data available for topic "',w.name,'". Please ensure the topic has been configured with event data.']}):(0,d.jsxs)("div",{children:["No topic data available for index ",b]})}},9093:(a,b,c)=>{c.d(b,{E:()=>g});var d=c(48296),e=c(64708),f=c(39293);let g=()=>{let{clickhouseConnectionStore:a,clickhouseDestinationStore:b}=(0,e.useStore)(),{clickhouseConnection:c,setClickhouseConnection:g,updateDatabases:h}=a,i=(0,f.U)(),[j,k]=(0,d.useState)(!1),[l,m]=(0,d.useState)("idle"),[n,o]=(0,d.useState)(null),p=(0,d.useCallback)(async a=>{k(!0),m("idle"),o(null);try{let b={host:a.host,httpPort:a.httpPort,username:a.username,password:a.password,database:a.database||"",useSSL:a.useSSL??!0,skipCertificateVerification:a.skipCertificateVerification??!0,connectionType:a.connectionType||"direct",proxyUrl:a.proxyUrl,connectionString:a.connectionString,testType:"connection"},c=await fetch("/ui-api/clickhouse/test-connection",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(b)}),d=await c.json();if(d.success){if(m("success"),o(null),g({connectionType:"direct",directConnection:{host:a.host,httpPort:a.httpPort,username:a.username,password:a.password,nativePort:a.nativePort??"",useSSL:a.useSSL??!0,skipCertificateVerification:a.skipCertificateVerification??!0},connectionStatus:"success",connectionError:null}),d.databases&&d.databases.length>0){let b=`${a.host}:${a.httpPort}`;h(d.databases,b)}return i.clickhouse.success({host:a.host,databaseCount:d.databases?.length||0}),{success:!0,databases:d.databases||[]}}{m("error");let b=d.error||"Test connection failed - Failed to connect to ClickHouse";return o(b),i.clickhouse.failed({error:b,host:a.host}),{success:!1,error:b}}}catch(c){m("error");let b=c instanceof Error?c.message:"An unknown error occurred";return o(b),i.clickhouse.failed({error:b,host:a.host}),{success:!1,error:b}}finally{k(!1)}},[g,h,i]),q=(0,d.useCallback)(async a=>{if(!a.database)return o("Please select a database"),{success:!1,error:"Please select a database"};k(!0),m("idle"),o(null);try{let b={host:a.host,httpPort:a.httpPort,username:a.username,password:a.password,database:a.database,useSSL:a.useSSL??!0,skipCertificateVerification:a.skipCertificateVerification??!0,connectionType:a.connectionType||"direct",proxyUrl:a.proxyUrl,connectionString:a.connectionString,testType:"database"},c=await fetch("/ui-api/clickhouse/test-connection",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(b)}),d=await c.json();if(d.success)return m("success"),o(null),g({connectionType:"direct",directConnection:{host:a.host,httpPort:a.httpPort,username:a.username,password:a.password,nativePort:a.nativePort??"",useSSL:a.useSSL??!0,skipCertificateVerification:a.skipCertificateVerification??!0},connectionStatus:"success",connectionError:null}),i.destination.tablesFetched({database:a.database,count:d.tables?.length||0}),{success:!0,tables:d.tables||[]};{m("error");let b=d.error||`Failed to access database '${a.database}'`;return o(b),i.destination.tableFetchedError({database:a.database,error:b}),{success:!1,error:b}}}catch(c){m("error");let b=c instanceof Error?c.message:"An unknown error occurred";return o(b),i.destination.tableFetchedError({database:a.database,error:b}),{success:!1,error:b}}finally{k(!1)}},[g,i]);return{isLoading:j,connectionStatus:l,connectionError:n,testConnection:p,testDatabaseAccess:q,testTableAccess:(0,d.useCallback)(async a=>{if(!a.database||!a.table)return o("Please select both database and table"),{success:!1,error:"Please select both database and table"};k(!0),m("idle"),o(null);try{let b={host:a.host,httpPort:a.httpPort,username:a.username,password:a.password,database:a.database,table:a.table,useSSL:a.useSSL??!0,skipCertificateVerification:a.skipCertificateVerification??!0,connectionType:a.connectionType||"direct",proxyUrl:a.proxyUrl,connectionString:a.connectionString,testType:"table"},c=await fetch("/ui-api/clickhouse/test-connection",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(b)}),d=await c.json();if(d.success)return m("success"),o(null),g({connectionType:"direct",directConnection:{host:a.host,httpPort:a.httpPort,username:a.username,password:a.password,nativePort:a.nativePort??"",useSSL:a.useSSL??!0,skipCertificateVerification:a.skipCertificateVerification??!0},connectionStatus:"success",connectionError:null}),i.destination.tableSelected({database:a.database,table:a.table}),{success:!0,sample:d.sample};{m("error");let b=d.error||`Failed to access table '${a.table}' in database '${a.database}'`;return o(b),i.destination.tableFetchedError({database:a.database,table:a.table,error:b}),{success:!1,error:b}}}catch(c){m("error");let b=c instanceof Error?c.message:"An unknown error occurred";return o(b),i.destination.tableFetchedError({database:a.database,table:a.table,error:b}),{success:!1,error:b}}finally{k(!1)}},[g,i]),getDatabases:(0,d.useCallback)(async a=>{if(!a.host||!a.httpPort||!a.username||!a.password)return o("Please fill in all fields"),{success:!1,error:"Please fill in all fields"};let b=await fetch("/ui-api/clickhouse/databases",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...a})});return await b.json()},[])}}},13556:(a,b,c)=>{c.d(b,{g7:()=>f});var d=c(69);let e=d.Ik({host:d.Yj().min(1,"Host is required"),httpPort:d.Yj().min(1,"HTTP(S) Port is required"),username:d.Yj().min(1,"Username is required"),password:d.Yj().min(1,"Password is required"),database:d.Yj().optional(),useSSL:d.zM().optional(),nativePort:d.Yj().min(1,"Native Port is required"),skipCertificateVerification:d.zM().optional()}),f=d.Ik({connectionType:d.eu("direct"),directConnection:e,connectionStatus:d.k5(["idle","loading","success","error"]).optional(),connectionError:d.Yj().nullable().optional()}),g=d.Ik({name:d.Yj(),type:d.Yj(),jsonType:d.Yj().optional(),isNullable:d.zM().optional(),isKey:d.zM().optional(),eventField:d.Yj().optional(),sourceTopic:d.Yj().optional()});d.Ik({scheme:d.Yj().min(1,"Scheme is required"),database:d.Yj().min(1,"Database is required"),table:d.Yj().min(1,"Table is required"),mapping:d.YO(g),destinationColumns:d.YO(g),maxBatchSize:d.ai().min(1,"Max Batch Size is required"),maxDelayTime:d.ai().min(1,"Max Delay Time is required")})},15831:(a,b,c)=>{c.d(b,{bq:()=>l,eb:()=>n,gC:()=>m,l6:()=>j,yv:()=>k});var d=c(48477);c(48296);var e=c(69823),f=c(93755),g=c(76665),h=c(45014),i=c(84621);function j({...a}){return(0,d.jsx)(e.bL,{"data-slot":"select",...a})}function k({...a}){return(0,d.jsx)(e.WT,{"data-slot":"select-value",...a})}function l({className:a,size:b="default",children:c,...g}){return(0,d.jsxs)(e.l9,{"data-slot":"select-trigger","data-size":b,className:(0,i.cn)("border-input data-[placeholder]:text-muted-foreground [&_svg:not([class*='text-'])]:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 dark:hover:bg-input/50 flex w-fit items-center justify-between gap-2 rounded-md border bg-transparent px-3 py-2 text-sm whitespace-nowrap shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 data-[size=default]:h-9 data-[size=sm]:h-8 *:data-[slot=select-value]:line-clamp-1 *:data-[slot=select-value]:flex *:data-[slot=select-value]:items-center *:data-[slot=select-value]:gap-2 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",a),...g,children:[c,(0,d.jsx)(e.In,{asChild:!0,children:(0,d.jsx)(f.A,{className:"size-4 opacity-50"})})]})}function m({className:a,children:b,position:c="popper",...f}){return(0,d.jsx)(e.ZL,{children:(0,d.jsxs)(e.UC,{"data-slot":"select-content",className:(0,i.cn)("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 relative z-40 max-h-(--radix-select-content-available-height) min-w-[8rem] overflow-x-hidden overflow-y-auto rounded-md border shadow-md","popper"===c&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",a),position:c,...f,children:[(0,d.jsx)(o,{}),(0,d.jsx)(e.LM,{className:(0,i.cn)("p-1","popper"===c&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)] scroll-my-1"),children:b}),(0,d.jsx)(p,{})]})})}function n({className:a,children:b,...c}){return(0,d.jsxs)(e.q7,{"data-slot":"select-item",className:(0,i.cn)("focus:bg-accent focus:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex w-full cursor-default items-center gap-2 rounded-sm py-1.5 pr-8 pl-2 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4 *:[span]:last:flex *:[span]:last:items-center *:[span]:last:gap-2",a),...c,children:[(0,d.jsx)("span",{className:"absolute right-2 flex size-3.5 items-center justify-center",children:(0,d.jsx)(e.VF,{children:(0,d.jsx)(g.A,{className:"size-4"})})}),(0,d.jsx)(e.p4,{children:b})]})}function o({className:a,...b}){return(0,d.jsx)(e.PP,{"data-slot":"select-scroll-up-button",className:(0,i.cn)("flex cursor-default items-center justify-center py-1",a),...b,children:(0,d.jsx)(h.A,{className:"size-4"})})}function p({className:a,...b}){return(0,d.jsx)(e.wn,{"data-slot":"select-scroll-down-button",className:(0,i.cn)("flex cursor-default items-center justify-center py-1",a),...b,children:(0,d.jsx)(f.A,{className:"size-4"})})}},19677:(a,b,c)=>{c.d(b,{BT:()=>i,Wu:()=>j,ZB:()=>h,Zp:()=>f,aR:()=>g});var d=c(48477);c(48296);var e=c(84621);function f({className:a,...b}){return(0,d.jsx)("div",{"data-slot":"card",className:(0,e.cn)("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",a),...b})}function g({className:a,...b}){return(0,d.jsx)("div",{"data-slot":"card-header",className:(0,e.cn)("flex flex-col gap-1.5 px-6",a),...b})}function h({className:a,...b}){return(0,d.jsx)("div",{"data-slot":"card-title",className:(0,e.cn)("leading-none font-semibold",a),...b})}function i({className:a,...b}){return(0,d.jsx)("div",{"data-slot":"card-description",className:(0,e.cn)("text-muted-foreground text-sm",a),...b})}function j({className:a,...b}){return(0,d.jsx)("div",{"data-slot":"card-content",className:(0,e.cn)("px-6",a),...b})}},19683:(a,b,c)=>{c.d(b,{x:()=>m});var d=c(48477),e=c(15831),f=c(95101),g=c(4179),h=c(65357),i=c(78864),j=c(49853),k=c(42242),l=c(48296);function m({window:a,setWindow:b,windowUnit:c,setWindowUnit:m,label:n="Deduplication Time Window",tooltip:o="Maximum time window is 7 days. Longer time windows can process more events but may result in slower performance.",readOnly:p}){let[q,r]=(0,l.useState)(null),s=(a,b)=>{switch(b){case h.XR.DAYS.value:if(a>7)return r("Maximum time window is 7 days"),!1;break;case h.XR.HOURS.value:if(a>168)return r("Maximum time window is 168 hours (7 days)"),!1;break;case h.XR.MINUTES.value:if(a>10080)return r("Maximum time window is 10080 minutes (7 days)"),!1;break;case h.XR.SECONDS.value:if(a>604800)return r("Maximum time window is 604800 seconds (7 days)"),!1}return r(null),!0};return(0,d.jsxs)("div",{className:"flex flex-col gap-2 w-full",children:[(0,d.jsxs)("div",{className:"flex items-center gap-2",children:[(0,d.jsx)(f.J,{htmlFor:"window-unit",className:"label-regular text-content",children:n}),(0,d.jsxs)(k.m_,{children:[(0,d.jsx)(k.k$,{asChild:!0,children:(0,d.jsx)(i.default,{src:j.A,alt:"Info",className:"w-4 h-4"})}),(0,d.jsx)(k.ZI,{side:"right",align:"start",className:"max-w-[300px] bg-gray-800 text-gray-100 border border-gray-700 rounded-lg p-3 shadow-lg",children:(0,d.jsx)("p",{className:"text-sm leading-relaxed",children:o})})]})]}),(0,d.jsxs)("div",{className:"flex flex-col gap-2 w-full",children:[(0,d.jsxs)("div",{className:"flex gap-4",children:[(0,d.jsx)("div",{className:"w-[35%] max-w-[35%]",children:(0,d.jsx)(g.p,{id:"window-size",type:"number",value:a,onChange:a=>(a=>{let d=parseInt(a);s(d,c)&&b(d)})(a.target.value),min:"1",className:`w-full input-regular input-border-regular text-content ${q?"border-red-500":""}`,disabled:p})}),(0,d.jsx)("div",{className:"w-[65%] max-w-[65%]",children:(0,d.jsxs)(e.l6,{value:c,onValueChange:b=>{s(a,b)&&m(b)},disabled:p,children:[(0,d.jsx)(e.bq,{id:"window-unit",className:"w-full input-regular select-content-custom text-content",children:(0,d.jsx)(e.yv,{placeholder:"Select unit"})}),(0,d.jsx)(e.gC,{className:"select-content-custom",children:Object.values(h.XR).map(a=>(0,d.jsx)(e.eb,{value:a.value,className:"select-item-custom text-content",children:a.label},a.value))})]})})]}),q&&(0,d.jsx)("p",{className:"text-sm text-red-500",children:q})]})]})}},22317:(a,b,c)=>{c.d(b,{Y:()=>e});class d{buildAuthHeaders(a){let b={servers:a.bootstrapServers,securityProtocol:a.securityProtocol,authMethod:a.authMethod};if("SASL_SSL"===a.securityProtocol||"SSL"===a.securityProtocol)switch(a.authMethod){case"NO_AUTH":a.noAuth?.truststore?.certificates&&(b.certificate=a.noAuth.truststore.certificates);break;case"SASL/PLAIN":a.saslPlain?.truststore?.certificates&&(b.certificate=a.saslPlain.truststore.certificates);break;case"SASL/GSSAPI":a.saslGssapi?.truststore?.certificates&&(b.certificate=a.saslGssapi.truststore.certificates);break;case"SASL/SCRAM-256":a.saslScram256?.truststore?.certificates&&(b.certificate=a.saslScram256.truststore.certificates);break;case"SASL/SCRAM-512":a.saslScram512?.truststore?.certificates&&(b.certificate=a.saslScram512.truststore.certificates)}switch(a.authMethod){case"NO_AUTH":break;case"SASL/PLAIN":b.username=a.saslPlain.username,b.password=a.saslPlain.password,b.consumerGroup=a.saslPlain.consumerGroup;break;case"SASL/JAAS":b.jaasConfig=a.saslJaas.jaasConfig;break;case"SASL/GSSAPI":b.kerberosPrincipal=a.saslGssapi.kerberosPrincipal,b.kerberosKeytab=a.saslGssapi.kerberosKeytab,b.kerberosRealm=a.saslGssapi.kerberosRealm,b.kdc=a.saslGssapi.kdc,b.serviceName=a.saslGssapi.serviceName,b.krb5Config=a.saslGssapi.krb5Config;break;case"SASL/OAUTHBEARER":b.oauthBearerToken=a.saslOauthbearer.oauthBearerToken;break;case"SASL/SCRAM-256":case"SASL/SCRAM-512":let c="SASL/SCRAM-256"===a.authMethod?a.saslScram256:a.saslScram512;b.username=c.username,b.password=c.password,b.consumerGroup=c.consumerGroup;break;case"AWS_MSK_IAM":b.awsRegion=a.awsIam.awsRegion,b.awsIAMRoleArn=a.awsIam.awsIAMRoleArn,b.awsAccessKey=a.awsIam.awsAccessKey,b.awsAccessKeySecret=a.awsIam.awsAccessKeySecret;break;case"Delegation tokens":b.delegationToken=a.delegationTokens.delegationToken;break;case"SASL/LDAP":b.ldapServerUrl=a.ldap.ldapServerUrl,b.ldapServerPort=a.ldap.ldapServerPort,b.ldapBindDn=a.ldap.ldapBindDn,b.ldapBindPassword=a.ldap.ldapBindPassword,b.ldapUserSearchFilter=a.ldap.ldapUserSearchFilter,b.ldapBaseDn=a.ldap.ldapBaseDn;break;case"mTLS":b.clientCert=a.mtls.clientCert,b.clientKey=a.mtls.clientKey,b.password=a.mtls.password}return b}async fetchTopics(a){if(!a.bootstrapServers)return{success:!1,error:"Kafka connection details are missing"};try{let b=this.buildAuthHeaders(a),c=await fetch("/ui-api/kafka/topics",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(b)}),d=await c.json();if(d.success)return{success:!0,topics:d.topics};return{success:!1,error:d.error||"Failed to fetch topics"}}catch(a){return{success:!1,error:"Error connecting to Kafka"}}}async fetchTopicDetails(a){if(!a.bootstrapServers)return{success:!1,error:"Kafka connection details are missing"};try{let b=this.buildAuthHeaders(a),c=await fetch("/ui-api/kafka/topic-details",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(b)}),d=await c.json();if(d.success)return{success:!0,topicDetails:d.topicDetails};return{success:!1,error:d.error||"Failed to fetch topic details"}}catch(a){return{success:!1,error:"Error connecting to Kafka"}}}async fetchEvent(a,b){if(!a.bootstrapServers||!b.topic)return{success:!1,error:"Missing required parameters: bootstrapServers or topic"};let c=this.buildAuthHeaders(a),d={servers:c.servers,securityProtocol:c.securityProtocol,authMethod:c.authMethod,...c,...b};try{let a=await fetch("/ui-api/kafka/events",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(d)});if(!a.ok){let b=await a.text();return{success:!1,error:`HTTP ${a.status}: ${b}`}}let b=await a.json();return{success:!0,data:b,event:b.event,offset:b.offset,position:b.position}}catch(a){return{success:!1,error:a instanceof Error?a.message:"Unknown error occurred"}}}}let e=new d},24294:(a,b,c)=>{c.d(b,{B:()=>B});var d=c(48477),e=c(48296),f=c(64708),g=c(65357),h=c(22317),i=c(84621),j=c(78864),k=c(5862),l=c(62992),m=c(80152);function n({value:a,onChange:b,onBlur:c,onOpenChange:f,error:g,placeholder:h,options:j,readOnly:k,standalone:n,label:o,onRefresh:p}){let[q,r]=(0,e.useState)(!1),s=(0,e.useMemo)(()=>j.reduce((a,b)=>(a[b.value]=b.label,a),{}),[j]),t=(0,e.useMemo)(()=>j.map(a=>a.label),[j]),u=a?s[a]:"";return(0,d.jsxs)("div",{className:"flex items-center justify-between gap-2",children:[(0,d.jsx)("div",{className:"relative w-full",children:(0,d.jsx)(l.Z,{availableOptions:t,selectedOption:u,onSelect:a=>{if(!a){b(""),c();return}let d=j.find(b=>b.label===a);d&&(b(d.value),c())},placeholder:h,disabled:k,clearable:!0,open:q,onOpenChange:a=>{r(a),f(a)},readOnly:k,className:(0,i.cn)("w-full",g&&"[&_input]:border-red-500 [&_input]:border-2"),label:o})}),p&&(0,d.jsx)("div",{className:"flex-shrink-0 mb-1.5",children:(0,d.jsx)(m.Q,{disabled:k,type:"topics",onRefresh:p,size:"sm",variant:"ghost",className:"transform transition-all duration-300 ease-in-out translate-y-4 opacity-0 animate-[fadeIn_0.3s_ease-in-out_forwards]"})})]})}var o=c(15831);function p({value:a,onChange:b,onBlur:c,onOpenChange:f,error:g,placeholder:h,options:j,readOnly:k,standalone:l,label:m}){let[n,p]=(0,e.useState)(!1);return(0,d.jsxs)("div",{className:"relative w-full",children:[(0,d.jsx)("div",{className:"flex items-center gap-2 mb-2",children:m&&(0,d.jsx)("span",{className:"text-sm text-content",children:m})}),(0,d.jsxs)(o.l6,{disabled:k,value:a,defaultValue:a,onValueChange:a=>{b(a),c()},onOpenChange:a=>{p(a)},children:[(0,d.jsx)(o.bq,{className:(0,i.cn)("w-full","input-regular","input-border-regular","transition-all duration-200 ease-in-out","text-content",g&&"input-border-error",n&&"input-active scale-[1.01]"),onFocus:()=>p(!0),onBlur:()=>{document.querySelector('[data-state="open"]')||(p(!1),c())},children:(0,d.jsx)(o.yv,{placeholder:h})}),(0,d.jsx)(o.gC,{className:"select-content-custom animate-fadeIn",children:0===j.length?(0,d.jsx)("div",{className:"p-2 animate-pulse",children:"No options found"}):j.map(a=>(0,d.jsx)(o.eb,{value:a.value,className:"select-item-custom transition-colors duration-150 hover:scale-[1.02] transition-transform text-content",children:a.label},`${a.value}`))})]})]})}function q({topicValue:a,isLoadingEvent:b,offsetValue:c,onTopicChange:g,onOffsetChange:h,onBlur:i,onOpenChange:j,topicError:k,offsetError:l,topicPlaceholder:m,offsetPlaceholder:o,topicOptions:q,offsetOptions:r,index:s,readOnly:t,disableTopicChange:u,onRefreshTopics:v}){let[w,x]=(0,e.useState)(!1),{topicsStore:y}=(0,f.useStore)(),{updateTopic:z}=y,A=(0,e.useCallback)(b=>{g(b),b!==a&&z({index:s,name:b,initialOffset:c,events:[],selectedEvent:{topicIndex:s,position:c,event:void 0}})},[a,c,s,g,z]),B=(0,e.useCallback)(b=>{h(b),b!==c&&(z({index:s,name:a,initialOffset:b,events:[],selectedEvent:{topicIndex:s,position:b,event:void 0}}),a&&z({index:s,name:a,initialOffset:b,events:[],selectedEvent:{topicIndex:s,position:b,event:void 0}}))},[a,c,s,h,z]);return(0,d.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,d.jsx)(n,{value:a,onChange:A,onBlur:i,onOpenChange:j,error:k,placeholder:m,options:q,readOnly:u||t,label:"Source Topic",onRefresh:v,...u&&!t?{title:"Topic cannot be changed when editing a pipeline. To use a different topic, create a new pipeline."}:{}}),a&&(0,d.jsx)(p,{value:c,onChange:B,onBlur:i,onOpenChange:j,error:l,placeholder:o,options:r,readOnly:t||b,label:"Initial Offset"})]})}var r=c(98489);let s=function({topicName:a,topicIndex:b,initialOffset:c,initialEvent:f,onEventLoading:g,onEventLoaded:h,onEventError:j,onEmptyTopic:k,onManualEventChange:l,isEditingEnabled:m,readOnly:n,fetchNewestEvent:o,fetchOldestEvent:p,fetchNextEvent:q,fetchPreviousEvent:s,refreshEvent:t,currentOffset:u,earliestOffset:v,latestOffset:w,isAtLatest:x,isAtEarliest:y,isLoading:z}){let[A,B]=(0,e.useState)(()=>f?{event:f,position:c,kafkaOffset:u||0,isAtEarliest:y||!1,isAtLatest:x||!1,topicIndex:b}:null),[C,D]=(0,e.useState)(a),[E,F]=(0,e.useState)(!1),G=z||!1,H=!G&&!A?.event,I=H?"This topic has no events. Please enter the event schema manually.":"";return(0,d.jsx)("div",{className:"flex flex-col h-full w-full min-h-[400px] overflow-auto",children:(A?.event||H||G)&&(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)("div",{className:"flex justify-between items-center mb-4",children:(0,d.jsx)("h3",{className:(0,i.cn)("text-md font-medium step-description",G&&"opacity-50 pointer-events-none transition-opacity duration-200"),children:"Sample event"})}),(0,d.jsx)(r.E,{event:(0,i.$c)(A?.event),topic:a,isLoadingEvent:G,eventError:I,isEmptyTopic:H,onManualEventChange:l,isEditingEnabled:m,readOnly:n})]})})};var t=c(49853),u=c(42242);function v({partitionCount:a,replicas:b,onReplicaCountChange:c,index:f,readOnly:g,isLoading:h}){let[i,k]=(0,e.useState)(b),l=a=>{k(a),c?.(a)};return(0,d.jsxs)("div",{className:"space-y-2",children:[(0,d.jsxs)("div",{className:"flex items-center gap-2",children:[(0,d.jsx)("label",{htmlFor:`partition-input-${f}`,className:"block text-sm font-medium text-content",children:"Replica Count"}),(0,d.jsxs)(u.m_,{children:[(0,d.jsx)(u.k$,{asChild:!0,children:(0,d.jsx)(j.default,{src:t.A,alt:"Info",className:"w-4 h-4"})}),(0,d.jsx)(u.ZI,{side:"right",align:"start",className:"max-w-[300px] bg-gray-800 text-gray-100 border border-gray-700 rounded-lg p-3 shadow-lg",children:(0,d.jsx)("p",{className:"text-sm leading-relaxed",children:"Decreasing the number of replicas will result in slower performance, but it will reduce resource usage"})})]})]}),(0,d.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,d.jsx)("input",{id:`partition-input-${f}`,type:"number",min:"1",max:a||1,value:i,onChange:b=>{let c=parseInt(b.target.value);!isNaN(c)&&c>=1&&c<=(a||1)&&l(c)},onBlur:b=>{let c=parseInt(b.target.value);isNaN(c)||c<1?l(1):c>(a||1)&&l(a||1)},onKeyDown:a=>{("e"===a.key||"E"===a.key||"+"===a.key||"-"===a.key)&&a.preventDefault()},disabled:g||h||0===a,className:"px-3 py-2 input-regular input-border-regular rounded-md text-sm focus:outline-none focus:border-transparent disabled:opacity-50 disabled:cursor-not-allowed w-24",placeholder:"1"}),(0,d.jsx)("span",{className:"text-sm text-content",children:a>0?`(Must be between 1 and ${a})`:"(Loading partition details...)"})]})]})}function w({index:a,existingTopic:b,onTopicChange:c,onOffsetChange:f,onManualEventChange:h,availableTopics:l,initialOffset:m=g.Kr.LATEST,additionalContent:n,isEditingEnabled:o,readOnly:p,disableTopicChange:r,topicName:t,offset:u,event:w,isLoading:x,error:y,currentOffset:z,earliestOffset:A,latestOffset:B,isAtLatest:C,isAtEarliest:D,fetchNewestEvent:E,fetchOldestEvent:F,fetchNextEvent:G,fetchPreviousEvent:H,refreshEvent:I,partitionCount:J=1,replicas:K=1,onReplicaCountChange:L,onRefreshTopics:M}){let N=t||b?.name||"",O=u||b?.initialOffset||m,P=w||b?.selectedEvent?.event||null,Q=x||!1,R=(0,e.useCallback)(async a=>{""!==a&&c&&a&&c(a,P)},[c,P]),S=(0,e.useCallback)(a=>{f&&f(a,P)},[f,P]),T=(0,e.useCallback)(a=>{h&&h(a)},[h]),U=(0,e.useCallback)(a=>{L&&L(a)},[L]);return(0,d.jsxs)("div",{className:"flex flex-row gap-6",children:[(0,d.jsxs)("div",{className:(0,i.cn)("w-[40%] space-y-4",Q&&"opacity-50 pointer-events-none transition-opacity duration-200"),children:[(0,d.jsx)("h3",{className:"text-md font-medium step-description",children:"This Kafka topic will be used as the data source of your pipeline."}),(0,d.jsxs)("div",{className:"flex flex-col gap-4 pt-8",children:[(0,d.jsx)(q,{index:a,topicValue:N,isLoadingEvent:Q,offsetValue:O,onTopicChange:R,onOffsetChange:S,onBlur:()=>{},onOpenChange:()=>{},topicError:y||"",offsetError:"",topicPlaceholder:"Select a topic",offsetPlaceholder:"Select initial offset",topicOptions:l.map(a=>({label:a,value:a})),offsetOptions:Object.entries(g.Kr).map(([a,b])=>({label:b,value:b})),readOnly:p,disableTopicChange:r,onRefreshTopics:M}),N&&(0,d.jsx)(v,{partitionCount:J,replicas:K,onReplicaCountChange:U,index:a,readOnly:p,isLoading:Q}),Q&&(0,d.jsxs)("div",{className:"flex items-center gap-2 text-sm text-content",children:[(0,d.jsx)(j.default,{src:k.A,alt:"Loading",width:16,height:16,className:"animate-spin"}),(0,d.jsx)("span",{children:"Fetching the event schema..."})]}),n]})]}),(0,d.jsx)("div",{className:"w-[60%] min-h-[450px] h-full",children:(0,d.jsx)(s,{topicName:N,initialOffset:O,topicIndex:a,initialEvent:P,isEditingEnabled:o,onEventLoading:()=>{},onEventLoaded:a=>{},onEventError:a=>{},onEmptyTopic:()=>{},onManualEventChange:T,readOnly:p,isLoading:Q,currentOffset:z,earliestOffset:A,latestOffset:B,isAtLatest:C,isAtEarliest:D,fetchNewestEvent:E,fetchOldestEvent:F,fetchNextEvent:G,fetchPreviousEvent:H,refreshEvent:I})})]})}var x=c(46298),y=c(26186),z=c(65775),A=c(39293);function B({steps:a,onCompleteStep:b,validate:c,currentStep:j,readOnly:k,standalone:l,toggleEditMode:m,enableDeduplication:n=!1,onDeduplicationChange:o,initialDeduplicationConfig:p,pipelineActionState:q,onCompleteStandaloneEditing:r}){var s;let{topicsStore:t,kafkaStore:u,coreStore:v}=(0,f.useStore)(),B=(0,z.D)(),{topics:C,topicDetails:D,isLoadingTopics:E,topicsError:F,fetchTopics:G,getPartitionCount:H}=(({kafka:a})=>{let[b,c]=(0,e.useState)([]),[d,f]=(0,e.useState)([]),[g,i]=(0,e.useState)(!1),[j,k]=(0,e.useState)(null),[l,m]=(0,e.useState)(0),n=(0,e.useCallback)(async()=>{if(!a.bootstrapServers)return void k("Kafka connection details are missing");i(!0),k(null);try{let b=await h.Y.fetchTopics(a),d=await h.Y.fetchTopicDetails(a);b.success&&b.topics?(c(b?.topics||[]),m(0)):(k(b.error||"Failed to fetch topics"),l<3&&m(a=>a+1)),d.success&&d.topicDetails&&f(d.topicDetails||[])}catch(a){k(a instanceof Error?a.message:"Unknown error occurred")}finally{i(!1)}},[a,l,3]),o=(0,e.useCallback)(a=>{let b=d.find(b=>b.name===a);return b?.partitionCount||0},[d]);return{topics:b,topicDetails:d,isLoadingTopics:g,topicsError:j,fetchTopics:n,getPartitionCount:o}})({kafka:u}),I=(s=j||"",(0,e.useCallback)(()=>{if(!s)return 0;if(s===g.Fn.TOPIC_SELECTION_1||s===g.Fn.TOPIC_DEDUPLICATION_CONFIGURATOR_1);else if(s===g.Fn.TOPIC_SELECTION_2||s===g.Fn.TOPIC_DEDUPLICATION_CONFIGURATOR_2)return 1;return 0},[s])),{availableTopics:J,setAvailableTopics:K,topics:L,topicCount:M,updateTopic:N,invalidateTopicDependentState:O}=t,P=I(),Q=L[P],[R,S]=(0,e.useState)(0),[T,U]=(0,e.useState)(!0),{topicName:V,offset:W,event:X,isLoading:Y,isEmptyTopic:Z,error:$,deduplicationConfig:_,deduplicationConfigured:aa,canContinue:ab,manualEvent:ac,isManualEventValid:ad,replicas:ae,partitionCount:af,selectTopic:ag,selectOffset:ah,selectReplicaCount:ai,updatePartitionCount:aj,configureDeduplication:ak,handleManualEventChange:al,submit:am,currentOffset:an,earliestOffset:ao,latestOffset:ap,isAtLatest:aq,isAtEarliest:ar,fetchNewestEvent:as,fetchOldestEvent:at,fetchNextEvent:au,fetchPreviousEvent:av,refreshEvent:aw}=function({index:a,enableDeduplication:b=!1,onDeduplicationChange:c,initialDeduplicationConfig:d,currentStep:j}){let{topicsStore:k,deduplicationStore:l,kafkaStore:m,joinStore:n}=(0,f.useStore)(),o=(0,A.U)(),p=(0,z.D)(),q=(0,e.useMemo)(()=>m,[m]);(0,e.useRef)(null);let r=(0,e.useRef)(null),[s,t]=(0,e.useState)(""),[u,v]=(0,e.useState)("latest"),[w,x]=(0,e.useState)(1),y=k.topics[a];y?.name,y?.selectedEvent?.event,y?.initialOffset||g.Kr.LATEST,y?.replicas,y?.partitionCount,y?.name,y?.selectedEvent?.event,y?.initialOffset||g.Kr.LATEST,y?.replicas;let B=y?.partitionCount||0,C=l.getDeduplication(a),[D,E]=(0,e.useState)({key:d?.key||C?.key||"",keyType:d?.keyType||C?.keyType||"string",window:d?.window||C?.window||1,unit:d?.unit||C?.unit||"hours"}),[F,G]=(0,e.useState)(!!(d?.key||C?.key&&C?.window)),[H,I]=(0,e.useState)(!1),[J,K]=(0,e.useState)(""),{fetchEvent:L,event:M,isLoadingEvent:N,eventError:O,resetEventState:P}=((a,b)=>{let[c,d]=(0,e.useState)(!1),[f,g]=(0,e.useState)(null),[i,j]=(0,e.useState)(),[k,l]=(0,e.useState)(null),[m,n]=(0,e.useState)(!0),[o,p]=(0,e.useState)(!1);return{fetchEvent:async(e,f=!1,i)=>{if(!e)return void g("No topic specified");if(i?.direction==="previous"&&null===k)return void g("Already at the first event");if(f&&!m)return void g("No more events available");d(!0),g(null);let o=setTimeout(()=>{c&&(d(!1),g("Request timed out. Using sample data instead."),j(null),l(null))},3e4);try{i?.position==="latest"?(n(!1),p(!0)):i?.position==="earliest"&&(n(!0),p(!1));let c=await h.Y.fetchEvent(a,{topic:e,format:b,runConsumerFirst:!0,getNext:f,currentOffset:k?.toString()||null,position:i?.position,direction:i?.direction,currentPosition:k});if(clearTimeout(o),!c.success)throw Error(c.error||"Failed to fetch event");let m=c.data;if(m&&m.success){j(m.event),d(!1);let a=m.offset?parseInt(m.offset,10):null;null!==a&&(l(a),i?.position||(m.metadata&&void 0!==m.metadata.hasOlderEvents?p(m.metadata.hasOlderEvents):i?.position!=="earliest"&&p(!0),!1===m.hasMoreEvents?n(!1):i?.position!=="latest"&&n(!0))),m.isMock||m.event?._mock?f?(n(!1),g("No more events available")):g("Note: Using sample data because actual data could not be fetched"):g(null)}else c.error&&(c.error.includes("end of topic")||c.error.includes("no more events"))?(n(!1),g("No more events available")):c.error&&c.error.includes("Timeout waiting for message")?f?(n(!1),g("No more events available")):i?.direction==="previous"?(p(!1),g("No previous events available")):g(c.error||"Failed to fetch event"):g(c.error||"Failed to fetch event")}catch(b){clearTimeout(o),console.error("Error fetching event:",b);let a=b instanceof Error?b.message:"Unknown error";a.includes("Timeout waiting for message")?f?(n(!1),g("No more events available")):i?.direction==="previous"?(p(!1),g("No previous events available")):g(`Error: ${a}`):g(`Error: ${a}`)}finally{c&&d(!1)}},event:i,isLoadingEvent:c,eventError:f,hasMoreEvents:m,hasOlderEvents:o,resetEventState:()=>{j(""),g(null),l(null),n(!0),p(!1)},currentOffset:k}})(q,"JSON"),[Q,R]=(0,e.useState)({event:null,currentOffset:null,earliestOffset:null,latestOffset:null,isAtLatest:!1,isLoading:!1,error:null,isEmptyTopic:!1}),S=(0,e.useCallback)(async a=>{if(a){R(a=>({...a,error:null,event:null}));try{await L(a,!1,{position:"latest"})}catch(b){R(a=>({...a,error:b instanceof Error?b.message:"Failed to fetch event"})),o.topic.eventError({topicName:a,position:"latest",error:b instanceof Error?b.message:"Failed to fetch event",timestamp:new Date().toISOString()})}}},[L,o.topic]),T=(0,e.useCallback)(async a=>{if(a){R(a=>({...a,error:null,event:null}));try{await L(a,!1,{position:"earliest"})}catch(b){R(a=>({...a,error:b instanceof Error?b.message:"Failed to fetch event"})),o.topic.eventError({topicName:a,position:"earliest",error:b instanceof Error?b.message:"Failed to fetch event",timestamp:new Date().toISOString()})}}},[L,o.topic]),U=(0,e.useCallback)(async(a,b)=>{if(!a||null===b)return void console.warn("fetchNextEvent: Invalid parameters",{topicName:a,currentOffset:b});R(a=>({...a,error:null,event:null}));try{await L(a,!0,{direction:"next"})}catch(b){R(a=>({...a,error:b instanceof Error?b.message:"Failed to fetch next event"})),o.topic.eventError({topicName:a,position:"next",error:b instanceof Error?b.message:"Failed to fetch next event",timestamp:new Date().toISOString()})}},[L,o.topic]),V=(0,e.useCallback)(async(a,b)=>{if(!a||null===b)return void console.warn("fetchPreviousEvent: Invalid parameters",{topicName:a,currentOffset:b});R(a=>({...a,error:null,event:null}));try{await L(a,!1,{direction:"previous"})}catch(b){R(a=>({...a,error:b instanceof Error?b.message:"Failed to fetch previous event"})),o.topic.eventError({topicName:a,position:"previous",error:b instanceof Error?b.message:"Failed to fetch previous event",timestamp:new Date().toISOString()})}},[L,o.topic]),W=(0,e.useCallback)(async(a,b=!1)=>{if(a){R(a=>({...a,error:null,event:null}));try{await L(a,b)}catch(b){console.error("Error in refreshEvent:",b),R(a=>({...a,error:b instanceof Error?b.message:"Failed to refresh event"})),o.topic.eventError({topicName:a,position:"refresh",error:b instanceof Error?b.message:"Failed to refresh event",timestamp:new Date().toISOString()})}}},[L,o.topic]),X=(0,e.useCallback)(a=>{K(a);try{JSON.parse(a),I(!0)}catch(a){I(!1)}},[]),Y=(0,e.useCallback)(b=>{b!==s&&(t(b),k.updateTopic({index:a,name:b,initialOffset:u,events:[],selectedEvent:{event:void 0,topicIndex:a,position:u},replicas:w,partitionCount:0}),o.topic.selected({offset:u}))},[a,u,k,s,n,o.topic,p,j]),Z=(0,e.useCallback)(b=>{b!==u&&(v(b),k.updateTopic({index:a,name:s,initialOffset:b,events:[],selectedEvent:{event:void 0,topicIndex:a,position:b},replicas:w,partitionCount:B}))},[a,s,k,u,w]),$=(0,e.useCallback)(b=>{b!==w&&(x(b),k.updateTopic({index:a,name:s,initialOffset:u,events:[],selectedEvent:{event:void 0,topicIndex:a,position:u},replicas:b,partitionCount:B}))},[a,s,k,u,w,B]),_=(0,e.useCallback)(b=>{b!==B&&k.updateTopic({index:a,name:s,initialOffset:u,events:[],selectedEvent:{event:void 0,topicIndex:a,position:u},replicas:w,partitionCount:b})},[a,s,k,u,w,B]),aa=(0,e.useCallback)((b,d)=>{let e={key:b.key,keyType:b.keyType,window:d.window,unit:d.unit};E(e);let f=!!(b.key&&d.window);G(f);let g={enabled:f,...e};l.updateDeduplication(a,g),c&&c(g),f&&o.key.dedupKey({keyType:b.keyType,window:d.window,unit:d.unit})},[a,l,c,o.key,p,j]),ab=(0,e.useMemo)(()=>{let a=s&&(Q.event||J&&H);return b?a&&F:a},[s,Q.event,J,H,b,F]),ac=(0,e.useCallback)(()=>{let c=null;try{c=(J?JSON.parse(J):null)||Q.event}catch(a){console.error("Error parsing event:",a);return}let d=r.current?.name||k.topics[a]?.name,e=r.current?.event||k.topics[a]?.selectedEvent?.event;console.log("[Topic Submit] Comparison sources:",{usingOriginalRef:!!r.current,originalTopicName:r.current?.name,currentTopicName:s,hasOriginalEvent:!!r.current?.event}),!e&&c&&s===d?(e=c,console.log("[Topic Submit] \uD83D\uDD04 FALLBACK: No previous event, using current event as previous (same topic, metadata-only change)")):!e&&c&&s!==d&&console.log("[Topic Submit] ⚠️ Topic changed and no previous event - will invalidate (first time or new topic selection)"),!c&&e?(c=e,console.log("[Topic Submit] \uD83D\uDD04 FALLBACK 2: No new event, using original event (metadata-only change)"),console.log("[Topic Submit] Event keys:",Object.keys(c).slice(0,10))):c||e?c&&(console.log("[Topic Submit] ✓ FinalEvent exists, using it for comparison"),console.log("[Topic Submit] Source: state.event?",!!Q.event,"manualEvent?",!!J)):console.warn("[Topic Submit] ⚠️ Neither finalEvent nor previousEvent exists!"),console.log("[Topic Submit] Current state:",{topicName:s,previousTopicName:d,topicChanged:s!==d,replicas:w,previousReplicas:k.topics[a]?.replicas,hasFinalEvent:!!c,hasPreviousEvent:!!e,finalEventKeys:c?Object.keys(c).length:0,previousEventKeys:e?Object.keys(e).length:0,sameEventObject:c===e});let f={index:a,name:s,initialOffset:u,events:[{event:c,topicIndex:a,position:u,isManualEvent:""!==J}],selectedEvent:{event:c,topicIndex:a,position:u,isManualEvent:""!==J},replicas:w,partitionCount:B},h=!!(D.key&&D.window),m=b&&h?{enabled:!0,window:D.window,unit:D.unit,key:D.key,keyType:D.keyType}:C||{enabled:!1,window:0,unit:"hours",key:"",keyType:""};k.updateTopic(f),l.updateDeduplication(a,m);let o=!1,q="";if(e)if(c){console.log("[Topic Submit] \uD83D\uDD0D PATH 3: Comparing schemas..."),console.log("[Topic Submit] Previous event sample:",e?Object.keys(e).slice(0,5):"none"),console.log("[Topic Submit] Final event sample:",c?Object.keys(c).slice(0,5):"none");let a=(0,i.EP)(e,c);console.log("[Topic Submit] Schema comparison result:",a),a?(o=!1,s!==d?console.log("[Topic Submit] ✅ Topic name changed but schema is identical, preserving dependent sections"):console.log("[Topic Submit] ✅ Schema unchanged, preserving dependent sections (offset/replica/event change)")):(o=!0,q=s!==d?"Topic changed and schema differs":"Event schema changed",console.log(`[Topic Submit] ❌ Schemas differ, invalidating dependent sections. Reason: ${q}`))}else o=!0,q="Missing current event",console.error("[Topic Submit] ⚠️ PATH 2: No current event found (THIS SHOULD NOT HAPPEN!), invalidating dependent sections"),console.error("[Topic Submit] Debug: previousEvent exists?",!!e,"finalEvent exists?",!!c);else o=!0,q="First event selection",console.log("[Topic Submit] ⚠️ PATH 1: No previous event found, invalidating dependent sections");o?(console.log("[Topic Submit] \uD83E\uDDF9 Schema changed, invalidating dependent sections"),n.setEnabled(!1),n.setType(""),n.setStreams([]),"topic-selection-1"===j||j===g.Fn.TOPIC_SELECTION_1?(p.invalidateSection(g.Fn.DEDUPLICATION_CONFIGURATOR,q),p.invalidateSection(g.Fn.JOIN_CONFIGURATOR,q),p.invalidateSection(g.Fn.CLICKHOUSE_MAPPER,q)):"topic-selection-2"===j||j===g.Fn.TOPIC_SELECTION_2||"topic-deduplication-configurator-1"===j||j===g.Fn.TOPIC_DEDUPLICATION_CONFIGURATOR_1||"topic-deduplication-configurator-2"===j||j===g.Fn.TOPIC_DEDUPLICATION_CONFIGURATOR_2?(p.invalidateSection(g.Fn.JOIN_CONFIGURATOR,q),p.invalidateSection(g.Fn.CLICKHOUSE_MAPPER,q)):j&&(j.includes("topic-selection")||j.includes("topic-deduplication"))&&(p.invalidateSection(g.Fn.JOIN_CONFIGURATOR,q),p.invalidateSection(g.Fn.CLICKHOUSE_MAPPER,q))):console.log("[Topic Submit] ✅ Skipping invalidation - schema unchanged, preserving all dependent sections"),r.current&&(console.log("[Topic Submit] Resetting original topic reference for next edit session"),r.current={name:s,event:c})},[a,s,u,Q.event,J,b,F,D,C,k,l,n,p,j,w,B]);return{topicName:s,offset:u,event:Q.event,isLoading:Q.isLoading,isEmptyTopic:Q.isEmptyTopic,error:Q.error,deduplicationConfig:D,deduplicationConfigured:F,canContinue:ab,manualEvent:J,isManualEventValid:H,replicas:w,partitionCount:B,currentOffset:Q.currentOffset,earliestOffset:Q.earliestOffset,latestOffset:Q.latestOffset,isAtLatest:Q.isAtLatest,isAtEarliest:Q.isAtEarliest,selectTopic:Y,selectOffset:Z,selectReplicaCount:$,updatePartitionCount:_,configureDeduplication:aa,handleManualEventChange:X,submit:ac,fetchNewestEvent:S,fetchOldestEvent:T,fetchNextEvent:U,fetchPreviousEvent:V,refreshEvent:W}}({index:P,enableDeduplication:n,onDeduplicationChange:o,initialDeduplicationConfig:p,currentStep:j}),[ax,ay]=(0,e.useState)(!1),az=(0,e.useCallback)((a,b)=>{ag(a);let c=H(a);c>0&&ai(c)},[ag,ai,H]),aA=(0,e.useCallback)((a,b)=>{ah(a)},[ah]),aB=(0,e.useCallback)(()=>{am(),l&&m?(j===g.Fn.TOPIC_SELECTION_1?B.markSectionAsValid(g.Fn.TOPIC_SELECTION_1):j===g.Fn.TOPIC_SELECTION_2?B.markSectionAsValid(g.Fn.TOPIC_SELECTION_2):j===g.Fn.TOPIC_DEDUPLICATION_CONFIGURATOR_1?B.markSectionAsValid(g.Fn.TOPIC_DEDUPLICATION_CONFIGURATOR_1):j===g.Fn.TOPIC_DEDUPLICATION_CONFIGURATOR_2?B.markSectionAsValid(g.Fn.TOPIC_DEDUPLICATION_CONFIGURATOR_2):j&&B.markSectionAsValid(j),v.markAsDirty(),console.log("[TopicSelector] Configuration marked as dirty - changes will be saved on Resume"),r?.()):j===g.Fn.TOPIC_SELECTION_1?b(g.Fn.TOPIC_SELECTION_1):j===g.Fn.TOPIC_SELECTION_2?b(g.Fn.TOPIC_SELECTION_2):j===g.Fn.TOPIC_DEDUPLICATION_CONFIGURATOR_1?b(g.Fn.TOPIC_DEDUPLICATION_CONFIGURATOR_1):j===g.Fn.TOPIC_DEDUPLICATION_CONFIGURATOR_2?b(g.Fn.TOPIC_DEDUPLICATION_CONFIGURATOR_2):b(j||g.Fn.TOPIC_SELECTION_1)},[am,j,B,b,l,m]),aC=(0,e.useCallback)(()=>{aB(),l&&m&&ay(!0)},[aB,l,m]),aD=(0,e.useCallback)(async()=>{await G()},[G]),aE=(0,e.useCallback)(()=>{let a=["topics"];(j===g.Fn.TOPIC_DEDUPLICATION_CONFIGURATOR_1||j===g.Fn.TOPIC_DEDUPLICATION_CONFIGURATOR_2)&&(a=["topics","deduplication"]),v.discardSections(a)},[v,j]);return(0,d.jsx)("div",{className:"space-y-6 w-full",children:(0,d.jsxs)("div",{className:"flex flex-col gap-6 pb-6 bg-background-neutral-faded rounded-md p-0",children:[(0,d.jsx)("div",{className:"grid grid-cols-1 gap-6",children:(0,d.jsx)(w,{index:P,existingTopic:Q,onTopicChange:az,onOffsetChange:aA,onManualEventChange:al,availableTopics:J,additionalContent:(()=>{if(!n)return null;let a=X||(ac&&ad?JSON.parse(ac):null);return a?(0,d.jsx)("div",{className:"mt-6",children:(0,d.jsx)(y.A,{index:P,onChange:ak,disabled:!V,eventData:a,readOnly:k})}):null})(),isEditingEnabled:""!==ac||Q?.selectedEvent?.isManualEvent||!1,readOnly:k,disableTopicChange:l,topicName:V,offset:W,event:X,isLoading:Y,error:$,currentOffset:an,earliestOffset:ao,latestOffset:ap,isAtLatest:aq,isAtEarliest:ar,fetchNewestEvent:as,fetchOldestEvent:at,fetchNextEvent:au,fetchPreviousEvent:av,refreshEvent:aw,partitionCount:af,replicas:ae,onReplicaCountChange:ai,onRefreshTopics:aD})}),(0,d.jsx)(x.A,{standalone:l,onSubmit:aC,onDiscard:aE,isLoading:!1,isSuccess:ax,disabled:!ab,successText:"Continue",loadingText:"Loading...",regularText:"Continue",actionType:"primary",showLoadingIcon:!1,readOnly:k,toggleEditMode:m,pipelineActionState:q,onClose:r}),n&&V&&X&&!aa&&(0,d.jsx)("div",{className:"text-amber-500 text-sm px-6",children:"Please configure deduplication settings to continue"})]})})}},26186:(a,b,c)=>{c.d(b,{A:()=>k});var d=c(48477),e=c(48296),f=c(95101),g=c(62992),h=c(64708);c(84621);var i=c(19683),j=c(65357);let k=function({index:a,disabled:b=!1,onChange:c,eventData:k,readOnly:l}){let[m,n]=(0,e.useState)(""),[o,p]=(0,e.useState)("string"),[q,r]=(0,e.useState)(1),[s,t]=(0,e.useState)(j.XR.HOURS.value),[u,v]=(0,e.useState)([]),[w,x]=(0,e.useState)(!1),[y,z]=(0,e.useState)(null),{topicsStore:A}=(0,h.useStore)(),{getTopic:B}=A;B(a),(0,h.useStore)(b=>b.deduplicationStore.getDeduplication(a)),(0,e.useCallback)(()=>0===u.length?[]:u,[u]);let C=(0,e.useCallback)(a=>{n(a||""),p("string"),c({key:a||"",keyType:a?"string":""},{window:q,unit:s})},[o,q,s,c]);(0,e.useCallback)(a=>{p(a),c({key:m,keyType:a},{window:q,unit:s})},[m,q,s,c]);let D=(0,e.useCallback)(a=>{r(a),c({key:m,keyType:o},{window:a,unit:s})},[m,o,s,c]),E=(0,e.useCallback)(a=>{t(a),c({key:m,keyType:o},{window:q,unit:a})},[m,o,q,c]);return(0,d.jsxs)("div",{className:`flex flex-col gap-8 ${b?"opacity-50 pointer-events-none":""}`,children:[(0,d.jsx)("div",{className:"text-sm font-weight-[400] text-content",children:k?"The deduplicate key will be used to detect and remove duplicate data in your pipeline.":"Select a topic and wait for event data to load to configure deduplication."}),(0,d.jsxs)("div",{className:"space-y-4",children:[(0,d.jsx)("div",{children:(0,d.jsx)(f.J,{className:"text-lg font-medium text-content",children:"Deduplicate Key"})}),(0,d.jsxs)("div",{className:"flex gap-2 w-full",children:[(0,d.jsx)("div",{className:"w-[70%]",children:w?(0,d.jsx)("div",{className:"text-sm text-gray-500 p-2 border rounded",children:"Loading available keys..."}):u.length>0?(0,d.jsx)(g.Z,{availableOptions:u,selectedOption:m,onSelect:C,placeholder:"Enter de-duplicate key",clearable:!0,readOnly:l}):(0,d.jsx)("div",{className:"text-sm text-gray-500 p-2 border rounded",children:y||"Please select a topic with valid event data."})}),(0,d.jsx)("div",{className:"w-[30%]"})]})]}),(0,d.jsx)(i.x,{window:q,setWindow:D,windowUnit:s,setWindowUnit:E,readOnly:l})]})}},26431:(a,b,c)=>{c.d(b,{gE:()=>d.gE}),c(48477),c(48296),(0,c(9206).F)("relative w-full rounded-lg border px-4 py-3 text-sm grid has-[>svg]:grid-cols-[calc(var(--spacing)*4)_1fr] grid-cols-[0_1fr] has-[>svg]:gap-x-3 gap-y-0.5 items-start [&>svg]:size-4 [&>svg]:translate-y-0.5 [&>svg]:text-current",{variants:{variant:{default:"bg-background text-foreground",destructive:"text-destructive-foreground [&>svg]:text-current *:data-[slot=alert-description]:text-destructive-foreground/80"}},defaultVariants:{variant:"default"}}),c(26403),c(19677),c(94480),c(5375);var d=c(35557);c(4179),c(95101),c(15831),c(92571),c(3251),c(38003),c(60697)},29771:(a,b,c)=>{c.d(b,{DS:()=>y,_O:()=>z,YT:()=>s,uZ:()=>v,TT:()=>w});var d=c(69);c(13556);var e=c(62890);d.Ik({authMethod:d.Yj(),securityProtocol:d.Yj()}),d.Ik({bootstrapServers:d.Yj().min(1,"Bootstrap servers are required")});let f=d.Ik({location:d.Yj().optional(),password:d.Yj().optional(),type:d.Yj().optional(),algorithm:d.Yj().optional(),certificates:d.Yj().optional(),certificatesFileName:d.Yj().optional()}),g=d.Ik({username:d.Yj().min(1,"Username is required"),password:d.Yj().min(1,"Password is required"),truststore:f.optional(),consumerGroup:d.Yj().optional()}),h=d.Ik({truststore:f.optional()}),i=d.Ik({jaasConfig:d.Yj().min(1,"JAAS config is required")}),j=d.Ik({kerberosPrincipal:d.Yj().min(1,"Kerberos principal is required"),kerberosKeytab:d.Yj().min(1,"Kerberos keytab is required"),kerberosKeytabFileName:d.Yj().optional(),kerberosRealm:d.Yj().min(1,"Kerberos realm is required"),kdc:d.Yj().min(1,"Kerberos KDC is required"),serviceName:d.Yj().min(1,"Kerberos service name is required"),krb5Config:d.Yj().min(1,"Kerberos configuration is required"),krb5ConfigFileName:d.Yj().optional(),truststore:f.optional()}),k=d.Ik({oauthBearerToken:d.Yj().min(1,"OAuth bearer token is required")}),l=d.Ik({username:d.Yj().min(1,"Username is required"),password:d.Yj().min(1,"Password is required"),truststore:f.optional(),consumerGroup:d.Yj().optional()}),m=d.Ik({username:d.Yj().min(1,"Username is required"),password:d.Yj().min(1,"Password is required"),truststore:f.optional(),consumerGroup:d.Yj().optional()}),n=d.Ik({delegationToken:d.Yj().min(1,"Delegation token is required")}),o=d.Ik({ldapServerUrl:d.Yj().min(1,"LDAP server URL is required"),ldapServerPort:d.Yj().min(1,"LDAP server port is required"),ldapBindDn:d.Yj().min(1,"LDAP bind DN is required"),ldapBindPassword:d.Yj().min(1,"LDAP bind password is required"),ldapUserSearchFilter:d.lq(d.Yj().min(1,"LDAP user search filter is required")),ldapBaseDn:d.lq(d.Yj().min(1,"LDAP base DN is required"))}),p=d.Ik({awsRegion:d.Yj().min(1,"AWS region is required"),awsAccessKey:d.Yj().min(1,"AWS access key is required"),awsAccessKeySecret:d.Yj().min(1,"AWS access key secret is required"),awsAuthorizationIdentity:d.Yj().optional(),awsIAMRoleArn:d.Yj().optional(),awsSessionToken:d.Yj().optional()}),q=d.Ik({clientCert:d.Yj().min(1,"Client certificate is required"),clientKey:d.Yj().min(1,"Client key is required"),password:d.Yj().min(1,"Password is required")}),r=d.Ik({authMethod:d.Yj(),securityProtocol:d.Yj(),bootstrapServers:d.Yj().min(1,"Bootstrap servers are required"),isConnected:d.zM().optional()}),s=d.gM("authMethod",[r.extend({authMethod:d.eu("SASL/PLAIN"),saslPlain:g}),r.extend({authMethod:d.eu("SASL/JAAS"),saslJaas:i}),r.extend({authMethod:d.eu("SASL/GSSAPI"),saslGssapi:j}),r.extend({authMethod:d.eu("SASL/OAUTHBEARER"),saslOauthbearer:k}),r.extend({authMethod:d.eu("SASL/SCRAM-256"),saslScram256:l}),r.extend({authMethod:d.eu("SASL/SCRAM-512"),saslScram512:m}),r.extend({authMethod:d.eu("AWS_MSK_IAM"),awsIam:p}),r.extend({authMethod:d.eu("Delegation tokens"),delegationTokens:n}),r.extend({authMethod:d.eu("SASL/LDAP"),ldap:o}),r.extend({authMethod:d.eu("mTLS"),mtls:q}),r.extend({authMethod:d.eu("NO_AUTH"),noAuth:h})]).superRefine((a,b)=>{(a=>"SASL_SSL"===a||"SSL"===a)(a.securityProtocol)&&("SASL/PLAIN"===a.authMethod&&a.saslPlain?a.saslPlain.truststore?.certificates&&""!==a.saslPlain.truststore.certificates.trim()||b.addIssue({code:e.eq.custom,message:"Certificate is required when using SSL/TLS",path:["saslPlain","truststore","certificates"]}):"NO_AUTH"===a.authMethod&&a.noAuth?a.noAuth.truststore?.certificates&&""!==a.noAuth.truststore.certificates.trim()||b.addIssue({code:e.eq.custom,message:"Certificate is required when using SSL/TLS",path:["noAuth","truststore","certificates"]}):"SASL/GSSAPI"===a.authMethod&&a.saslGssapi?a.saslGssapi.truststore?.certificates&&""!==a.saslGssapi.truststore.certificates.trim()||b.addIssue({code:e.eq.custom,message:"Certificate is required when using SSL/TLS",path:["saslGssapi","truststore","certificates"]}):"SASL/SCRAM-256"===a.authMethod&&a.saslScram256?a.saslScram256.truststore?.certificates&&""!==a.saslScram256.truststore.certificates.trim()||b.addIssue({code:e.eq.custom,message:"Certificate is required when using SSL/TLS",path:["saslScram256","truststore","certificates"]}):"SASL/SCRAM-512"===a.authMethod&&a.saslScram512&&(!a.saslScram512.truststore?.certificates||""===a.saslScram512.truststore.certificates.trim())&&b.addIssue({code:e.eq.custom,message:"Certificate is required when using SSL/TLS",path:["saslScram512","truststore","certificates"]}))}),t=d.Ik({event:d.bz(),topicIndex:d.ai(),position:(0,d.KC)([d.ai(),d.Yj()]),kafkaOffset:d.ai().optional(),isAtEarliest:d.zM().optional(),isAtLatest:d.zM().optional(),isManualEvent:d.zM().optional()}),u=d.Ik({name:d.Yj(),index:d.ai(),events:d.YO(t),selectedEvent:t,initialOffset:d.k5(["earliest","latest"]),replicas:d.ai().optional(),partitionCount:d.ai().optional()}),v=d.g1(d.ai(),u);d.YO(d.Yj()),d.Ik({enabled:d.zM(),window:d.ai(),unit:d.k5(["seconds","minutes","hours","days"]),key:d.Yj(),keyType:d.Yj()}),d.Ik({topicName:d.Yj(),initialOffset:d.k5(["earliest","latest"])}).extend({event:t});let w=d.Ik({operation:d.Yj()}),x=d.Ik({window:d.Yj(),windowUnit:d.Yj(),keys:d.YO(d.Yj())}),y=d.g1(d.Yj(),x),z=d.Ik({join:d.zM(),streams:d.YO(d.Ik({name:d.Yj(),keys:d.YO(d.Ik({key:d.Yj(),index:d.ai(),type:d.k5(["string","number","boolean","array","object"])}))}))});d.Ik({events:d.YO(d.g1(d.Yj(),d.Yj()))})},35557:(a,b,c)=>{c.d(b,{$C:()=>x,bl:()=>y,gE:()=>t});var d=c(48477),e=c(48296),f=c(29558),g=c(53337),h=c(84621),i=c(95101),j=c(4179),k=c(60697),l=c(15831),m=c(92571);let n=e.createContext({}),o=()=>{let a=e.useContext(n),b=e.useContext(p),{getFieldState:c}=(0,g.xW)(),d=(0,g.lN)({name:a.name}),f=c(a.name,d);if(!a)throw Error("useFormField should be used within <FormField>");let{id:h}=b;return{id:h,name:a.name,formItemId:`${h}-form-item`,formDescriptionId:`${h}-form-item-description`,formMessageId:`${h}-form-item-message`,...f}},p=e.createContext({});function q({className:a,...b}){let{error:c,formItemId:e}=o();return(0,d.jsx)(i.J,{"data-slot":"form-label","data-error":!!c,className:(0,h.cn)("data-[error=true]:text-destructive-foreground",a),htmlFor:e,...b})}function r({...a}){let{error:b,formItemId:c,formDescriptionId:e,formMessageId:g}=o();return(0,d.jsx)(f.DX,{"data-slot":"form-control",id:c,"aria-describedby":b?`${e} ${g}`:`${e}`,"aria-invalid":!!b,...a})}function s({className:a,...b}){let{error:c,formMessageId:e}=o(),f=c?String(c?.message??""):b.children;return f?(0,d.jsx)("p",{"data-slot":"form-message",id:e,className:(0,h.cn)("text-destructive-foreground text-sm",a),...b,children:f}):null}function t({className:a,...b}){return(0,d.jsx)("div",{className:(0,h.cn)("grid gap-2",a),...b})}let u=({name:a,id:b,label:c,placeholder:f,register:g,required:i,error:k,type:l="text",readOnly:m,className:n,noLabel:o,defaultValue:p})=>{let[t,u]=(0,e.useState)(!1);return(0,d.jsxs)("div",{className:(0,h.cn)("grid gap-2 transition-all duration-200 ease-in-out",n),children:[!o&&(0,d.jsx)(q,{className:"transition-colors duration-200 text-content",children:c}),(0,d.jsx)(r,{children:(0,d.jsx)(j.p,{id:b,type:l,placeholder:f,...g(a,{required:i}),readOnly:m,className:(0,h.cn)("w-full","input-regular","input-border-regular","transition-all duration-200 ease-in-out","text-content",k&&"input-border-error",t&&"input-active scale-[1.01]",m&&"opacity-50 cursor-not-allowed"),onFocus:()=>!m&&u(!0),onBlur:()=>{document.querySelector('[data-state="open"]')||u(!1)},defaultValue:p})}),k&&(0,d.jsx)(s,{className:"animate-slideDown transition-opacity duration-200 ease-in-out text-content",children:k})]})},v={text:u,textarea:function({name:a,className:b,required:c,label:f,placeholder:g,register:i,error:j,noLabel:l,readOnly:m,...n}){let[o,p]=(0,e.useState)(!1);return(0,d.jsxs)("div",{className:(0,h.cn)("grid gap-2 transition-all duration-200 ease-in-out",b),...n,children:[!l&&(0,d.jsx)(q,{className:"transition-colors duration-200 text-content",children:f}),(0,d.jsx)(r,{children:(0,d.jsx)(k.T,{...i(a,{required:c}),placeholder:g,readOnly:m,...n,className:(0,h.cn)("w-full","input-regular","input-border-regular","transition-all duration-200 ease-in-out","text-content",j&&"input-border-error",o&&"input-active scale-[1.01]",m&&"opacity-50 cursor-not-allowed"),onFocus:()=>!m&&p(!0),onBlur:()=>{document.querySelector('[data-state="open"]')||p(!1)}})}),j&&(0,d.jsx)(s,{className:"animate-slideDown transition-opacity duration-200 ease-in-out text-content",children:j})]})},select:function({name:a,className:b,required:c,label:f,placeholder:i,register:j,error:k,type:m,options:n,defaultValue:o,noLabel:p,readOnly:t,...u}){let[v,w]=(0,e.useState)(!1),{control:x,getValues:y}=(0,g.xW)(),z=y(a)||o||"";return(0,d.jsxs)("div",{className:(0,h.cn)("space-y-2 w-full min-w-[200px] transition-all duration-200 ease-in-out",b),...u,children:[!p&&(0,d.jsx)(q,{className:"transition-colors duration-200 text-content",children:f}),(0,d.jsx)(r,{children:(0,d.jsx)(g.xI,{name:a,control:x,defaultValue:z,render:({field:b})=>(0,d.jsxs)(l.l6,{value:b.value,defaultValue:b.value,onValueChange:a=>{t||(b.onChange(a),b.onBlur())},onOpenChange:a=>{t||w(a)},disabled:t,children:[(0,d.jsx)(l.bq,{className:(0,h.cn)("w-full","input-regular","input-border-regular","transition-all duration-200 ease-in-out","text-content",k&&"input-border-error",v&&"input-active scale-[1.01]",t&&"opacity-50 cursor-not-allowed"),onFocus:()=>!t&&w(!0),onBlur:()=>{document.querySelector('[data-state="open"]')||(w(!1),b.onBlur())},disabled:t,children:(0,d.jsx)(l.yv,{placeholder:i})}),(0,d.jsx)(l.gC,{className:"select-content-custom animate-fadeIn",children:0===n.length?(0,d.jsx)("div",{className:"p-2 animate-pulse",children:"No options found"}):n.map(b=>(0,d.jsx)(l.eb,{value:b.value,className:"select-item-custom transition-colors duration-150 hover:scale-[1.02] transition-transform text-content",children:b.label},`${a}-${b.value}`))})]})})}),k&&(0,d.jsx)(s,{className:"animate-slideDown transition-opacity duration-200 ease-in-out",children:k})]})},number:u,boolean:function({name:a,className:b,label:c,register:f,error:i,noLabel:j,readOnly:k,...l}){let[n,o]=(0,e.useState)(!1),{control:p}=(0,g.xW)();return(0,d.jsxs)("div",{className:(0,h.cn)("grid gap-2 transition-all duration-200 ease-in-out",b),...l,children:[!j&&(0,d.jsx)(q,{className:"transition-colors duration-200 text-content",children:c}),(0,d.jsx)(r,{children:(0,d.jsx)(g.xI,{name:a,control:p,defaultValue:!1,render:({field:a})=>(0,d.jsx)(m.d,{checked:a.value,onCheckedChange:b=>{k||(a.onChange(b),o(b))},disabled:k,className:(0,h.cn)("data-[state=checked]:bg-[var(--primary)]","data-[state=unchecked]:bg-[var(--background)]","transition-colors duration-200 ease-in-out",k&&"opacity-50 cursor-not-allowed")})})}),i&&(0,d.jsx)(s,{className:"animate-slideDown transition-opacity duration-200 ease-in-out text-content",children:i})]})}};function w(a,b){if(!a||!b)return;let c=b?.split("."),d=a;for(let a of c){if(!d[a])return;d=d[a]}return d.message?d.message:void 0}function x({formConfig:a,formGroupName:b,register:c,errors:f,dynamicOptions:h,key:i,values:j,hiddenFields:k,readOnly:l}){let{control:m,getValues:n}=(0,g.xW)(),o=Object.values(a[b].fields),p=e.useRef(!0);return e.useEffect(()=>{p.current&&(p.current=!1)},[h,o]),(0,d.jsx)("div",{className:"space-y-6",children:o.map((a,b)=>{if(k?.includes(a.name))return null;let{name:e,label:g,placeholder:i,required:m,type:n,options:o,defaultValue:p,noLabel:q}=a,r=v[n]||u,s=h&&h[e]&&h[e].length>0?h[e]:o||[],t=j?.[e]!==void 0?j[e]:p||"";return(0,d.jsx)("div",{className:"transition-all duration-300 ease-in-out",style:{animationDelay:`${50*b}ms`,opacity:0,animation:"fadeIn 0.3s forwards"},children:(0,d.jsx)(r,{name:e,id:e,label:g,placeholder:i,register:c,required:m||"",error:w(f,e)||"",type:n||"text",options:s,defaultValue:t,noLabel:q,readOnly:l})},`${e}-${s.length}-${t}-${b}`)})},i||`${b}-${Object.keys(h||{}).length}`)}function y({field:a,register:b,errors:c,dynamicOptions:e,values:f,control:g,onChange:h,readOnly:i}){let{name:j,label:k,placeholder:l,required:m,type:n="text",options:o,defaultValue:p,noLabel:q}=a,r=v[n]||u,s=e&&e[j]&&e[j].length>0?e[j]:o||[],t=f?.[j]!==void 0?f[j]:p||"",x=w(c,j)||"";return"text"===n?(0,d.jsx)(u,{name:j,id:j,label:k,placeholder:l,register:b,required:m||"",error:x,type:n,readOnly:a.readOnly||i,className:a.className,noLabel:q}):(0,d.jsx)("div",{className:"transition-all duration-300 ease-in-out",style:{opacity:0,animation:"fadeIn 0.3s forwards"},children:(0,d.jsx)(r,{name:j,id:j,label:k,placeholder:l,register:b,required:m||"",error:x,type:n,options:s,defaultValue:t,noLabel:q,readOnly:a.readOnly||i})})}},38003:(a,b,c)=>{c.d(b,{Xi:()=>i,av:()=>j,j7:()=>h,tU:()=>g});var d=c(48477);c(48296);var e=c(93089),f=c(84621);function g({className:a,...b}){return(0,d.jsx)(e.bL,{"data-slot":"tabs",className:(0,f.cn)("flex flex-col gap-2",a),...b})}function h({className:a,...b}){return(0,d.jsx)(e.B8,{"data-slot":"tabs-list",className:(0,f.cn)("bg-muted text-muted-foreground inline-flex h-9 w-fit items-center justify-center rounded-lg p-[3px]",a),...b})}function i({className:a,...b}){return(0,d.jsx)(e.l9,{"data-slot":"tabs-trigger",className:(0,f.cn)("data-[state=active]:bg-background dark:data-[state=active]:text-foreground focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:outline-ring dark:data-[state=active]:border-input dark:data-[state=active]:bg-input/30 text-foreground dark:text-muted-foreground inline-flex h-[calc(100%-1px)] flex-1 items-center justify-center gap-1.5 rounded-md border border-transparent px-2 py-1 text-sm font-medium whitespace-nowrap transition-[color,box-shadow] focus-visible:ring-[3px] focus-visible:outline-1 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:shadow-sm [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",a),...b})}function j({className:a,...b}){return(0,d.jsx)(e.UC,{"data-slot":"tabs-content",className:(0,f.cn)("flex-1 outline-none",a),...b})}},42242:(a,b,c)=>{c.d(b,{ZI:()=>j,k$:()=>i,m_:()=>h});var d=c(48477);c(48296);var e=c(67914),f=c(84621);function g({delayDuration:a=0,...b}){return(0,d.jsx)(e.Kq,{"data-slot":"tooltip-provider",delayDuration:a,...b})}function h({...a}){return(0,d.jsx)(g,{children:(0,d.jsx)(e.bL,{"data-slot":"tooltip",...a})})}function i({...a}){return(0,d.jsx)(e.l9,{"data-slot":"tooltip-trigger",...a})}function j({className:a,sideOffset:b=0,children:c,...g}){return(0,d.jsx)(e.ZL,{children:(0,d.jsx)(e.UC,{"data-slot":"tooltip-content",sideOffset:b,className:(0,f.cn)("bg-primary text-primary-foreground animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 w-fit origin-(--radix-tooltip-content-transform-origin) rounded-md px-3 py-1.5 text-xs text-balance",a),...g,children:c})})}},46298:(a,b,c)=>{c.d(b,{A:()=>m});var d=c(48477),e=c(48296),f=c(26403),g=c(84621),h=c(5862),i=c(78864);let j={primary:"btn-primary",secondary:"btn-secondary",tertiary:"btn-tertiary",destructive:"btn-destructive"},k=function({children:a,isSuccess:b=!1,isLoading:c=!1,isFailed:e=!1,disabled:k=!1,onClick:l,successText:m="Success",failedText:n="Failed",loadingText:o="Loading...",regularText:p="Continue",className:q,actionType:r="primary",showLoadingIcon:s=!1}){return(0,d.jsxs)(f.$,{className:(0,g.cn)(q,{[j[r]]:!0,"btn-text":!0,"opacity-50":c}),type:"button",variant:"secondary"===r?"secondary":"gradient",size:"custom",onClick:l||(()=>{}),disabled:k,children:[c&&s&&(0,d.jsx)(i.default,{src:h.A,alt:"Loading",width:16,height:16,className:"animate-spin"}),c?o||"Loading...":void 0!==e&&e?n||"Continue":void 0!==b&&b?m||"Continue":p||a]})},l=({editMode:a,toggleEditMode:b,onSubmit:c,onDiscard:f,isLoading:g,isSuccess:h,disabled:i,successText:j,loadingText:l,regularText:m,actionType:n,showLoadingIcon:o,pipelineActionState:p,onClose:q})=>{let[r,s]=(0,e.useState)(!1);(0,e.useEffect)(()=>{let a=setTimeout(()=>s(!0),100);return()=>clearTimeout(a)},[]);let t=p?.isLoading&&(p?.lastAction==="stop"||p?.lastAction==="edit"),u=async()=>{await c()};return(0,d.jsx)("div",{className:"overflow-hidden pt-2",children:(0,d.jsxs)("div",{className:`flex gap-3 transition-all duration-500 ease-out ${r?"opacity-100 translate-y-0":"opacity-0 -translate-y-4"}`,children:[!a&&q&&(0,d.jsx)("div",{className:"animate-in fade-in slide-in-from-top-2 duration-500 delay-100",children:(0,d.jsx)(k,{actionType:"primary",onClick:q,regularText:"Close",disabled:t})}),a?(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)("div",{className:"animate-in fade-in slide-in-from-top-2 duration-500 delay-100",children:(0,d.jsx)(k,{onClick:u,regularText:"Save changes",isLoading:g,isSuccess:h,disabled:i||g,successText:j,loadingText:l,actionType:n,showLoadingIcon:o})}),(0,d.jsx)("div",{className:"animate-in fade-in slide-in-from-top-2 duration-500 delay-100",children:(0,d.jsx)(k,{actionType:"secondary",onClick:()=>{f(),q?.()},regularText:"Discard",disabled:g})})]}):(0,d.jsx)("div",{className:"animate-in fade-in slide-in-from-top-2 duration-500 delay-100",children:(0,d.jsx)(k,{actionType:"primary",onClick:b,regularText:"Edit",disabled:t})})]})})},m=function({onSubmit:a,onDiscard:b,toggleEditMode:c,standalone:e,readOnly:f,disabled:g,isLoading:h,isSuccess:i,successText:j,loadingText:m,regularText:n,actionType:o,showLoadingIcon:p,pipelineActionState:q,onClose:r}){return(0,d.jsxs)("div",{className:"flex gap-4",children:[e&&c&&(0,d.jsx)(l,{editMode:!f,onSubmit:a,onDiscard:b||(()=>{}),toggleEditMode:c,isLoading:h,isSuccess:i,disabled:g,successText:j,loadingText:m,regularText:n,actionType:o,showLoadingIcon:p,pipelineActionState:q,onClose:r}),(!e||!c)&&(0,d.jsx)(k,{onClick:a,isLoading:h,isSuccess:i,disabled:g,successText:j,loadingText:m,regularText:n,actionType:o,showLoadingIcon:p})]})}},49853:(a,b,c)=>{c.d(b,{A:()=>d});let d={src:"/_next/static/media/info.0ff69a55.svg",height:16,width:16,blurWidth:0,blurHeight:0}},60697:(a,b,c)=>{c.d(b,{T:()=>f});var d=c(48477);c(48296);var e=c(84621);function f({className:a,...b}){return(0,d.jsx)("textarea",{"data-slot":"textarea",className:(0,e.cn)("border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",a),...b})}},61127:(a,b,c)=>{c.d(b,{I:()=>r});var d=c(48477),e=c(48296),f=c(64708),g=c(65357);c(11023);var h=c(95101),i=c(15831),j=c(19683);function k({streamIndex:a,stream:b,availableKeys:c,onChange:e,errors:f={},readOnly:g}){return(0,d.jsxs)("div",{className:"space-y-4",children:[(0,d.jsxs)("h4",{className:"font-medium",children:["Stream ",a+1]}),(0,d.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,d.jsx)("div",{className:"w-full",children:(0,d.jsx)("div",{className:"w-[65%]",children:(0,d.jsxs)("div",{className:"space-y-2",children:[(0,d.jsx)(h.J,{htmlFor:`join-key-${a}`,className:"label-regular text-content",children:"Join Key"}),(0,d.jsxs)(i.l6,{value:b.joinKey,onValueChange:b=>e(a,"joinKey",b),disabled:g,children:[(0,d.jsx)(i.bq,{id:`join-key-${a}`,className:`w-full input-regular select-content-custom text-content ${f.joinKey?"border-red-500":""}`,children:(0,d.jsx)(i.yv,{placeholder:"Select join key"})}),(0,d.jsx)(i.gC,{className:"select-content-custom",children:c.map(a=>(0,d.jsx)(i.eb,{value:a.value,className:"select-item-custom text-content",children:a.label},a.value))})]}),f.joinKey&&(0,d.jsx)("p",{className:"text-sm text-red-500",children:f.joinKey})]})})}),(0,d.jsxs)("div",{className:"w-full",children:[(0,d.jsx)("div",{className:"w-[65%]",children:(0,d.jsx)(j.x,{window:b.joinTimeWindowValue,setWindow:b=>e(a,"joinTimeWindowValue",b),windowUnit:b.joinTimeWindowUnit,setWindowUnit:b=>e(a,"joinTimeWindowUnit",b),label:"Join Time Window",tooltip:"Maximum time window is 7 days. Longer time windows can process more events but may result in slower performance.",readOnly:g})}),f.joinTimeWindowValue&&(0,d.jsx)("p",{className:"text-sm text-red-500",children:f.joinTimeWindowValue})]})]})]})}var l=c(39293),m=c(98489),n=c(84621);function o({streams:a,dynamicOptions:b,onChange:c,errors:e={},event1:f,event2:g,topic1:h,topic2:i,readOnly:j}){return(0,l.U)(),(0,d.jsxs)("div",{className:"flex flex-col gap-8",children:[(0,d.jsxs)("div",{className:"flex flex-col lg:flex-row gap-4 lg:gap-8 w-full",children:[(0,d.jsx)("div",{className:"w-full lg:w-1/2",children:(0,d.jsx)(k,{streamIndex:0,stream:a[0],availableKeys:b.streams[0].joinKey,onChange:c,errors:{joinKey:e["streams.0.joinKey"],joinTimeWindowValue:e["streams.0.joinTimeWindowValue"]},readOnly:j})}),(0,d.jsx)("div",{className:"w-full lg:w-1/2",children:(0,d.jsxs)("div",{className:"flex flex-col h-full",children:[(0,d.jsx)("div",{className:"flex justify-between items-center mb-2",children:(0,d.jsx)("h3",{className:"text-lg font-medium",children:"Stream 1 Sample Event"})}),(0,d.jsx)("div",{className:"flex-1 bg-background-neutral rounded-md p-4 min-h-[300px]",children:(0,d.jsx)(m.E,{event:(0,n.$c)(f||{}),topic:h?.name||"",isLoadingEvent:!1,eventError:"",isEmptyTopic:!1,onManualEventChange:()=>{},isEditingEnabled:!1,readOnly:j},`event1-${h?.name}-${JSON.stringify(f)}`)})]})})]}),(0,d.jsxs)("div",{className:"flex flex-col lg:flex-row gap-4 lg:gap-8 w-full",children:[(0,d.jsx)("div",{className:"w-full lg:w-1/2",children:(0,d.jsx)(k,{streamIndex:1,stream:a[1],availableKeys:b.streams[1].joinKey,onChange:c,errors:{joinKey:e["streams.1.joinKey"],joinTimeWindowValue:e["streams.1.joinTimeWindowValue"]},readOnly:j})}),(0,d.jsx)("div",{className:"w-full lg:w-1/2",children:(0,d.jsxs)("div",{className:"flex flex-col h-full",children:[(0,d.jsx)("div",{className:"flex justify-between items-center mb-2",children:(0,d.jsx)("h3",{className:"text-lg font-medium",children:"Stream 2 Sample Event"})}),(0,d.jsx)("div",{className:"flex-1 bg-background-neutral rounded-md p-4 min-h-[300px]",children:(0,d.jsx)(m.E,{event:(0,n.$c)(g||{}),topic:i?.name||"",isLoadingEvent:!1,eventError:"",isEmptyTopic:!1,onManualEventChange:()=>{},isEditingEnabled:!1,readOnly:j},`event2-${i?.name}-${JSON.stringify(g)}`)})]})})]})]})}var p=c(46298),q=c(65775);function r({steps:a,onCompleteStep:b,validate:c,index:h=0,readOnly:i,standalone:j,toggleEditMode:k,pipelineActionState:m,onCompleteStandaloneEditing:r}){let{topicsStore:s,joinStore:t,coreStore:u}=(0,f.useStore)(),v=(0,q.D)(),w=(0,l.U)(),{getTopic:x,getEvent:y}=s,{enabled:z,type:A,streams:B,setEnabled:C,setType:D,setStreams:E}=t,[F,G]=(0,e.useState)({streams:[{streamId:B?.[0]?.streamId||"",joinKey:B?.[0]?.joinKey||"",joinTimeWindowValue:B?.[0]?.joinTimeWindowValue||1,joinTimeWindowUnit:B?.[0]?.joinTimeWindowUnit||g.XR.MINUTES.value},{streamId:B?.[1]?.streamId||"",joinKey:B?.[1]?.joinKey||"",joinTimeWindowValue:B?.[1]?.joinTimeWindowValue||1,joinTimeWindowUnit:B?.[1]?.joinTimeWindowUnit||g.XR.MINUTES.value}]}),[H,I]=(0,e.useState)(!0),[J,K]=(0,e.useState)(!1),[L,M]=(0,e.useState)(!1),[N,O]=(0,e.useState)(!1),[P,Q]=(0,e.useState)({}),[R,S]=(0,e.useState)(!1),T=x(h),U=x(h+1),V=T?.events[0]?.event,W=U?.events[0]?.event,X=T&&T.name&&U&&U.name,Y=(J||X&&N)&&F.streams.every(a=>a.streamId&&a.joinKey&&a.joinTimeWindowValue&&a.joinTimeWindowUnit),Z={streams:[{joinKey:(0,n.B$)(V)?.map(a=>({label:a,value:a}))||[],joinTimeWindowUnit:Object.values(g.XR).map(a=>({label:a.label,value:a.value}))},{joinKey:(0,n.B$)(W)?.map(a=>({label:a,value:a}))||[],joinTimeWindowUnit:Object.values(g.XR).map(a=>({label:a.label,value:a.value}))}]};return(0,d.jsx)("form",{className:"space-y-6 w-full",children:(0,d.jsxs)("div",{className:"flex flex-col gap-6 pb-6 bg-background-neutral-faded rounded-md p-6",children:[(0,d.jsx)("div",{className:"flex flex-row gap-8",children:(0,d.jsxs)("div",{className:"w-full",children:[(0,d.jsx)("div",{className:"flex justify-between items-center mb-4",children:(0,d.jsx)("h3",{className:"text-sm font-weight-[400]",children:"This Kafka topic will be used as the data source for the pipeline."})}),(0,d.jsx)(o,{streams:F.streams,dynamicOptions:Z,onChange:(a,b,c)=>{K(!0),G(d=>({streams:d.streams.map((d,e)=>e===a?{...d,[b]:c}:d)})),w.join.fieldChanged({field:b,value:"string"==typeof c?c:JSON.stringify(c),streamIndex:a,streamId:F.streams[a]?.streamId,topicName:0===a?T?.name:U?.name,streamOrientation:0===a?"left":"right",timestamp:new Date().toISOString()}),"joinKey"===b&&c&&(0===a?w.key.leftJoinKey({joinKey:c,topicName:T?.name,streamId:F.streams[a]?.streamId,timestamp:new Date().toISOString()}):w.key.rightJoinKey({joinKey:c,topicName:U?.name,streamId:F.streams[a]?.streamId,timestamp:new Date().toISOString()})),v.invalidateSection(g.Fn.CLICKHOUSE_MAPPER,"Join configuration changed")},errors:P,event1:V,event2:W,topic1:T,topic2:U,readOnly:i})]})}),(0,d.jsx)(p.A,{standalone:j,onSubmit:()=>{M(!0),(()=>{let a={},b=!0;return F.streams.forEach((c,d)=>{c.joinKey||(a[`streams.${d}.joinKey`]="Join key is required",b=!1),(!c.joinTimeWindowValue||c.joinTimeWindowValue<1)&&(a[`streams.${d}.joinTimeWindowValue`]="Time window value must be at least 1",b=!1),c.joinTimeWindowUnit||(a[`streams.${d}.joinTimeWindowUnit`]="Time window unit is required",b=!1)}),Q(a),O(b),b})()&&(C(!0),D("temporal"),E(F.streams.map((a,b)=>({...a,orientation:0===b?"left":"right",topicName:0===b?T?.name||"":U?.name||""}))),w.join.configurationCompleted({joinType:"temporal",leftStream:{streamId:F.streams[0].streamId,joinKey:F.streams[0].joinKey,timeWindow:`${F.streams[0].joinTimeWindowValue} ${F.streams[0].joinTimeWindowUnit}`,topicName:T?.name},rightStream:{streamId:F.streams[1].streamId,joinKey:F.streams[1].joinKey,timeWindow:`${F.streams[1].joinTimeWindowValue} ${F.streams[1].joinTimeWindowUnit}`,topicName:U?.name},timestamp:new Date().toISOString()}),v.onSectionConfigured(g.Fn.JOIN_CONFIGURATOR),j?(S(!0),r?.()):b(g.Fn.JOIN_CONFIGURATOR))},onDiscard:()=>{u.discardSection("join")},isLoading:!1,isSuccess:R,disabled:!Y,successText:"Continue",loadingText:"Loading...",regularText:"Continue",actionType:"primary",showLoadingIcon:!1,readOnly:i,toggleEditMode:k,pipelineActionState:m,onClose:r})]})})}},62992:(a,b,c)=>{c.d(b,{Z:()=>j});var d=c(48477),e=c(48296),f=c(4179),g=c(26403),h=c(95795),i=c(84621);function j({availableOptions:a,selectedOption:b,onSelect:c,placeholder:j="Select an option",className:k,disabled:l=!1,clearable:m=!0,open:n,onOpenChange:o,readOnly:p,label:q}){let[r,s]=(0,e.useState)(!1),[t,u]=(0,e.useState)(""),[v,w]=(0,e.useState)(0),x=(0,e.useRef)(null),y=(0,e.useRef)(null);(0,e.useRef)(null);let[z,A]=(0,e.useState)([]),[B,C]=(0,e.useState)([]),[D,E]=(0,e.useState)(null),[F,G]=(0,e.useState)("below"),[H,I]=(0,e.useState)(null),J=void 0!==n,K=J?n:r,L=a=>{J?o?.(a):s(a),a||I(null)};return(0,d.jsxs)("div",{ref:y,className:(0,i.cn)("relative w-full",k),onKeyDown:a=>{if(!K){("ArrowDown"===a.key||"ArrowUp"===a.key)&&(a.preventDefault(),L(!0));return}if(0!==z.length)switch(a.key){case"ArrowDown":a.preventDefault(),w(a=>(a+1)%z.length);break;case"ArrowUp":a.preventDefault(),w(a=>(a-1+z.length)%z.length);break;case"Enter":v>=0&&v<z.length&&(a.preventDefault(),c(z[v]),L(!1));break;case"Escape":a.preventDefault(),L(!1);break;case"Tab":L(!1)}},children:[(0,d.jsx)("div",{className:"flex items-center",children:(0,d.jsxs)("div",{className:"flex flex-col items-left gap-2 w-full",children:[q&&(0,d.jsx)("span",{className:"text-sm text-content",children:q}),(0,d.jsxs)("div",{className:"relative w-full",children:[(0,d.jsx)(f.p,{ref:x,type:"text",placeholder:j,value:t,onChange:a=>{let d=a.target.value;u(d),L(!0),""===d&&I(null),""===d&&b&&c(null)},onClick:()=>!l&&!p&&L(!0),onFocus:()=>!l&&!p&&L(!0),className:(0,i.cn)("w-full pr-10 input-regular input-border-regular text-content",l&&"opacity-60 cursor-not-allowed"),disabled:l||p,"aria-expanded":K,"aria-controls":"searchable-select-dropdown",role:"combobox"}),(0,d.jsxs)("div",{className:"absolute right-3 top-1/2 -translate-y-1/2 flex items-center space-x-1",children:[m&&b&&(0,d.jsxs)(g.$,{type:"button",variant:"ghost",size:"icon",className:"h-5 w-5 opacity-70 hover:opacity-100",onClick:a=>{a.stopPropagation(),u(""),c(null),x.current&&x.current.focus()},disabled:l,"aria-label":"Clear selection",children:[(0,d.jsx)("span",{className:"sr-only",children:"Clear"}),(0,d.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"h-4 w-4",children:[(0,d.jsx)("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),(0,d.jsx)("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})]}),(0,d.jsx)(h.A,{className:(0,i.cn)("h-4 w-4 opacity-50 cursor-pointer",l&&"cursor-not-allowed"),onClick:()=>!l&&L(!K),"aria-hidden":"true"})]})]})]})}),K&&!l&&!1]})}c(36553)},63674:(a,b,c)=>{c.d(b,{c:()=>Y});var d=c(48477),e=c(48296),f=c(9401),g=c(53337),h=c(26431),i=c(35557),j=c(65357);let k={base:{fields:{authMethod:{name:"authMethod",label:"Authentication Method",placeholder:"Select authentication method",required:"Authentication Method is required",type:"select",options:Object.values(j.qp).filter(a=>a.active).map(a=>({label:a.label,value:a.name}))},securityProtocol:{name:"securityProtocol",label:"Security Protocol",placeholder:"Select security protocol",required:"Security Protocol is required",type:"select",options:Object.values(j.NS).map(a=>({label:a,value:a}))},bootstrapServers:{name:"bootstrapServers",label:"Bootstrap Servers",placeholder:"Enter bootstrap servers",required:"Bootstrap Servers are required",type:"text"}}}},l={[j.qp["SASL/PLAIN"].name]:{securityProtocol:j.NS.SASL_PLAINTEXT,authMethod:j.qp["SASL/PLAIN"],fields:{username:{name:"saslPlain.username",label:"Username",placeholder:"Enter username",required:"Username is required",type:"text"},password:{name:"saslPlain.password",label:"Password",placeholder:"Enter password",required:"Password is required",type:"password"}}},[j.qp["SASL/JAAS"].name]:{securityProtocol:j.NS.SASL_SSL,authMethod:j.qp["SASL/JAAS"],fields:{jaasConfig:{name:"saslJaas.jaasConfig",label:"JAAS Config",placeholder:"Enter JAAS Config",required:"JAAS Config is required",type:"textarea"}}},[j.qp["SASL/GSSAPI"].name]:{securityProtocol:j.NS.SASL_SSL,authMethod:j.qp["SASL/GSSAPI"],fields:{kerberosPrincipal:{name:"saslGssapi.kerberosPrincipal",label:"Kerberos Principal",placeholder:"Enter kerberos principal",required:"Kerberos Principal is required",type:"text"},kerberosKeytab:{name:"saslGssapi.kerberosKeytab",label:"Kerberos Keytab",placeholder:"Enter kerberos keytab",required:"Kerberos Keytab is required",type:"textarea"},serviceName:{name:"saslGssapi.serviceName",label:"Kerberos Service Name",placeholder:"Enter kerberos service name",optional:"Kerberos Service Name is optional",type:"text",defaultValue:"kafka"},kerberosRealm:{name:"saslGssapi.kerberosRealm",label:"Kerberos Realm",placeholder:"Enter kerberos realm",optional:"Kerberos Realm is optional",type:"text"},kdc:{name:"saslGssapi.kdc",label:"Kerberos KDC",placeholder:"Enter kerberos kdc",optional:"Kerberos KDC is optional",type:"text"},krb5Config:{name:"saslGssapi.krb5Config",label:"Kerberos Configuration (krb5.conf)",placeholder:"Enter kerberos configuration (krb5.conf)",optional:"Kerberos Configuration (krb5.conf) is optional",type:"textarea"}}},[j.qp["SASL/OAUTHBEARER"].name]:{securityProtocol:j.NS.SASL_SSL,authMethod:j.qp["SASL/OAUTHBEARER"],fields:{oauthBearerToken:{name:"saslOauthbearer.oauthBearerToken",label:"OAuth Bearer Token",placeholder:"Enter oauth bearer token",required:"OAuth Bearer Token is required",type:"textarea"}}},[j.qp["SASL/SCRAM-256"].name]:{securityProtocol:j.NS.SASL_SSL,authMethod:j.qp["SASL/SCRAM-256"],fields:{username:{name:"saslScram256.username",label:"Username",placeholder:"Enter username",required:"Username is required",type:"text"},password:{name:"saslScram256.password",label:"Password",placeholder:"Enter password",required:"Password is required",type:"password"}}},[j.qp["SASL/SCRAM-512"].name]:{securityProtocol:j.NS.SASL_SSL,authMethod:j.qp["SASL/SCRAM-512"],fields:{username:{name:"saslScram512.username",label:"Username",placeholder:"Enter username",required:"Username is required",type:"text"},password:{name:"saslScram512.password",label:"Password",placeholder:"Enter password",required:"Password is required",type:"password"}}},[j.qp["Delegation tokens"].name]:{securityProtocol:j.NS.SASL_SSL,authMethod:j.qp["Delegation tokens"],fields:{delegationToken:{name:"delegationToken.delegationToken",label:"Delegation Token",placeholder:"Enter delegation token",required:"Delegation Token is required",type:"textarea"}}},[j.qp["SASL/LDAP"].name]:{securityProtocol:j.NS.SASL_SSL,authMethod:j.qp["SASL/LDAP"],fields:{ldapServerUrl:{name:"ldap.ldapServerUrl",label:"LDAP Server URL",placeholder:"Enter LDAP server URL",required:"LDAP Server URL is required",type:"text"},ldapServerPort:{name:"ldap.ldapServerPort",label:"LDAP Server Port",placeholder:"Enter LDAP server port",required:"LDAP Server Port is required",type:"number"},ldapBaseDn:{name:"ldap.ldapBaseDn",label:"LDAP Base DN",placeholder:"Enter LDAP base DN",required:"LDAP Base DN is required",type:"text"},ldapBindDn:{name:"ldap.ldapBindDn",label:"LDAP Bind DN",placeholder:"Enter LDAP bind DN",required:"LDAP Bind DN is required",type:"text"},ldapBindPassword:{name:"ldap.ldapBindPassword",label:"LDAP Bind Password",placeholder:"Enter LDAP bind password",required:"LDAP Bind Password is required",type:"password"},userSearchFilter:{name:"ldap.ldapUserSearchFilter",label:"LDAP User Search Filter",placeholder:"Enter LDAP user search filter",required:"LDAP User Search Filter is required",type:"text"}}},[j.qp.AWS_MSK_IAM.name]:{securityProtocol:j.NS.SASL_SSL,authMethod:j.qp.AWS_MSK_IAM,fields:{awsAccessKey:{name:"awsIam.awsAccessKey",label:"AWS Access Key ID",placeholder:"Enter AWS access key ID",required:"AWS Access Key ID is required",type:"textarea"},awsAccessKeySecret:{name:"awsIam.awsAccessKeySecret",label:"AWS Access Key Secret",placeholder:"Enter AWS access key secret",required:"AWS Access Key Secret is required",type:"textarea"},awsRegion:{name:"awsIam.awsRegion",label:"AWS Region",placeholder:"Enter AWS region",required:"AWS Region is required",type:"text"},awsAuthorizationIdentity:{name:"awsIam.awsAuthorizationIdentity",label:"AWS Authorization Identity",placeholder:"Enter AWS authorization identity",required:"AWS Authorization Identity is required",type:"text"},awsIAMRoleArn:{name:"awsIam.awsIAMRoleArn",label:"AWS Role ARN",placeholder:"Enter AWS Role ARN",optional:"AWS Role ARN is optional",type:"text"},awsSessionToken:{name:"awsIam.awsSessionToken",label:"AWS Session Token",placeholder:"Enter AWS session token",optional:"AWS Session Token is optional",type:"text"}}},[j.qp.mTLS.name]:{securityProtocol:j.NS.SASL_SSL,authMethod:j.qp.mTLS,fields:{clientCert:{name:"mtls.clientCert",label:"Client Certificate",placeholder:"Enter client certificate",required:"Client Certificate is required",type:"textarea"},clientKey:{name:"mtls.clientKey",label:"Client Key",placeholder:"Enter client key",required:"Client Key is required",type:"textarea"},password:{name:"mtls.password",label:"Password",placeholder:"Enter password",required:"Password is required",type:"password"}}},[j.qp.NO_AUTH.name]:{securityProtocol:j.NS.SASL_PLAINTEXT,authMethod:j.qp.NO_AUTH,fields:{}},truststore:{fields:{location:{name:"truststore.location",label:"Certificate File",placeholder:"Upload or paste certificate content",required:!1,type:"file"},password:{name:"truststore.password",label:"Truststore Password (optional)",placeholder:"Enter password for encrypted truststore",required:!1,type:"password"},type:{name:"truststore.type",label:"Truststore Type (optional)",placeholder:"JKS, PKCS12, PEM, etc.",required:!1,type:"text"},algorithm:{name:"truststore.algorithm",label:"SSL Algorithm (optional)",placeholder:"Leave empty for self-signed certificates",required:!1,type:"text"},certificates:{name:"truststore.certificates",label:"CA Certificate (PEM format)",placeholder:"Paste CA certificate content here or upload a file",required:!1,type:"textarea"}}}},m={authMethod:j.qp["SASL/PLAIN"].name,securityProtocol:j.NS.SASL_PLAINTEXT,bootstrapServers:"true"===process.env.NEXT_PUBLIC_IS_DOCKER?"host.docker.internal:9092,host.docker.internal:9093,host.docker.internal:9094":"localhost:9092,localhost:9093,localhost:9094",isConnected:!1,noAuth:{truststore:{location:"",password:"",type:"",algorithm:"",certificates:"",certificatesFileName:""}},saslPlain:{username:"admin",password:"admin-secret",truststore:{location:"",password:"",type:"",algorithm:"",certificates:"",certificatesFileName:""},consumerGroup:""},saslJaas:{jaasConfig:""},saslGssapi:{kerberosPrincipal:"",kerberosKeytab:"",kerberosKeytabFileName:"",kerberosRealm:"",kdc:"",serviceName:"kafka",krb5Config:"",krb5ConfigFileName:"",useTicketCache:!1,ticketCachePath:"",truststore:{location:"",password:"",type:"",algorithm:"",certificates:"",certificatesFileName:""}},saslOauthbearer:{oauthBearerToken:""},saslScram256:{username:"",password:"",truststore:{location:"",password:"",type:"",algorithm:"",certificates:"",certificatesFileName:""},consumerGroup:""},saslScram512:{username:"",password:"",truststore:{location:"",password:"",type:"",algorithm:"",certificates:"",certificatesFileName:""},consumerGroup:""},delegationToken:{delegationToken:""},ldap:{ldapServerUrl:"",ldapServerPort:"",ldapBaseDn:"",ldapBindDn:"",ldapBindPassword:"",ldapUserSearchFilter:""},awsIam:{awsAccessKey:"",awsAccessKeySecret:"",awsRegion:"",awsIAMRoleArn:""},mtls:{clientCert:"",clientKey:"",password:""}};var n=c(45363),o=c(71877),p=c(82400),q=c(9206),r=c(84621),s=c(26403),t=c(4179);function u({className:a,...b}){return(0,d.jsx)("div",{"data-slot":"input-group",role:"group",className:(0,r.cn)("group/input-group border-input dark:bg-input/30 relative flex w-full items-center rounded-md border shadow-xs transition-[color,box-shadow] outline-none","h-9 min-w-0 has-[>textarea]:h-auto","has-[>[data-align=inline-start]]:[&>input]:pl-2","has-[>[data-align=inline-end]]:[&>input]:pr-2","has-[>[data-align=block-start]]:h-auto has-[>[data-align=block-start]]:flex-col has-[>[data-align=block-start]]:[&>input]:pb-3","has-[>[data-align=block-end]]:h-auto has-[>[data-align=block-end]]:flex-col has-[>[data-align=block-end]]:[&>input]:pt-3","has-[[data-slot=input-group-control]:focus-visible]:border-ring has-[[data-slot=input-group-control]:focus-visible]:ring-ring/50 has-[[data-slot=input-group-control]:focus-visible]:ring-[3px]","has-[[data-slot][aria-invalid=true]]:ring-destructive/20 has-[[data-slot][aria-invalid=true]]:border-destructive dark:has-[[data-slot][aria-invalid=true]]:ring-destructive/40",a),...b})}c(60697);let v=(0,q.F)("text-muted-foreground flex h-auto cursor-text items-center justify-center gap-2 py-1.5 text-sm font-medium select-none [&>svg:not([class*='size-'])]:size-4 [&>kbd]:rounded-[calc(var(--radius)-5px)] group-data-[disabled=true]/input-group:opacity-50",{variants:{align:{"inline-start":"order-first pl-3 has-[>button]:ml-[-0.45rem] has-[>kbd]:ml-[-0.35rem]","inline-end":"order-last pr-3 has-[>button]:mr-[-0.45rem] has-[>kbd]:mr-[-0.35rem]","block-start":"order-first w-full justify-start px-3 pt-3 [.border-b]:pb-3 group-has-[>input]/input-group:pt-2.5","block-end":"order-last w-full justify-start px-3 pb-3 [.border-t]:pt-3 group-has-[>input]/input-group:pb-2.5"}},defaultVariants:{align:"inline-start"}});function w({className:a,align:b="inline-start",...c}){return(0,d.jsx)("div",{role:"group","data-slot":"input-group-addon","data-align":b,className:(0,r.cn)(v({align:b}),a),onClick:a=>{a.target.closest("button")||a.currentTarget.parentElement?.querySelector("input")?.focus()},...c})}let x=(0,q.F)("text-sm shadow-none flex gap-2 items-center",{variants:{size:{xs:"h-6 gap-1 px-2 rounded-[calc(var(--radius)-5px)] [&>svg:not([class*='size-'])]:size-3.5 has-[>svg]:px-2",sm:"h-8 px-2.5 gap-1.5 rounded-md has-[>svg]:px-2.5","icon-xs":"size-6 rounded-[calc(var(--radius)-5px)] p-0 has-[>svg]:p-0","icon-sm":"size-8 p-0 has-[>svg]:p-0"}},defaultVariants:{size:"xs"}});function y({className:a,type:b="button",variant:c="ghost",size:e="xs",...f}){return(0,d.jsx)(s.$,{type:b,"data-size":e,variant:c,className:(0,r.cn)(x({size:e}),a),...f})}function z({className:a,...b}){return(0,d.jsx)(t.p,{"data-slot":"input-group-control",className:(0,r.cn)("flex-1 rounded-none border-0 bg-transparent shadow-none focus-visible:ring-0 dark:bg-transparent",a),...b})}function A({id:a,label:b,placeholder:c="No file selected",allowedFileTypes:f,onChange:g,value:h,initialFileName:i,readType:j="text",disabled:k=!1,className:l="",showClearButton:m=!0,showLoadingState:q=!1,showErrorState:s=!1,onValidate:t,hintText:v,externalError:x}){let[A,B]=(0,e.useState)(i||""),[C,D]=(0,e.useState)(""),[E,F]=(0,e.useState)(!1),[G,H]=(0,e.useState)(null),I=(0,e.useRef)(null),J=async a=>{let b=a.target.files?.[0];if(b){F(!0),H(null),B(b.name);try{let a=new FileReader;switch(a.onload=async a=>{let c=a.target?.result;if(t){let a=await t(c,b.name);if(!a.valid){H(a.error||"Invalid file"),F(!1),B("");return}}D(c),F(!1)},a.onerror=()=>{H("Failed to read file"),F(!1),B("")},j){case"text":default:a.readAsText(b);break;case"base64":a.readAsDataURL(b)}}catch(a){H(a instanceof Error?a.message:"Failed to read file"),F(!1),B("")}}},K=(0,e.useMemo)(()=>{let a=f.filter(a=>a&&""!==a.trim());if(0!==a.length)return a.map(a=>`.${a}`).join(",")},[f]),L=x||G;return(0,d.jsxs)("div",{className:`flex flex-col space-y-2 ${l}`,children:[b&&(0,d.jsx)("label",{className:"text-sm font-medium text-content",children:b}),(0,d.jsx)("input",{ref:I,id:a,type:"file",onChange:J,className:"hidden",accept:K,disabled:k||E}),(0,d.jsxs)(u,{className:(0,r.cn)("input-border-regular",L&&"input-border-error","has-[[data-slot=input-group-control]:focus-visible]:!ring-0","has-[[data-slot=input-group-control]:focus-visible]:!border-[var(--color-background-primary,#a5b9e4)]","has-[[data-slot=input-group-control]:focus-visible]:!shadow-[0_0_0_2px_rgba(165,185,228,0.25)]"),children:[(0,d.jsx)(z,{value:A,placeholder:c,readOnly:!0,disabled:k,"aria-invalid":!!L}),(0,d.jsxs)(w,{align:"inline-end",children:[q&&E&&(0,d.jsx)(n.A,{className:"h-4 w-4 animate-spin text-muted-foreground"}),m&&A&&!E&&(0,d.jsx)(y,{onClick:()=>{D(""),B(""),H(null),g("",""),I.current&&(I.current.value="")},disabled:k,variant:"ghost",size:"icon-xs",title:"Clear file",children:(0,d.jsx)(o.A,{className:"h-4 w-4"})}),(0,d.jsxs)(y,{onClick:()=>{I.current?.click()},disabled:k||E,variant:"secondary",size:"xs",children:[(0,d.jsx)(p.A,{className:"h-3.5 w-3.5"}),"Browse"]})]})]}),s&&L&&(0,d.jsx)("div",{className:"text-sm text-content",children:L}),v&&(0,d.jsx)("div",{className:"text-xs text-content",children:v})]})}function B({onFileRead:a,disabled:b,className:c,externalError:e,initialFileName:f,value:g}){return(0,d.jsx)(A,{id:"certificate-upload",placeholder:"Select certificate file",allowedFileTypes:[],onChange:(b,c)=>{a(b,c)},value:g,initialFileName:f,readType:"text",disabled:b,className:c,showClearButton:!0,showLoadingState:!0,showErrorState:!0,onValidate:a=>a&&0!==a.trim().length?(!(a.includes("-----BEGIN CERTIFICATE-----")||a.includes("-----BEGIN RSA PRIVATE KEY-----")||a.includes("-----BEGIN PRIVATE KEY-----")||a.includes("-----BEGIN PUBLIC KEY-----")),{valid:!0}):{valid:!1,error:"Certificate content is empty"},hintText:"All file types accepted (PEM, CRT, CER, KEY, or files without extensions like ca-cert)",externalError:e})}let C=({errors:a,readOnly:b})=>{let{register:c,watch:e}=(0,g.xW)(),f=e("authMethod"),k=e("securityProtocol"),m=f===j.qp["SASL/PLAIN"].name&&("SASL_SSL"===k||"SSL"===k);return(0,d.jsxs)(h.gE,{className:"space-y-4",children:[(0,d.jsxs)("div",{className:"flex flex-col lg:flex-row gap-4",children:[(0,d.jsx)("div",{className:"space-y-2 w-full lg:w-1/2",children:(0,i.bl)({field:l[j.qp["SASL/PLAIN"].name].fields.username,register:c,errors:a,readOnly:b})}),(0,d.jsx)("div",{className:"space-y-2 w-full lg:w-1/2",children:(0,i.bl)({field:l[j.qp["SASL/PLAIN"].name].fields.password,register:c,errors:a,readOnly:b})})]}),m&&(0,d.jsxs)("div",{className:"space-y-4 mt-4",children:[(0,d.jsx)("div",{className:"text-sm font-medium text-content",children:"SSL/TLS Configuration"}),(0,d.jsx)(N,{errors:a,readOnly:b,authMethodPrefix:"saslPlain"})]})]})},D=({errors:a,readOnly:b})=>{let{watch:c}=(0,g.xW)(),e=c("authMethod"),f=c("securityProtocol"),i=e===j.qp.NO_AUTH.name&&("SASL_SSL"===f||"SSL"===f);return(0,d.jsx)(h.gE,{className:"space-y-4",children:i&&(0,d.jsxs)("div",{className:"space-y-4",children:[(0,d.jsx)("div",{className:"text-sm font-medium text-content",children:"SSL/TLS Configuration"}),(0,d.jsx)(N,{errors:a,readOnly:b,authMethodPrefix:"noAuth"})]})})},E=({errors:a,readOnly:b})=>{let{register:c}=(0,g.xW)();return(0,d.jsx)(h.gE,{className:"space-y-4",children:(0,i.$C)({formConfig:l,formGroupName:"SASL/JAAS",register:c,errors:a,readOnly:b})})},F=({errors:a,readOnly:b})=>{let{register:c,watch:e,setValue:f}=(0,g.xW)(),j=e("securityProtocol"),k=Object.entries(l["SASL/GSSAPI"].fields).filter(([a])=>"kerberosKeytab"!==a&&"krb5Config"!==a);return(0,d.jsxs)(h.gE,{className:"space-y-4",children:[k.map(([e,f])=>(0,d.jsx)("div",{className:"space-y-2 w-full",children:(0,i.bl)({field:f,register:c,errors:a,readOnly:b})},e)),(0,d.jsx)("div",{className:"space-y-2 w-full",children:(0,d.jsx)(A,{label:"Kerberos Configuration (krb5.conf) File",id:"saslGssapi.krb5Config",placeholder:"Select krb5.conf file",allowedFileTypes:["conf","txt","cfg","ini","properties"],onChange:(a,b)=>{console.log("fileContent",a,"fileName",b);try{f("saslGssapi.krb5Config",a,{shouldValidate:!0,shouldDirty:!0}),f("saslGssapi.krb5ConfigFileName",b,{shouldValidate:!1,shouldDirty:!0})}catch(a){console.error("Error reading krb5.conf file:",a)}},value:e("saslGssapi.krb5Config"),initialFileName:e("saslGssapi.krb5ConfigFileName"),readType:"text",showLoadingState:!0,showErrorState:!0,hintText:"Accepted formats: .conf, .txt, .cfg, .ini, .properties",externalError:a?O(a,"saslGssapi.krb5Config"):void 0})}),(0,d.jsx)("div",{className:"space-y-2 w-full",children:(0,d.jsx)(A,{label:"Kerberos Keytab File",id:"saslGssapi.kerberosKeytab",placeholder:"Select keytab file",allowedFileTypes:["keytab","txt"],onChange:(a,b)=>{console.log("fileContent",a,"fileName",b);try{f("saslGssapi.kerberosKeytab",a,{shouldValidate:!0,shouldDirty:!0}),f("saslGssapi.kerberosKeytabFileName",b,{shouldValidate:!1,shouldDirty:!0})}catch(a){console.error("Error reading keytab file:",a)}},value:e("saslGssapi.kerberosKeytab"),initialFileName:e("saslGssapi.kerberosKeytabFileName"),readType:"base64",showLoadingState:!0,showErrorState:!0,hintText:"Accepted formats: .keytab, .txt",externalError:a?O(a,"saslGssapi.kerberosKeytab"):void 0})}),("SASL_SSL"===j||"SSL"===j)&&(0,d.jsxs)("div",{className:"space-y-4 mt-4",children:[(0,d.jsx)("div",{className:"text-sm font-medium text-content",children:"SSL/TLS Configuration"}),(0,d.jsx)(N,{errors:a,readOnly:b,authMethodPrefix:"saslGssapi"})]})]})},G=({errors:a,readOnly:b})=>{let{register:c}=(0,g.xW)();return(0,d.jsx)(h.gE,{className:"space-y-4",children:(0,i.$C)({formConfig:l,formGroupName:"SASL/OAUTHBEARER",register:c,errors:a,readOnly:b})})},H=({errors:a,readOnly:b})=>{let{register:c,watch:e}=(0,g.xW)(),f=e("securityProtocol");return(0,d.jsxs)(h.gE,{className:"space-y-4",children:[(0,i.$C)({formConfig:l,formGroupName:"SASL/SCRAM-256",register:c,errors:a,readOnly:b}),("SASL_SSL"===f||"SSL"===f)&&(0,d.jsxs)("div",{className:"space-y-4 mt-4",children:[(0,d.jsx)("div",{className:"text-sm font-medium text-content",children:"SSL/TLS Configuration"}),(0,d.jsx)(N,{errors:a,readOnly:b,authMethodPrefix:"saslScram256"})]})]})},I=({errors:a,readOnly:b})=>{let{register:c,watch:e}=(0,g.xW)(),f=e("securityProtocol");return(0,d.jsxs)(h.gE,{className:"space-y-4",children:[(0,i.$C)({formConfig:l,formGroupName:"SASL/SCRAM-512",register:c,errors:a,readOnly:b}),("SASL_SSL"===f||"SSL"===f)&&(0,d.jsxs)("div",{className:"space-y-4 mt-4",children:[(0,d.jsx)("div",{className:"text-sm font-medium text-content",children:"SSL/TLS Configuration"}),(0,d.jsx)(N,{errors:a,readOnly:b,authMethodPrefix:"saslScram512"})]})]})},J=({errors:a,readOnly:b})=>{let{register:c}=(0,g.xW)();return(0,d.jsx)(h.gE,{children:(0,i.$C)({formConfig:l,formGroupName:"mTLS",register:c,errors:a,readOnly:b})})},K=({errors:a,readOnly:b})=>{let{register:c}=(0,g.xW)();return(0,d.jsx)(h.gE,{children:(0,i.$C)({formConfig:l,formGroupName:"AWS_MSK_IAM",register:c,errors:a,readOnly:b})})},L=({errors:a,readOnly:b})=>{let{register:c}=(0,g.xW)();return(0,d.jsx)(h.gE,{children:(0,i.$C)({formConfig:l,formGroupName:"Delegation tokens",register:c,errors:a,readOnly:b})})},M=({errors:a,readOnly:b})=>{let{register:c}=(0,g.xW)();return(0,d.jsx)(h.gE,{children:(0,i.$C)({formConfig:l,formGroupName:"SASL/LDAP",register:c,errors:a,readOnly:b})})},N=({errors:a,readOnly:b,authMethodPrefix:c})=>{let{register:e,setValue:f,watch:j}=(0,g.xW)(),k=l.truststore.fields,m=c?`${c}.truststore`:"truststore";return(0,d.jsx)(h.gE,{className:"space-y-4",children:Object.entries(k).map(([c,g])=>{let h={...g,name:`${m}.${c}`};if("location"===c||"password"===c||"type"===c||"algorithm"===c)return null;if("certificates"===c){let i=a?O(a,h.name):void 0,k=`${m}.certificatesFileName`;return(0,d.jsxs)("div",{className:"space-y-2 w-full",children:[(0,d.jsx)("label",{htmlFor:h.name,className:"block text-sm font-medium text-content",children:g.label}),(0,d.jsx)("div",{className:"space-y-2",children:(0,d.jsx)(B,{onFileRead:(a,b)=>{f(h.name,a,{shouldValidate:!0,shouldDirty:!0}),f(k,b,{shouldValidate:!1,shouldDirty:!0})},disabled:b,className:"w-full",externalError:i,value:j(h.name),initialFileName:j(k)})}),(0,d.jsxs)("div",{className:"space-y-1 mt-2",children:[(0,d.jsx)("label",{htmlFor:`${h.name}-textarea`,className:"block text-xs text-content",children:"Or paste certificate content:"}),(0,d.jsx)("textarea",{id:`${h.name}-textarea`,...e(h.name,{required:!1}),placeholder:g.placeholder,className:`w-full min-h-[150px] px-3 py-2 text-sm rounded-md font-mono input-border-regular focus:outline-none focus:border-[var(--color-background-primary,#a5b9e4)] focus:shadow-[0_0_0_2px_rgba(165,185,228,0.25)] ${i?"input-border-error":""}`,readOnly:b})]}),i&&(0,d.jsx)("p",{className:"text-sm text-content",children:i})]},c)}return(0,d.jsx)("div",{className:"space-y-2 w-full",children:(0,i.bl)({field:h,register:e,errors:a,readOnly:b})},c)})})};function O(a,b){if(!a||!b)return;let c=b?.split("."),d=a;for(let a of c){if(!d[a])return;d=d[a]}return d.message?d.message:void 0}let P=({errors:a,authMethod:b,readOnly:c,securityProtocolOptions:f})=>{let{register:j}=(0,g.xW)(),[l,m]=(0,e.useState)(!1);return(0,e.useEffect)(()=>{let a=setTimeout(()=>m(!0),100);return()=>clearTimeout(a)},[]),(0,d.jsxs)(h.gE,{className:`space-y-4 transition-all duration-700 ease-out ${l?"opacity-100 translate-y-0":"opacity-0 -translate-y-4"}`,children:[(0,d.jsxs)("div",{className:"flex flex-col lg:flex-row gap-4",children:[(0,d.jsx)("div",{className:"space-y-2 w-full lg:w-1/2",children:(0,i.bl)({field:k.base.fields.authMethod,register:j,errors:a,readOnly:c})}),(0,d.jsx)("div",{className:"space-y-2 w-full lg:w-1/2",children:(0,i.bl)({field:{...k.base.fields.securityProtocol,options:f},register:j,errors:a,readOnly:c})})]}),(0,d.jsx)("div",{className:"space-y-2 w-full",children:(0,i.bl)({field:k.base.fields.bootstrapServers,register:j,errors:a,readOnly:c})})]})},Q=({authMethod:a,securityProtocol:b,errors:c,readOnly:f})=>{let{watch:h}=(0,g.xW)(),[i,k]=(0,e.useState)(!1);(0,e.useEffect)(()=>{let a=setTimeout(()=>k(!0),200);return()=>clearTimeout(a)},[]);let l=h("authMethod"),m=Object.values(l===j.qp["SASL/SCRAM-256"].name||l===j.qp["SASL/SCRAM-512"].name?j.dw:j.NS).map(a=>({label:a,value:a}));return(0,d.jsxs)("div",{className:`space-y-4 md:space-y-6 transition-all duration-700 ease-out ${i?"opacity-100 translate-y-0":"opacity-0 -translate-y-4"}`,children:[(0,d.jsx)("div",{children:(({authMethod:a,readOnly:b})=>(0,d.jsx)(P,{errors:c,authMethod:a,readOnly:b,securityProtocolOptions:m}))({authMethod:a,readOnly:f})}),(0,d.jsx)("div",{children:(({readOnly:b})=>{switch(a){case"SASL/PLAIN":default:return(0,d.jsx)(C,{errors:c,readOnly:b});case"SASL/JAAS":return(0,d.jsx)(E,{errors:c,readOnly:b});case"SASL/GSSAPI":return(0,d.jsx)(F,{errors:c,readOnly:b});case"SASL/OAUTHBEARER":return(0,d.jsx)(G,{errors:c,readOnly:b});case"SASL/SCRAM-256":return(0,d.jsx)(H,{errors:c,readOnly:b});case"SASL/SCRAM-512":return(0,d.jsx)(I,{errors:c,readOnly:b});case"AWS_MSK_IAM":return(0,d.jsx)(K,{errors:c,readOnly:b});case"mTLS":return(0,d.jsx)(J,{errors:c,readOnly:b});case"Delegation tokens":return(0,d.jsx)(L,{errors:c,readOnly:b});case"SASL/LDAP":return(0,d.jsx)(M,{errors:c,readOnly:b});case"NO_AUTH":return(0,d.jsx)(D,{errors:c,readOnly:b})}})({readOnly:f})})]})};var R=c(29771),S=c(46298);let T=({onTestConnection:a,onDiscardConnectionChange:b,isConnecting:c,connectionResult:h,readOnly:i,standalone:j,initialValues:k,authMethod:l,securityProtocol:m,bootstrapServers:n,toggleEditMode:o,pipelineActionState:p,onClose:q})=>{let r=(0,e.useRef)(k),[s,t]=(0,e.useState)(!0),[u,v]=(0,e.useState)(!1),w=(0,e.useRef)(!1),x=!!n,y=(0,g.mN)({resolver:(0,f.u)(R.YT),defaultValues:k,mode:"onBlur",criteriaMode:"firstError",shouldFocusError:!1}),{watch:z,setValue:A,trigger:B,handleSubmit:C}=y,{errors:D,isValid:E,isDirty:F,touchedFields:G}=y.formState,H=z("authMethod"),I=z("securityProtocol");(0,e.useEffect)(()=>{H&&("SASL/SCRAM-256"===H||"SASL/SCRAM-512"===H?A("securityProtocol","SASL_SSL"):"SASL/PLAIN"===H?A("securityProtocol","SASL_PLAINTEXT"):"NO_AUTH"===H?A("securityProtocol","PLAINTEXT"):"SASL/JAAS"===H?A("securityProtocol","SASL_JAAS"):"SASL/GSSAPI"===H&&A("securityProtocol","SASL_GSSAPI"))},[H,A]),(0,e.useEffect)(()=>{r.current=k},[k]),(0,e.useEffect)(()=>(x&&!w.current&&(l&&A("authMethod",l),m&&A("securityProtocol",m),n&&A("bootstrapServers",n),w.current=!0),()=>{s&&t(!1)}),[l,m,n,A,s,x]);let J=u||x&&!s&&Object.keys(G).length>0,K=async()=>{let b=y.getValues();if(v(!0),!await y.trigger())return void console.log("Form has validation errors",y.formState.errors);if(j){a&&await a(b);return}a&&await a(b)};return(0,d.jsx)(g.Op,{...y,children:(0,d.jsxs)("form",{onSubmit:C(()=>{}),className:"space-y-6",onChange:()=>{u||v(!0)},onKeyDown:a=>{"Enter"===a.key&&a.preventDefault()},children:[(0,d.jsx)(Q,{authMethod:H,securityProtocol:I,errors:J?D:{},readOnly:i}),(0,d.jsx)(S.A,{onSubmit:K,onDiscard:()=>{y.reset(r.current),v(!1),w.current=!1,l&&y.setValue("authMethod",l),m&&y.setValue("securityProtocol",m),n&&y.setValue("bootstrapServers",n),b()},toggleEditMode:o,standalone:j,readOnly:i,disabled:c||p?.isLoading&&(p?.lastAction==="stop"||p?.lastAction==="edit"),isLoading:c||p?.isLoading&&(p?.lastAction==="stop"||p?.lastAction==="edit"),isSuccess:h?.success,successText:"Continue",loadingText:p?.isLoading&&p?.lastAction==="stop"?"Stopping pipeline for editing...":p?.isLoading&&p?.lastAction==="edit"?"Saving configuration...":"Testing...",regularText:"Continue",actionType:"primary",showLoadingIcon:!0,pipelineActionState:p,onClose:q})]})})};var U=c(64708),V=c(39293),W=c(75580),X=c(64279);function Y({steps:a,onCompleteStep:b,validate:c,readOnly:f=!1,toggleEditMode:g,standalone:h,onCompleteStandaloneEditing:i,pipelineActionState:k,pipeline:l}){let[n,o]=(0,e.useState)(!1),{kafkaStore:p,topicsStore:q,coreStore:r}=(0,U.useStore)(),{operationsSelected:s}=r,{setKafkaAuthMethod:t,setKafkaSecurityProtocol:u,setKafkaBootstrapServers:v,setKafkaNoAuth:w,setKafkaSaslPlain:x,setKafkaSaslJaas:y,setKafkaSaslGssapi:z,setKafkaSaslOauthbearer:A,setKafkaSaslScram256:B,setKafkaSaslScram512:C,setKafkaDelegationTokens:D,setKafkaConnection:E,setKafkaSkipAuth:F,isConnected:G,authMethod:H,securityProtocol:I,bootstrapServers:J,saslPlain:K,saslJaas:L,saslGssapi:M,saslOauthbearer:N,saslScram256:O,saslScram512:P,delegationTokens:Q,noAuth:R}=p,{resetTopicsStore:S}=q;(0,e.useRef)(J);let[Y,Z]=(0,e.useState)(null),$=(0,V.U)(),{testConnection:_,connectionResult:aa,kafkaConnection:ab,isConnecting:ac}=(()=>{let[a,b]=(0,e.useState)(!1),[c,d]=(0,e.useState)(null),[f,g]=(0,e.useState)(null);return{testConnection:async a=>{try{b(!0),d(null),await new Promise(a=>setTimeout(a,5e3));let c={servers:a.bootstrapServers,securityProtocol:a.securityProtocol,authMethod:a.authMethod};switch(a.authMethod){case"NO_AUTH":a.noAuth.truststore?.certificates&&(c.certificate=a.noAuth.truststore.certificates);break;case"SASL/PLAIN":c.username=a.saslPlain.username,c.password=a.saslPlain.password,c.consumerGroup=a.saslPlain.consumerGroup,a.saslPlain.truststore?.certificates&&(c.certificate=a.saslPlain.truststore.certificates);break;case"SASL/JAAS":c.jaasConfig=a.saslJaas.jaasConfig;break;case"SASL/GSSAPI":c.kerberosPrincipal=a.saslGssapi.kerberosPrincipal,c.kerberosKeytab=a.saslGssapi.kerberosKeytab,c.kerberosRealm=a.saslGssapi.kerberosRealm,c.kdc=a.saslGssapi.kdc,c.serviceName=a.saslGssapi.serviceName,c.krb5Config=a.saslGssapi.krb5Config,a.saslGssapi.truststore?.certificates&&(c.certificate=a.saslGssapi.truststore.certificates);break;case"SASL/OAUTHBEARER":c.oauthBearerToken=a.saslOauthbearer.oauthBearerToken;break;case"SASL/SCRAM-256":case"SASL/SCRAM-512":let e="SASL/SCRAM-256"===a.authMethod?a.saslScram256:a.saslScram512;c.username=e.username,c.password=e.password,c.consumerGroup=e.consumerGroup,e.truststore?.certificates&&(c.certificate=e.truststore.certificates);break;case"AWS_MSK_IAM":c.awsAccessKey=a.awsIam.awsAccessKey,c.awsAccessKeySecret=a.awsIam.awsAccessKeySecret,c.awsRegion=a.awsIam.awsRegion;break;case"Delegation tokens":c.delegationToken=a.delegationTokens.delegationToken;break;case"SASL/LDAP":c.ldapServerUrl=a.ldap.ldapServerUrl,c.ldapServerPort=a.ldap.ldapServerPort,c.ldapBindDn=a.ldap.ldapBindDn,c.ldapBindPassword=a.ldap.ldapBindPassword,c.ldapUserSearchFilter=a.ldap.ldapUserSearchFilter,c.ldapBaseDn=a.ldap.ldapBaseDn;break;case"mTLS":c.clientCert=a.mtls.clientCert,c.clientKey=a.mtls.clientKey,c.password=a.mtls.password}let f=await fetch("/ui-api/kafka/",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(c)}),h=await f.json();if(h.success){let b={success:!0,message:"Successfully connected to Kafka cluster!"};return d(b),g({...a,isConnected:!0}),b}{let b={success:!1,message:h.error||"Failed to connect to Kafka cluster"};return d(b),g({...a,isConnected:!1}),b}}catch(c){console.error("Error testing Kafka connection:",c);let b={success:!1,message:c instanceof Error?c.message:"Unknown error occurred"};return d(b),g({...a,isConnected:!1}),b}finally{b(!1)}},isConnecting:a,connectionResult:c,kafkaConnection:f}})(),{executeAction:ad}=(0,W.z)(l),ae={...m,authMethod:H||m.authMethod,securityProtocol:I||m.securityProtocol,bootstrapServers:J||m.bootstrapServers,saslPlain:K||m.saslPlain,saslGssapi:M||m.saslGssapi,noAuth:R||m.noAuth,saslScram256:O||m.saslScram256,saslScram512:P||m.saslScram512},af=async a=>{$.kafka.started({authMethod:a.authMethod,securityProtocol:a.securityProtocol}),Z(a);let c=await _(a);if(c.success){let{authMethod:c,securityProtocol:d,bootstrapServers:e}=a;E({...a,bootstrapServers:a.bootstrapServers,isConnected:!0}),t(c),u(d),v(e),c===j.qp.NO_AUTH.name?(F(!0),w({...a.noAuth})):F(!1),a.authMethod===j.qp["SASL/PLAIN"].name&&x({...a.saslPlain}),a.authMethod===j.qp["SASL/JAAS"].name&&y({...a.saslJaas}),a.authMethod===j.qp["SASL/GSSAPI"].name&&z({...a.saslGssapi}),a.authMethod===j.qp["SASL/OAUTHBEARER"].name&&A({...a.saslOauthbearer}),a.authMethod===j.qp["SASL/SCRAM-256"].name&&B({...a.saslScram256}),a.authMethod===j.qp["SASL/SCRAM-512"].name&&C({...a.saslScram512}),a.authMethod===j.qp["Delegation tokens"].name&&D({...a.delegationTokens}),h&&g&&(r.markAsDirty(),console.log("[KafkaConnection] Configuration marked as dirty - changes will be saved on Resume")),!h&&b?b(j.Fn.KAFKA_CONNECTION):h&&i&&i(),$.kafka.success({authMethod:a.authMethod,securityProtocol:a.securityProtocol})}else $.kafka.failed({authMethod:a.authMethod,securityProtocol:a.securityProtocol,error:c.message})};return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(T,{onTestConnection:af,onDiscardConnectionChange:()=>{o(!0)},isConnecting:ac,connectionResult:aa,readOnly:f,standalone:h,initialValues:ae,authMethod:H,securityProtocol:I,bootstrapServers:J,toggleEditMode:g,pipelineActionState:k,onClose:i}),aa&&!n&&(0,d.jsx)(X.A,{message:aa.message,success:aa.success})]})}},64279:(a,b,c)=>{c.d(b,{A:()=>f});var d=c(48477),e=c(48296);let f=function({message:a,success:b}){let[c,f]=(0,e.useState)(!1);return(0,d.jsx)("div",{className:"mt-4 overflow-hidden",children:(0,d.jsx)("div",{className:`p-3 rounded transform transition-all duration-500 ease-out ${b?"bg-green-100 text-green-800":"bg-red-100 text-red-800"} ${c?"translate-y-0 opacity-100":"-translate-y-4 opacity-0"}`,children:a})})}},65569:(a,b,c)=>{c.d(b,{w:()=>u});var d=c(48477),e=c(48296),f=c(64708),g=c(9093),h=c(65357),i=c(9401),j=c(53337),k=c(26431),l=c(35557);let m={directConnectionForm:{fields:{host:{name:"directConnection.host",label:"Host",placeholder:"Enter host, e.g. clickhouse.mycompany.com without http:// or https://",required:"Host is required",type:"text"},httpPort:{name:"directConnection.httpPort",label:"HTTP(S) Port",placeholder:"Enter HTTP(S) port, e.g. 8443",required:"HTTP(S) Port is required",type:"text"},username:{name:"directConnection.username",label:"Username",placeholder:"Enter username",required:"Username is required",type:"text"},password:{name:"directConnection.password",label:"Password",placeholder:"Enter password",required:"Password is required",type:"password"},nativePort:{name:"directConnection.nativePort",label:"Native Port",placeholder:"Enter native port, e.g. 9440",required:"Native port is required",type:"text"},useSSL:{name:"directConnection.useSSL",label:"Use SSL",type:"boolean",defaultValue:!0,placeholder:"Use SSL"},skipCertificateVerification:{name:"directConnection.skipCertificateVerification",label:"Skip Certificate Verification",type:"boolean",defaultValue:!0,placeholder:"Skip Certificate Verification"}}},proxyConnectionForm:{fields:{proxyUrl:{name:"proxyConnection.proxyUrl",label:"Proxy URL",placeholder:"Enter proxy URL",required:"Proxy URL is required",type:"text"},proxyUsername:{name:"proxyConnection.proxyUsername",label:"Proxy Username",placeholder:"Enter proxy username",required:"Proxy username is required",type:"text"},proxyPassword:{name:"proxyConnection.proxyPassword",label:"Proxy Password",placeholder:"Enter proxy password",required:"Proxy password is required",type:"password"}}},connectionStringConnectionForm:{fields:{connectionString:{name:"connectionStringConnection.connectionString",label:"Connection String",placeholder:"Enter connection string",required:"Connection string is required",type:"text"}}}},n=({errors:a,readOnly:b,isLoading:c})=>{let{register:f}=(0,j.xW)(),[g,h]=(0,e.useState)(!1);(0,e.useEffect)(()=>{let a=setTimeout(()=>h(!0),100);return()=>clearTimeout(a)},[]);let{directConnectionForm:i}=m;return(0,d.jsxs)(k.gE,{className:`space-y-4 transition-all duration-700 ease-out ${g?"opacity-100 translate-y-0":"opacity-0 -translate-y-4"}`,children:[(0,d.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[(0,d.jsx)("div",{className:"space-y-2",children:(0,l.bl)({field:{...i.fields.host,readOnly:c},register:f,errors:a,readOnly:b})}),(0,d.jsx)("div",{className:"space-y-2",children:(0,l.bl)({field:{...i.fields.httpPort,readOnly:c},register:f,errors:a,readOnly:b})})]}),(0,d.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[(0,d.jsx)("div",{className:"space-y-2",children:(0,l.bl)({field:{...i.fields.username,readOnly:c},register:f,errors:a,readOnly:b})}),(0,d.jsx)("div",{className:"space-y-2",children:(0,l.bl)({field:{...i.fields.password,readOnly:c},register:f,errors:a,readOnly:b})})]}),(0,d.jsx)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:(0,d.jsx)("div",{className:"space-y-2",children:(0,l.bl)({field:{...i.fields.nativePort,readOnly:c},register:f,errors:a,readOnly:b})})}),(0,d.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[(0,d.jsx)("div",{className:"space-y-2",children:(0,l.bl)({field:{...i.fields.useSSL,readOnly:c,defaultValue:i.fields.useSSL.defaultValue?.toString()},register:f,errors:a,readOnly:b})}),(0,d.jsx)("div",{className:"space-y-2",children:(0,l.bl)({field:{...i.fields.skipCertificateVerification,readOnly:c,defaultValue:i.fields.skipCertificateVerification.defaultValue?.toString()},register:f,errors:a,readOnly:b})})]})]})},o=({errors:a,readOnly:b,isLoading:c})=>{let[f,g]=(0,e.useState)(!1);return(0,e.useEffect)(()=>{let a=setTimeout(()=>g(!0),200);return()=>clearTimeout(a)},[]),(0,d.jsx)("div",{className:`space-y-4 md:space-y-6 transition-all duration-700 ease-out ${f?"opacity-100 translate-y-0":"opacity-0 -translate-y-4"}`,children:(0,d.jsx)(n,{errors:a,readOnly:b,isLoading:c})})};var p=c(13556),q=c(46298);let r=({onTestConnection:a,onDiscardConnectionChange:b,isConnecting:c,connectionResult:f,readOnly:g,standalone:h,initialValues:k,host:l,httpPort:m,username:n,password:r,nativePort:s,useSSL:t,skipCertificateVerification:u,toggleEditMode:v,pipelineActionState:w,onClose:x})=>{let y=(0,e.useRef)(k),[z,A]=(0,e.useState)(!0),[B,C]=(0,e.useState)(!1),D=(0,e.useRef)(!1),E=!!l,F=(0,j.mN)({resolver:(0,i.u)(p.g7),defaultValues:k,mode:"onBlur",criteriaMode:"firstError",shouldFocusError:!1}),{watch:G,setValue:H,trigger:I,handleSubmit:J}=F,{errors:K,isValid:L,isDirty:M,touchedFields:N}=F.formState;G("directConnection.host"),G("directConnection.httpPort"),G("directConnection.username"),G("directConnection.password"),G("directConnection.nativePort"),G("directConnection.useSSL"),G("directConnection.skipCertificateVerification"),(0,e.useEffect)(()=>{y.current=k},[k]),(0,e.useEffect)(()=>(E&&!D.current&&(l&&H("directConnection.host",l),m&&H("directConnection.httpPort",m),n&&H("directConnection.username",n),r&&H("directConnection.password",r),s&&H("directConnection.nativePort",s),void 0!==t&&H("directConnection.useSSL",t),void 0!==u&&H("directConnection.skipCertificateVerification",u),D.current=!0),()=>{z&&A(!1)}),[l,m,n,r,s,t,u,H,z,E]),(0,e.useEffect)(()=>{E||(H("directConnection.useSSL",!0),H("directConnection.skipCertificateVerification",!0))},[H,E]);let O=B||E&&!z&&Object.keys(N).length>0,P=async()=>{let b=F.getValues();if(C(!0),!await F.trigger())return void console.log("Form has validation errors",F.formState.errors);if(h){a&&await a(b);return}a&&await a(b)};return(0,d.jsx)(j.Op,{...F,children:(0,d.jsxs)("form",{onSubmit:J(()=>{}),className:"space-y-6",onChange:()=>{B||C(!0)},onKeyDown:a=>{"Enter"===a.key&&a.preventDefault()},children:[(0,d.jsx)(o,{errors:O?K:{},readOnly:g,isLoading:c}),(0,d.jsx)(q.A,{standalone:h,onSubmit:P,onDiscard:()=>{F.reset(y.current),C(!1),D.current=!1,l&&F.setValue("directConnection.host",l),m&&F.setValue("directConnection.httpPort",m),n&&F.setValue("directConnection.username",n),r&&F.setValue("directConnection.password",r),s&&F.setValue("directConnection.nativePort",s),void 0!==t&&F.setValue("directConnection.useSSL",t),void 0!==u&&F.setValue("directConnection.skipCertificateVerification",u),b()},toggleEditMode:v,readOnly:g,isLoading:c||w?.isLoading&&(w?.lastAction==="stop"||w?.lastAction==="edit"),isSuccess:f?.success,disabled:c||w?.isLoading&&(w?.lastAction==="stop"||w?.lastAction==="edit"),successText:"Continue",loadingText:w?.isLoading&&w?.lastAction==="stop"?"Stopping pipeline for editing...":w?.isLoading&&w?.lastAction==="edit"?"Saving configuration...":"Testing...",regularText:"Continue",actionType:"primary",showLoadingIcon:!0,pipelineActionState:w,onClose:x})]})})};var s=c(39293),t=c(64279);function u({onCompleteStep:a,onCompleteStandaloneEditing:b,standalone:c,readOnly:i=!1,toggleEditMode:j,pipelineActionState:k}){let[l,m]=(0,e.useState)(!1),{clickhouseConnectionStore:n}=(0,f.useStore)(),o=(0,s.U)(),{clickhouseConnection:p,setClickhouseConnection:q}=n,{directConnection:u}=p,[v,w]=(0,e.useState)(!1),[x,y]=(0,e.useState)(null),{isLoading:z,connectionStatus:A,connectionError:B,testConnection:C}=(0,g.E)(),D={connectionType:"direct",directConnection:{host:u?.host||"",httpPort:u?.httpPort||"",username:u?.username||"",password:u?.password||"",nativePort:u?.nativePort||"",useSSL:u?.useSSL??!0,skipCertificateVerification:u?.skipCertificateVerification??!0}},E=async d=>{o.clickhouse.started({host:d.directConnection.host,useSSL:d.directConnection.useSSL}),y(d);let e=await C({host:d.directConnection.host,httpPort:d.directConnection.httpPort,username:d.directConnection.username,password:d.directConnection.password,nativePort:d.directConnection.nativePort,useSSL:d.directConnection.useSSL,skipCertificateVerification:d.directConnection.skipCertificateVerification});e?.success&&e.databases?.length>0&&(d=>{if(q({...p,directConnection:{host:d.directConnection.host,httpPort:d.directConnection.httpPort,username:d.directConnection.username,password:d.directConnection.password,nativePort:d.directConnection.nativePort,useSSL:d.directConnection.useSSL,skipCertificateVerification:d.directConnection.skipCertificateVerification},connectionStatus:"success",connectionError:null}),c&&j){let{coreStore:a}=f.useStore.getState();a.markAsDirty(),console.log("[ClickhouseConnection] Configuration marked as dirty - changes will be saved on Resume")}!c&&a?a(h.Fn.CLICKHOUSE_CONNECTION):c&&b&&b()})(d)};return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(r,{onTestConnection:E,onDiscardConnectionChange:()=>{q({...p,connectionStatus:"idle",connectionError:null}),m(!0)},isConnecting:z,connectionResult:"success"===A?{success:!0,message:"Successfully connected to ClickHouse!"}:"error"===A?{success:!1,message:B||"Connection failed"}:null,readOnly:i,standalone:c,initialValues:D,host:u?.host||"",httpPort:u?.httpPort||"",username:u?.username||"",password:u?.password||"",nativePort:u?.nativePort||"",useSSL:u?.useSSL??!0,skipCertificateVerification:u?.skipCertificateVerification??!0,toggleEditMode:j,pipelineActionState:k,onClose:b}),"success"===A&&!l&&(0,d.jsx)(t.A,{message:"Successfully connected to ClickHouse!",success:!0}),"error"===A&&!l&&(0,d.jsx)(t.A,{message:B||"Connection failed",success:!1})]})}},65775:(a,b,c)=>{c.d(b,{D:()=>h});let d={nodes:{deduplication:{id:"deduplication",type:"operation",dependencies:["kafka-connection"],dependents:["topic-selection","deduplication-configurator","clickhouse-connection","clickhouse-mapper"],resetMethod:"resetOperationState"},joining:{id:"joining",type:"operation",dependencies:["kafka-connection"],dependents:["topic-selection","join-configurator","clickhouse-connection","clickhouse-mapper"],resetMethod:"resetOperationState"},"deduplication-joining":{id:"deduplication-joining",type:"operation",dependencies:["kafka-connection"],dependents:["topic-selection","deduplication-configurator","join-configurator","clickhouse-connection","clickhouse-mapper"],resetMethod:"resetOperationState"},"ingest-only":{id:"ingest-only",type:"operation",dependencies:["kafka-connection"],dependents:["clickhouse-connection","clickhouse-mapper"],resetMethod:"resetOperationState"},"kafka-connection":{id:"kafka-connection",type:"step",dependencies:[],dependents:["topic-selection","deduplication-configurator","join-configurator","clickhouse-mapper"],resetMethod:"resetKafkaConnection"},"topic-selection":{id:"topic-selection",type:"step",dependencies:["kafka-connection"],dependents:["join-configurator","clickhouse-mapper"],resetMethod:"resetTopicSelection"},"deduplication-configurator":{id:"deduplication-configurator",type:"step",dependencies:[],dependents:[],resetMethod:"resetDeduplicationConfig"},"join-configurator":{id:"join-configurator",type:"step",dependencies:[],dependents:["clickhouse-mapper"],resetMethod:"resetJoinConfig"},"clickhouse-connection":{id:"clickhouse-connection",type:"step",dependencies:["kafka-connection","topic-selection","deduplication-configurator","join-configurator"],dependents:["clickhouse-mapper"],resetMethod:"resetClickhouseConnection"},"clickhouse-mapper":{id:"clickhouse-mapper",type:"step",dependencies:["clickhouse-connection"],dependents:[],resetMethod:"resetClickhouseMapper"},kafkaStore:{id:"kafkaStore",type:"slice",dependencies:[],dependents:["topicsStore","clickhouseStore"],resetMethod:"resetKafkaStore"},topicsStore:{id:"topicsStore",type:"slice",dependencies:["kafkaStore"],dependents:["joinStore","clickhouseStore"],resetMethod:"resetTopicsStore"},joinStore:{id:"joinStore",type:"slice",dependencies:["topicsStore"],dependents:["clickhouseStore"],resetMethod:"resetJoinStore"},clickhouseStore:{id:"clickhouseStore",type:"slice",dependencies:["kafkaStore"],dependents:[],resetMethod:"resetClickhouseStore"},stepsStore:{id:"stepsStore",type:"slice",dependencies:[],dependents:[],resetMethod:"resetStepsStore"}},edges:[{from:"kafkaStore",to:"topicsStore"},{from:"kafkaStore",to:"clickhouseStore"},{from:"kafkaStore",to:"joinStore"},{from:"topicsStore",to:"joinStore"},{from:"topicsStore",to:"clickhouseStore"},{from:"joinStore",to:"clickhouseStore"},{from:"stepsStore",to:"kafkaStore"},{from:"stepsStore",to:"topicsStore"},{from:"stepsStore",to:"joinStore"},{from:"stepsStore",to:"clickhouseStore"}]};var e=c(65357),f=c(64708);class g{constructor(a,b){this.store=a,this.dependencyGraph=b||d}onSectionConfigured(a){let b=this.getStoreSliceForSection(a);b&&b.length>0&&b.forEach(a=>{a?.markAsValid&&a.markAsValid()}),this.findDependentSections(a).forEach(b=>{let c=this.getStoreSliceForSection(b);c&&c.length>0&&c.forEach(b=>{b?.markAsInvalidated&&b.markAsInvalidated(a)})})}onSectionReset(a){let b=this.getStoreSliceForSection(a);b&&b.length>0&&b.forEach(a=>{a?.markAsNotConfigured&&a.markAsNotConfigured()}),this.findDependentSections(a).forEach(a=>{let b=this.getStoreSliceForSection(a);b&&b.length>0&&b.forEach(a=>{a?.markAsNotConfigured&&a.markAsNotConfigured()})})}invalidateSection(a,b){let c=this.getStoreSliceForSection(a);c&&c.length>0&&c.forEach(a=>{a?.markAsInvalidated&&a.markAsInvalidated(b)})}markSectionAsValid(a){let b=this.getStoreSliceForSection(a);b&&b.length>0&&b.forEach(a=>{a?.markAsValid&&a.markAsValid()})}getSectionValidation(a){let b=this.getStoreSliceForSection(a);return b&&b.length>0?b.map(a=>a?.validation||{status:"not-configured"}):{status:"not-configured"}}resetAllValidations(){Object.values(e.Fn).forEach(a=>{let b=this.getStoreSliceForSection(a);b&&b.length>0&&b.forEach(a=>{a?.resetValidation&&a.resetValidation()})})}findDependentSections(a){let b=this.getSectionNodeMapping()[a];if(!b)return[];let c=this.dependencyGraph.nodes[b];return c?c.dependents.map(a=>this.getNodeSectionMapping()[a]).filter(Boolean):[]}getStoreSliceForSection(a){return({[e.Fn.KAFKA_CONNECTION]:[this.store.kafkaStore],[e.Fn.TOPIC_SELECTION_1]:[this.store.topicsStore],[e.Fn.TOPIC_SELECTION_2]:[this.store.topicsStore],[e.Fn.DEDUPLICATION_CONFIGURATOR]:[this.store.deduplicationStore],[e.Fn.TOPIC_DEDUPLICATION_CONFIGURATOR_1]:[this.store.deduplicationStore,this.store.topicsStore],[e.Fn.TOPIC_DEDUPLICATION_CONFIGURATOR_2]:[this.store.deduplicationStore,this.store.topicsStore],[e.Fn.JOIN_CONFIGURATOR]:[this.store.joinStore],[e.Fn.CLICKHOUSE_CONNECTION]:[this.store.clickhouseConnectionStore],[e.Fn.CLICKHOUSE_MAPPER]:[this.store.clickhouseDestinationStore],[e.Fn.REVIEW_CONFIGURATION]:[this.store.coreStore],[e.Fn.DEPLOY_PIPELINE]:[this.store.coreStore]})[a]}getSectionNodeMapping(){return{[e.Fn.KAFKA_CONNECTION]:"kafka-connection",[e.Fn.TOPIC_SELECTION_1]:"topic-selection",[e.Fn.TOPIC_SELECTION_2]:"topic-selection",[e.Fn.DEDUPLICATION_CONFIGURATOR]:"deduplication-configurator",[e.Fn.TOPIC_DEDUPLICATION_CONFIGURATOR_1]:"deduplication-configurator",[e.Fn.TOPIC_DEDUPLICATION_CONFIGURATOR_2]:"deduplication-configurator",[e.Fn.JOIN_CONFIGURATOR]:"join-configurator",[e.Fn.CLICKHOUSE_CONNECTION]:"clickhouse-connection",[e.Fn.CLICKHOUSE_MAPPER]:"clickhouse-mapper",[e.Fn.REVIEW_CONFIGURATION]:"review-configuration",[e.Fn.DEPLOY_PIPELINE]:"deploy-pipeline"}}getNodeSectionMapping(){return{"kafka-connection":e.Fn.KAFKA_CONNECTION,"topic-selection":e.Fn.TOPIC_SELECTION_1,"deduplication-configurator":e.Fn.DEDUPLICATION_CONFIGURATOR,"join-configurator":e.Fn.JOIN_CONFIGURATOR,"clickhouse-connection":e.Fn.CLICKHOUSE_CONNECTION,"clickhouse-mapper":e.Fn.CLICKHOUSE_MAPPER}}}let h=()=>new g((0,f.useStore)())},75580:(a,b,c)=>{c.d(b,{z:()=>g});var d=c(48296),e=c(54299),f=c(99927);let g=a=>{let[b,c]=(0,d.useState)({isLoading:!1,error:null,lastAction:null});return{actionState:b,executeAction:async(b,d)=>{c({isLoading:!0,error:null,lastAction:b});try{let f;switch(b){case"stop":await (0,e.JP)(a.pipeline_id),f=void 0;break;case"resume":await (0,e.WQ)(a.pipeline_id),f=void 0;break;case"terminate":d?.graceful?await (0,e.JP)(a.pipeline_id):await (0,e.sw)(a.pipeline_id),f=void 0;break;case"delete":await (0,e.gP)(a.pipeline_id),f=void 0;break;case"rename":if(!d?.name)throw Error("New name is required for rename action");f=await (0,e.lY)(a.pipeline_id,d.name);break;case"edit":if(!d)throw Error("Pipeline configuration is required for edit action");f=await (0,e.Xs)(a.pipeline_id,d);break;default:throw Error(`Unsupported action: ${b}`)}return c({isLoading:!1,error:null,lastAction:b}),f}catch(a){throw c({isLoading:!1,error:a.message||`Failed to ${b} pipeline`,lastAction:b}),a}},clearError:()=>{c(a=>({...a,error:null}))},getActionConfiguration:b=>(0,f.zg)(b,a.status),getButtonText:b=>(0,f.QU)(b,a.status),getAvailableActionsForPipeline:()=>(0,f.tE)(a.status),isActionDisabled:c=>(0,f.zg)(c,a.status).isDisabled||b.isLoading,shouldShowModal:b=>(0,f.zg)(b,a.status).showModal}}},80152:(a,b,c)=>{c.d(b,{Q:()=>i});var d=c(48477),e=c(48296),f=c(26403),g=c(67606),h=c(84621);function i({type:a,database:b,table:c,onRefresh:i,className:j,size:k="sm",variant:l="outline",disabled:m}){let[n,o]=(0,e.useState)(!1),p=async()=>{o(!0);try{await i()}finally{o(!1)}};return(0,d.jsxs)(f.$,{variant:l,size:k,onClick:p,disabled:n||m,className:(0,h.cn)("transition-all duration-200",{"animate-spin":n,"opacity-50 cursor-not-allowed":m&&!n,"text-muted-foreground":m&&!n},j,"btn-neutral"),title:`Refresh ${a} data`,children:[(0,d.jsx)(g.A,{className:(0,h.cn)("h-4 w-4",{"text-muted-foreground opacity-50":m&&!n})}),(0,d.jsx)("span",{className:(0,h.cn)({"text-muted-foreground opacity-50":m&&!n}),children:"Reload"})]})}},92571:(a,b,c)=>{c.d(b,{d:()=>h});var d=c(48477),e=c(48296),f=c(81003),g=c(84621);let h=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)(f.bL,{className:(0,g.cn)("peer inline-flex h-5 w-9 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors","focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2","disabled:cursor-not-allowed disabled:opacity-50","data-[state=unchecked]:bg-muted dark:data-[state=unchecked]:bg-slate-700","data-[state=checked]:bg-primary","dark:border-slate-600",a),...b,ref:c,children:(0,d.jsx)(f.zi,{className:(0,g.cn)("pointer-events-none block h-4 w-4 rounded-full shadow-lg ring-0 transition-transform","bg-white dark:bg-slate-200","data-[state=unchecked]:translate-x-0","data-[state=checked]:translate-x-4")})}));h.displayName=f.bL.displayName},93862:(a,b,c)=>{c.d(b,{g:()=>K});var d=c(48477),e=c(48296),f=c(84135),g=c(2120),h=c(87437),i=c(3251),j=c(62992),k=c(4179),l=c(26403),m=c(95795),n=c(84621);function o({primaryOptions:a,secondaryOptions:b,selectedOption:c,onSelect:f,placeholder:g="Select an option",className:h,disabled:i=!1,clearable:j=!0,primaryLabel:o="Primary Fields",secondaryLabel:p="Secondary Fields",sourceTopic:q,open:r,onOpenChange:s}){let[t,u]=(0,e.useState)(!1),[v,w]=(0,e.useState)(""),[x,y]=(0,e.useState)({list:"primary",index:0}),z=(0,e.useRef)(null),A=(0,e.useRef)(null);(0,e.useRef)(null),(0,e.useRef)(null);let B=void 0!==r,C=B?r:t,D=a=>{B?s?.(a):u(a),a||N(null)},[E,F]=(0,e.useState)([]),[G,H]=(0,e.useState)([]),[I,J]=(0,e.useState)("below"),[K,L]=(0,e.useState)(null),[M,N]=(0,e.useState)(null);return(0,d.jsxs)("div",{ref:A,className:(0,n.cn)("relative w-full",h),onKeyDown:a=>{if(!C){("ArrowDown"===a.key||"ArrowUp"===a.key)&&(a.preventDefault(),D(!0));return}let b=x.list,c="primary"===b?"secondary":"primary",d="primary"===c?E:G;switch(a.key){case"ArrowDown":a.preventDefault(),x.index<("primary"===b?E:G).length-1?y({...x,index:x.index+1}):d.length>0&&y({list:c,index:0});break;case"ArrowUp":a.preventDefault(),x.index>0?y({...x,index:x.index-1}):d.length>0&&y({list:c,index:d.length-1});break;case"Enter":a.preventDefault();let e=x.list,g="primary"===e?E:G;x.index>=0&&x.index<g.length&&(f(g[x.index],e),D(!1));break;case"Escape":a.preventDefault(),D(!1)}},children:[(0,d.jsxs)("div",{className:"flex items-center",children:[(0,d.jsx)(k.p,{ref:z,type:"text",placeholder:g,value:v,onChange:a=>{let b=a.target.value;w(b),D(!0),""===b&&N(null)},onClick:()=>!i&&D(!0),className:(0,n.cn)("w-full pr-10 input-regular input-border-regular text-content",i&&"opacity-60 cursor-not-allowed"),disabled:i}),(0,d.jsxs)("div",{className:"absolute right-3 top-1/2 -translate-y-1/2 flex items-center space-x-1",children:[j&&c&&(0,d.jsxs)(l.$,{type:"button",variant:"ghost",size:"icon",className:"h-5 w-5 opacity-70 hover:opacity-100",onClick:()=>{w(""),f(null,"primary")},disabled:i,children:[(0,d.jsx)("span",{className:"sr-only",children:"Clear"}),(0,d.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"h-4 w-4",children:[(0,d.jsx)("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),(0,d.jsx)("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})]}),(0,d.jsx)(m.A,{className:(0,n.cn)("h-4 w-4 opacity-50",i&&"cursor-not-allowed"),onClick:()=>!i&&D(!C)})]})]}),C&&!i&&K&&!1]})}c(36553);var p=c(15831),q=c(65357),r=c(4673),s=c(78864),t=c(39293),u=c(80152);let v={src:"/_next/static/media/left-topic.c5c95726.svg",height:20,width:20,blurWidth:0,blurHeight:0},w={src:"/_next/static/media/right-topic.6002b49f.svg",height:20,width:20,blurWidth:0,blurHeight:0},x={src:"/_next/static/media/move-right.96866002.svg",height:24,width:24,blurWidth:0,blurHeight:0};function y({eventFields:a,mappedColumns:b,updateColumnMapping:c,mapEventFieldToColumn:f,primaryEventFields:g=[],secondaryEventFields:h=[],primaryTopicName:k="Primary Topic",secondaryTopicName:l="Secondary Topic",isJoinMapping:m=!1,readOnly:n,unmappedNonNullableColumns:y=[],unmappedDefaultColumns:z=[],onRefreshTableSchema:A,selectedDatabase:B,selectedTable:C}){let[D,E]=(0,e.useState)(null);(0,t.U)();let F=(a,b)=>{E(b?a:null)};return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsxs)("div",{className:"flex justify-between items-center mb-4 mt-8",children:[(0,d.jsxs)("h3",{className:"text-lg font-medium text-content",children:["Map incoming event fields to ClickHouse table columns.",n&&(0,d.jsx)("span",{className:"text-sm text-gray-500 ml-2",children:"(Read-only)"})]}),(0,d.jsx)(u.Q,{type:"tableSchema",database:B,table:C,onRefresh:async()=>A(),size:"sm",variant:"outline",disabled:n})]}),(0,d.jsxs)(i.XI,{className:`[&_tr]:border-0 [&_td]:border-0 [&_th]:border-0 [&_thead]:border-0 [&_tbody]:border-0 border-0 table-fixed w-full ${n?"opacity-75":""}`,children:[(0,d.jsx)(i.A0,{className:"[&_tr]:border-b-0",children:(0,d.jsxs)(i.Hj,{className:"border-0",children:[(0,d.jsx)(i.nd,{className:"text-content border-0 w-[40%]",children:"Fields in incoming event"}),(0,d.jsx)(i.nd,{className:"text-content border-0 w-[25%]",children:"Data Type (incoming)"}),(0,d.jsx)(i.nd,{className:"text-content text-center border-0 w-[5%]",children:"Topic"}),(0,d.jsx)(i.nd,{className:"text-content border-0 w-[40%]",children:"Destination column"})]})}),(0,d.jsx)(i.BF,{className:"border-0",children:b.map((b,e)=>{let t=y.includes(b.name)&&!b.eventField,u=z.includes(b.name)&&!b.eventField,A=b.eventField&&b.jsonType&&!(0,r.ry)(b.jsonType,b.type),B=t||A||u;return(0,d.jsxs)(i.Hj,{className:`border-0 ${!n?"hover:bg-[var(--color-background-neutral-faded)]":""}`,style:{transition:"background-color 0.2s ease-in-out"},children:[(0,d.jsx)(i.nA,{className:"w-[30%]",children:(0,d.jsxs)("div",{children:[m?(0,d.jsx)(o,{primaryOptions:g,secondaryOptions:h,selectedOption:b.eventField,onSelect:(a,b)=>f(e,a||"",b),placeholder:"Select event field",className:`w-full ${t?"[&_input]:border-red-500 [&_input]:border-2":u?"[&_input]:border-orange-500 [&_input]:border-2":""}`,primaryLabel:k,secondaryLabel:l,open:D===e,onOpenChange:a=>F(e,a),disabled:n}):(0,d.jsx)(j.Z,{availableOptions:a,selectedOption:b.eventField,onSelect:a=>f(e,a||""),placeholder:"Select event field",className:`w-full ${t?"[&_input]:border-red-500 [&_input]:border-2":u?"[&_input]:border-orange-500 [&_input]:border-2":""}`,open:D===e,onOpenChange:a=>F(e,a),disabled:n,readOnly:n}),B&&(0,d.jsx)("div",{className:"text-xs font-medium leading-tight overflow-hidden mt-1",children:t?(0,d.jsx)("span",{className:"text-red-600",children:"This field is not nullable, enter a value"}):u?(0,d.jsx)("span",{className:"text-orange-500",children:"Has default value - will be auto-populated if unmapped"}):(0,d.jsx)("span",{className:"text-transparent",children:"Placeholder for alignment"})})]})}),(0,d.jsx)(i.nA,{className:"w-[25%]",children:(0,d.jsxs)("div",{children:[(0,d.jsxs)(p.l6,{value:b.jsonType||"",onValueChange:a=>c(e,"jsonType",a),disabled:n,children:[(0,d.jsx)(p.bq,{className:`w-full bg-[var(--color-gray-dark-900)] border-[var(--color-border-neutral)] hover:bg-[var(--color-gray-dark-950)] transition-colors text-content select-content-custom ${n?"opacity-50 cursor-not-allowed":""} ${A?"border-red-500 border-2":""}`,children:(0,d.jsx)(p.yv,{placeholder:"Select type"})}),(0,d.jsx)(p.gC,{className:"bg-[var(--color-background-neutral-faded)] border-[var(--color-border-neutral)] shadow-md text-content select-content-custom",children:q.Qu.map(a=>(0,d.jsx)(p.eb,{value:a,className:"text-content select-item-custom",children:a},a))})]}),B&&(0,d.jsx)("div",{className:"text-xs font-medium leading-tight overflow-hidden mt-1",children:A?(0,d.jsxs)("span",{className:"text-red-600",children:["Type ",b.jsonType," is incompatible with ",b.type]}):(0,d.jsx)("span",{className:"text-transparent",children:"Placeholder for alignment"})})]})}),(0,d.jsxs)(i.nA,{className:"text-content w-[5%] align-left",children:[(0,d.jsx)("div",{className:"flex justify-center items-center h-full",children:(a=>{if(m)if(a.sourceTopic===k)return(0,d.jsx)(s.default,{src:v,alt:"Primary Topic",height:20,width:20});else return a.sourceTopic===l?(0,d.jsx)(s.default,{src:w,alt:"Secondary Topic",height:20,width:20}):(console.warn(`⚠️ Column "${a.name}" missing sourceTopic in join mode. Using primary icon as fallback.`),(0,d.jsx)(s.default,{src:v,alt:"Primary Topic (Fallback)",height:20,width:20}));return(0,d.jsx)(s.default,{src:x,alt:"Topic",height:20,width:20})})(b)}),B&&(0,d.jsx)("div",{className:"text-xs font-medium leading-tight overflow-hidden mt-1",children:(0,d.jsx)("span",{className:"text-transparent",children:"Placeholder for alignment"})})]}),(0,d.jsxs)(i.nA,{className:"text-content w-[40%]",children:[(0,d.jsxs)("div",{className:"flex justify-between bg-[#212121] my-1 rounded-sm p-3",children:[(0,d.jsx)("span",{children:b.name}),(0,d.jsx)("span",{className:"text-xs text-content-secondary",children:b.type||"Unknown"})]}),B&&(0,d.jsx)("div",{className:"text-xs font-medium leading-tight overflow-hidden mt-1",children:(0,d.jsx)("span",{className:"text-transparent",children:"Placeholder for alignment"})})]})]},b.name)})})]})]})}var z=c(95101);function A({availableDatabases:a,selectedDatabase:b,setSelectedDatabase:c,isLoading:e,onRefresh:f,readOnly:g}){return(0,d.jsxs)("div",{className:"space-y-2",children:[(0,d.jsx)("div",{className:"flex items-center justify-between",children:(0,d.jsx)(z.J,{htmlFor:"database",className:"text-content transform transition-all duration-300 ease-in-out translate-y-4 opacity-0 animate-[fadeIn_0.3s_ease-in-out_forwards]",children:"Database"})}),(0,d.jsxs)("div",{className:"flex items-center justify-between",children:[a.length>0||e?(0,d.jsxs)(p.l6,{value:b,onValueChange:c,disabled:g||e,children:[(0,d.jsx)(p.bq,{id:"database",className:"w-full text-content select-content-custom transform transition-all duration-300 ease-in-out translate-y-4 opacity-0 animate-[fadeIn_0.3s_ease-in-out_forwards]",children:(0,d.jsx)(p.yv,{placeholder:e?"Loading databases...":"Select database"})}),(0,d.jsx)(p.gC,{className:"text-content bg-background-neutral-faded select-content-custom",children:a.map(a=>(0,d.jsx)(p.eb,{value:a,className:"text-content select-item-custom",children:a},a))})]}):(0,d.jsx)("div",{className:"flex gap-4 items-center transform transition-all duration-300 ease-in-out translate-y-4 opacity-0 animate-[fadeIn_0.3s_ease-in-out_forwards]",children:(0,d.jsx)(k.p,{id:"database",placeholder:"Enter database name",value:b,onChange:a=>c(a.target.value),className:"flex-1 text-content",disabled:g})}),f&&(0,d.jsx)("div",{className:"flex items-center justify-end ml-2",children:(0,d.jsx)(u.Q,{disabled:g,type:"databases",onRefresh:f,size:"sm",variant:"ghost",className:"transform transition-all duration-300 ease-in-out translate-y-4 opacity-0 animate-[fadeIn_0.3s_ease-in-out_forwards]"})})]})]})}function B({selectedDatabase:a,availableTables:b,selectedTable:c,setSelectedTable:e,isLoading:f,onOpenChange:g,open:h,onRefresh:i,readOnly:j}){return(0,d.jsxs)("div",{className:"space-y-2",children:[(0,d.jsx)("div",{className:"flex items-center justify-between",children:(0,d.jsx)(z.J,{htmlFor:"table",className:"text-content transform transition-all duration-300 ease-in-out translate-y-4 opacity-0 animate-[fadeIn_0.3s_ease-in-out_forwards]",children:"Table"})}),(0,d.jsxs)("div",{className:"flex items-center justify-between",children:[b.length>0||f?(0,d.jsxs)(p.l6,{value:c,onValueChange:e,open:h,onOpenChange:g,disabled:j||f,children:[(0,d.jsx)(p.bq,{id:"table",className:"w-full text-content select-content-custom transform transition-all duration-300 ease-in-out translate-y-4 opacity-0 animate-[fadeIn_0.3s_ease-in-out_forwards]",children:(0,d.jsx)(p.yv,{placeholder:f?"Loading tables...":"Select table"})}),(0,d.jsx)(p.gC,{className:"text-content bg-background-neutral-faded select-content-custom",children:b.map(a=>(0,d.jsx)(p.eb,{value:a,className:"text-content select-item-custom",children:a},a))})]}):(0,d.jsx)("div",{className:"flex gap-4 items-center transform transition-all duration-300 ease-in-out translate-y-4 opacity-0 animate-[fadeIn_0.3s_ease-in-out_forwards]",children:(0,d.jsx)(k.p,{id:"table",placeholder:"Enter table name",value:c,onChange:a=>e(a.target.value),className:"flex-1 text-content",disabled:j})}),i&&(0,d.jsx)("div",{className:"flex items-center justify-end ml-2",children:(0,d.jsx)(u.Q,{disabled:j,type:"tables",database:a,onRefresh:i,size:"sm",variant:"ghost",className:"transform transition-all duration-300 ease-in-out translate-y-4 opacity-0 animate-[fadeIn_0.3s_ease-in-out_forwards]"})})]})]})}function C({availableDatabases:a,selectedDatabase:b,setSelectedDatabase:c,testDatabaseAccess:e,isLoading:f,getConnectionConfig:g,availableTables:h,selectedTable:i,setSelectedTable:j,testTableAccess:k,onRefreshDatabases:l,onRefreshTables:m,readOnly:n}){return(0,d.jsxs)("div",{className:"flex flex-col lg:flex-row justify-between items-start lg:items-center gap-4 lg:gap-8 mb-8",children:[(0,d.jsx)("div",{className:"w-full lg:w-1/2",children:(0,d.jsx)(A,{availableDatabases:a,selectedDatabase:b,setSelectedDatabase:c,testDatabaseAccess:e,isLoading:f,getConnectionConfig:g,onRefresh:l,readOnly:n})}),b&&(0,d.jsx)("div",{className:"w-full lg:w-1/2",children:(0,d.jsx)(B,{selectedDatabase:b,availableTables:h,selectedTable:i,setSelectedTable:j,testTableAccess:k,isLoading:f,getConnectionConfig:g,onRefresh:m,readOnly:n})})]})}function D({value:a,onChange:b,className:c,disabled:f}){let[g,h]=(0,e.useState)(!1);return(0,d.jsxs)(p.l6,{value:a,onValueChange:b,disabled:f,children:[(0,d.jsx)(p.bq,{className:(0,n.cn)("w-full","input-regular","input-border-regular","transition-all duration-200 ease-in-out","text-content",c),onFocus:()=>h(!0),onBlur:()=>{document.querySelector('[data-state="open"]')||h(!1)},children:(0,d.jsx)(p.yv,{placeholder:"Select type",className:"text-content"})}),(0,d.jsx)(p.gC,{className:"select-content-custom animate-fadeIn text-content",children:q.ny.map(([a,b])=>(0,d.jsx)(p.eb,{value:b.value,className:"select-item-custom text-content",children:b.label},a))})]})}function E({maxBatchSize:a,maxDelayTime:b,maxDelayTimeUnit:c,onMaxBatchSizeChange:f,onMaxDelayTimeChange:g,onMaxDelayTimeUnitChange:h,readOnly:i}){let[j,l]=(0,e.useState)(a),[m,n]=(0,e.useState)(b),[o,p]=(0,e.useState)(c);return(0,d.jsxs)("div",{className:"flex gap-4 w-2/3 mb-4",children:[(0,d.jsxs)("div",{className:"flex flex-col gap-2 w-1/3",children:[(0,d.jsx)(z.J,{className:"text-sm font-medium text-muted-foreground text-content",children:"Max Batch Size (No. of events)"}),(0,d.jsx)(k.p,{type:"text",placeholder:"Max Batch Size",value:j?.toString()||"",onChange:a=>{let b=a.target.value;if(""===b)l(null);else{let a=parseInt(b);isNaN(a)||l(a)}},className:"text-sm text-content input-regular input-border-regular",disabled:i})]}),(0,d.jsxs)("div",{className:"flex flex-col gap-2 w-1/3",children:[(0,d.jsx)(z.J,{className:"text-sm font-medium text-muted-foreground text-content",children:"Max Delay Time"}),(0,d.jsx)(k.p,{type:"text",placeholder:"Max Delay Time",value:m?.toString()||"",onChange:a=>{let b=a.target.value;if(""===b)n(null);else{let a=parseInt(b);isNaN(a)||n(a)}},className:"text-sm text-content input-regular input-border-regular",disabled:i})]}),(0,d.jsxs)("div",{className:"flex flex-col gap-2 w-1/3",children:[(0,d.jsx)(z.J,{className:"text-sm font-medium text-muted-foreground text-content",children:"Max Delay Time Unit"}),(0,d.jsx)(D,{value:o,onChange:a=>{p(a)},className:"text-sm text-content input-regular input-border-regular",disabled:i})]})]})}var F=c(46298),G=c(54299),H=c(64708),I=c(9093);let J="true"===(0,n.y)().NEXT_PUBLIC_PREVIEW_MODE||"true"===process.env.NEXT_PUBLIC_PREVIEW_MODE;function K({onCompleteStep:a,standalone:b,readOnly:c,toggleEditMode:i,pipelineActionState:j,onCompleteStandaloneEditing:k}){let l=(0,f.useRouter)(),{clickhouseConnectionStore:m,clickhouseDestinationStore:n,kafkaStore:o,joinStore:p,topicsStore:s,coreStore:u,deduplicationStore:v}=(0,H.useStore)(),w=(0,t.U)(),{clickhouseConnection:x,getDatabases:z,getTables:A,getTableSchema:B,updateDatabases:D,getConnectionId:K}=m,{clickhouseDestination:L,setClickhouseDestination:M}=n,{connectionStatus:N,connectionError:O,connectionType:P}=x,{getTopic:Q}=s,{setApiConfig:R,setPipelineId:S,setOperationsSelected:T,pipelineId:U,pipelineName:V,setPipelineName:W,operationsSelected:X}=u,Y=X.operation===q.Oz.JOINING||X.operation===q.Oz.DEDUPLICATION_JOINING?"join":"single",Z="single"===Y?Q(0):null,$="single"!==Y?s.getTopic(0):null,_="single"!==Y?s.getTopic(1):null,aa=Z?.selectedEvent;Z?.events;let ab=Z?.name,[ac,ad]=(0,e.useState)(!1),[ae,af]=(0,e.useState)(!1),[ag,ah]=(0,e.useState)(!1),[ai,aj]=(0,e.useState)(!1),[ak,al]=(0,e.useState)(0),[am,an]=(0,e.useState)(L?.database||""),[ao,ap]=(0,e.useState)(L?.table||""),[aq,ar]=(0,e.useState)({columns:L?.destinationColumns||[]}),[as,at]=(0,e.useState)(L?.mapping||[]),[au,av]=(0,e.useState)(L?.maxBatchSize||1e3),[aw,ax]=(0,e.useState)(L?.maxDelayTime||1),[ay,az]=(0,e.useState)(L?.maxDelayTimeUnit||"m"),[aA,aB]=(0,e.useState)(!1),aC=(0,e.useRef)(aw),aD=(0,e.useRef)(ay),aE=(0,e.useRef)(au),[aF,aG]=(0,e.useState)(null),[aH,aI]=(0,e.useState)(null),[aJ,aK]=(0,e.useState)([]),[aL,aM]=(0,e.useState)(aa?.event||null),[aN,aO]=(0,e.useState)($?.selectedEvent?.event?.event||null),[aP,aQ]=(0,e.useState)([]),[aR,aS]=(0,e.useState)([]),[aT,aU]=(0,e.useState)({unmappedNullableColumns:[],unmappedNonNullableColumns:[],unmappedDefaultColumns:[],extraEventFields:[],incompatibleTypeMappings:[],missingTypeMappings:[]}),[aV,aW]=(0,e.useState)("none"),aX=(0,e.useMemo)(()=>"single"===Y?Z?[Z]:[]:[$,_].filter(Boolean),[Y,Z,$,_]),[aY,aZ]=(0,e.useState)({visible:!1,message:"",title:"",okButtonText:"Yes",cancelButtonText:"No",type:"info"});(0,e.useRef)(""),(0,e.useRef)(!1);let{databases:a$,isLoading:a_,error:a0,fetchDatabases:a1}=(()=>{let{clickhouseConnectionStore:a,clickhouseDestinationStore:b}=(0,H.useStore)(),{clickhouseConnection:c,clickhouseMetadata:d,updateDatabases:f,getDatabases:g,getConnectionId:h}=a,[i,j]=(0,e.useState)(!1),[k,l]=(0,e.useState)(null),m=(0,t.U)(),n=(0,e.useCallback)(async()=>{if(c.directConnection.host&&c.directConnection.httpPort){j(!0),l(null);try{let a={host:c.directConnection.host,httpPort:c.directConnection.httpPort,username:c.directConnection.username,password:c.directConnection.password,database:"",useSSL:c.directConnection.useSSL,skipCertificateVerification:c.directConnection.skipCertificateVerification,connectionType:"direct"},b=await fetch("/ui-api/clickhouse/databases",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)}),d=await b.json();if(d.success){let a=d.databases||[],b=`${c.directConnection.host}:${c.directConnection.httpPort}`;f(a,b),m.destination.databasesFetched({count:a.length})}else throw Error(d.error||"Failed to fetch databases")}catch(b){let a=b instanceof Error?b.message:"Failed to fetch databases";l(a),m.destination.databaseFetchedError({error:a})}finally{j(!1)}}},[c,f,m]);return{databases:g(),isLoading:i,error:k,fetchDatabases:n,hasData:!!d,connectionId:h()}})(),{tables:a2,isLoading:a3,error:a4,fetchTables:a5}=(a=>{let{clickhouseConnectionStore:b,clickhouseDestinationStore:c}=(0,H.useStore)(),{clickhouseConnection:d,clickhouseMetadata:f,updateTables:g,getTables:h,getConnectionId:i}=b,[j,k]=(0,e.useState)(!1),[l,m]=(0,e.useState)(null),n=(0,t.U)(),o=(0,e.useCallback)(async()=>{if(d.directConnection.host&&d.directConnection.httpPort&&a){k(!0),m(null);try{let b={host:d.directConnection.host,httpPort:d.directConnection.httpPort,username:d.directConnection.username,password:d.directConnection.password,database:a,useSSL:d.directConnection.useSSL,skipCertificateVerification:d.directConnection.skipCertificateVerification,connectionType:"direct",nativePort:d.directConnection.nativePort?Number(d.directConnection.nativePort):void 0},c=await fetch("/ui-api/clickhouse/tables",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(b)}),e=await c.json();if(e.success){let b=e.tables||[],c=`${d.directConnection.host}:${d.directConnection.httpPort}`;g(a,b,c),n.destination.tablesFetched({database:a,count:b.length})}else throw Error(e.error||"Failed to fetch tables")}catch(c){let b=c instanceof Error?c.message:"Failed to fetch tables";m(b),n.destination.tableFetchedError({database:a,error:b})}finally{k(!1)}}},[d,a,g,n]),p=h(a),q=i();return{tables:p,isLoading:j,error:l,fetchTables:o,hasData:!!f?.tables?.[a],connectionId:q}})(am),{fetchTableSchema:a6,schema:a7,isLoading:a8,error:a9}=((a,b)=>{let{clickhouseConnectionStore:c,clickhouseDestinationStore:d}=(0,H.useStore)(),{clickhouseConnection:f,clickhouseMetadata:g,updateTableSchema:h,getTableSchema:i,getConnectionId:j}=c,[k,l]=(0,e.useState)(!1),[m,n]=(0,e.useState)(null),o=(0,t.U)(),p=(0,e.useCallback)(async()=>{if(f.directConnection.host&&f.directConnection.httpPort&&a&&b){l(!0),n(null);try{let c={host:f.directConnection.host,httpPort:f.directConnection.httpPort,username:f.directConnection.username,password:f.directConnection.password,database:a,table:b,useSSL:f.directConnection.useSSL,skipCertificateVerification:f.directConnection.skipCertificateVerification,connectionType:"direct"},d=await fetch("/ui-api/clickhouse/schema",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(c)}),e=await d.json();if(e.success){let c=e.columns||[],d=`${f.directConnection.host}:${f.directConnection.httpPort}`;h(a,b,c,d),o.destination.columnsShowed({database:a,table:b,count:c.length})}else throw Error(e.error||"Failed to fetch table schema")}catch(d){let c=d instanceof Error?d.message:"Failed to fetch table schema";n(c),o.destination.tableFetchedError({database:a,table:b,error:c})}finally{l(!1)}}},[f,a,b,h,o]),q=i(a,b),r=j();return{schema:q,isLoading:k,error:m,fetchTableSchema:p,hasData:!!g?.tableSchemas?.[`${a}:${b}`],connectionId:r}})(am,ao),{testDatabaseAccess:ba,testTableAccess:bb}=(0,I.E)(),bc=async a=>{if(!a.database)return{success:!1,error:"No database specified"};let b=await ba({host:a.host,httpPort:a.httpPort,username:a.username,password:a.password,database:a.database,useSSL:a.useSSL,connectionType:a.connectionType});return{success:b.success,error:b.error}},bd=async a=>{if(!a.database||!ao)return{success:!1,error:"No database or table specified"};let b=await bb({host:a.host,httpPort:a.httpPort,username:a.username,password:a.password,database:a.database,table:ao,useSSL:a.useSSL,connectionType:a.connectionType});return{success:b.success,error:b.error}},be=(0,e.useCallback)(a=>{an(a),ap(""),ar({columns:[]}),at([]),ae&&L?.database===a||(w.destination.databaseSelected({database:a,topicName:"single"===Y?ab:`${$?.name} + ${_?.name}`,topicIndex:0,isChange:!!L?.database&&L.database!==a}),af(!0))},[ae,L,w.destination,ab,0,Y,$?.name,_?.name]),bf=(0,e.useCallback)(a=>{ao!==a&&(ap(a),ar({columns:[]}),at([]),ag&&L?.table===a||(w.destination.tableSelected({database:am,table:a,topicName:"single"===Y?ab:`${$?.name} + ${_?.name}`,topicIndex:0,isChange:!!L?.table&&L.table!==a}),ah(!0)))},[ag,L,am,w.destination,ab,0,Y,$?.name,_?.name]);(0,e.useCallback)(()=>{if("single"===Y||0===aP.length||0===aR.length||0===as.length)return!1;let a=[...as],b=!1;if(a.forEach((c,d)=>{if(c.eventField)return;let e=(0,r.dm)(c.name,aP),f="primary",g=aN;if(e||(e=(0,r.dm)(c.name,aR),f="secondary",g=_?.selectedEvent?.event),e&&g){let h="primary"===f?$?.name:_?.name;a[d]={...c,eventField:e,jsonType:(0,r.RU)((0,r.LJ)(g,e)),sourceTopic:h},b=!0,console.log(`Auto-mapped column "${c.name}" to field "${e}" from ${f} topic (${h})`)}}),b){at(a),M({...L,mapping:a});let b=a.filter(a=>a.eventField).length;console.log(`Auto-mapped ${b} fields in join mode with left topic preference`)}return b},[Y,aP,aR,as,aN,_?.selectedEvent?.event,$?.name,_?.name,L,M]);let bg=(0,e.useCallback)(()=>{let a=as.filter(a=>a.eventField).length,b=aq.columns.length;if(aT.incompatibleTypeMappings.length>0){let a=aT.incompatibleTypeMappings.map(a=>`${a.name} (${a.jsonType} → ${a.type})`).join(", ");return{type:"error",canProceed:!1,title:"Error: Type Incompatibility",message:`Some event fields are mapped to incompatible ClickHouse column types. Please review and fix these mappings:
        ${a}`,okButtonText:"OK",cancelButtonText:"Cancel"}}if(aT.missingTypeMappings.length>0){let a=aT.missingTypeMappings.map(a=>`${a.name} (mapped to ${a.eventField})`).join(", ");return{type:"error",canProceed:!1,title:"Error: Missing Type Information",message:`Some mapped fields have no type information. This might happen when the field path exists but the value is undefined or null. Please review these mappings:
        ${a}`,okButtonText:"OK",cancelButtonText:"Cancel"}}if(aT.unmappedNonNullableColumns.length>0)return{type:"error",canProceed:!1,title:"Error: Null Constraint Violation",message:`Target table has NOT NULL constraints. Either modify table to allow nulls, provide values for all required fields, or set database defaults.
        Required columns: ${aT.unmappedNonNullableColumns.join(", ")}`,okButtonText:"OK",cancelButtonText:"Cancel"};if(aT.unmappedDefaultColumns.length>0)return{type:"warning",canProceed:!0,title:"Default Values Will Be Used",message:`The following columns have DEFAULT expressions and are not mapped. They will be automatically populated by ClickHouse during insert:
        ${aT.unmappedDefaultColumns.join(", ")}
        
        Do you want to continue?`,okButtonText:"Continue",cancelButtonText:"Cancel"};if(a<b&&aT.unmappedNullableColumns.length>0)return{type:"warning",canProceed:!0,title:"Field Count Mismatch",message:`Are you sure you want to deploy this pipeline while event field count (${a}) is less than table columns (${b})? Some columns may not receive data.
        The following columns will be set to NULL: ${aT.unmappedNullableColumns.join(", ")}`,okButtonText:"Continue",cancelButtonText:"Cancel"};else if(aT.extraEventFields.length>0)return{type:"warning",canProceed:!0,title:"Extra Fields Detected",message:`Some incoming event fields will not be mapped to table columns. Unmapped fields will be dropped during processing. Do you want to continue with deployment?
        Unmapped fields: ${aT.extraEventFields.join(", ")}`,okButtonText:"Continue",cancelButtonText:"Cancel"};return null},[aT,as,aq.columns]),bh=(0,e.useCallback)(()=>{aW("save"),w.destination.columnsSelected({count:as.length});let a=bg();a?aZ({visible:!0,title:a.title,message:a.message,okButtonText:a.okButtonText,cancelButtonText:a.cancelButtonText,type:a.type}):bj()},[bg]),bi=(0,e.useCallback)(()=>{u.discardSection("clickhouse-destination")},[u]),bj=(0,e.useCallback)(()=>{let{invalidMappings:c,missingTypeMappings:d}=(0,r.Yi)(as);if(c.length>0){let a=c.map(a=>`${a.name} (${a.jsonType} → ${a.type})`).join(", ");aG(`Type compatibility issues remain: ${a}. Please fix these before continuing.`);return}if(d.length>0){let a=d.map(a=>`${a.name} (mapped to ${a.eventField})`).join(", ");aG(`Some mapped fields are missing type information: ${a}. Please review these mappings.`);return}let e=aq.columns.length,f=Math.round(as.filter(a=>a.eventField).length/e*100);w.destination.mappingCompleted({count:as.length,totalColumns:e,mappingPercentage:f,batchSize:au,delayTime:aw,delayUnit:ay});let g=aC.current,h=aD.current,j=aE.current,l={...L,database:am,table:ao,mapping:as,destinationColumns:aq.columns,maxBatchSize:j,maxDelayTime:g,maxDelayTimeUnit:h},m=(0,r.generateApiConfig)({pipelineId:U,pipelineName:V,setPipelineId:S,clickhouseConnection:x,clickhouseDestination:l,selectedTopics:aX,getMappingType:r.xR,joinStore:p,kafkaStore:o,deduplicationStore:v});if(M(l),R(m),aI("Destination configuration saved successfully!"),setTimeout(()=>aI(null),3e3),b&&i){u.markAsDirty(),console.log("[ClickhouseMapper] Configuration marked as dirty - changes will be saved on Resume"),k&&k();return}J?a(q.Fn.CLICKHOUSE_MAPPER):bk(m)},[L,am,ao,as,aq.columns,au,aw,ay,U,S,x,aX,p,o,M,R,l,w.destination,Y,$?.name,_?.name,b,i,u,k,v,V,a]),bk=(0,e.useCallback)(async a=>{try{await (0,G.pZ)(a);let b=a?.pipeline_id||"";S(b),l.push(`/pipelines/${b}?deployment=progress`)}catch(a){console.error("deployPipelineAndNavigate: Failed to deploy pipeline:",a),aG(`Failed to deploy pipeline: ${a.message}`)}},[S,l]),bl=a_||a3||a8,bm=aF||a0||a4||a9,bn=async()=>{await a1(),am&&!a$.includes(am)&&(an(""),ap(""),ar({columns:[]}),at([]))},bo=async()=>{await a5(),ao&&!a2.includes(ao)&&(ap(""),ar({columns:[]}),at([]))},bp=async()=>{await a6()};return(0,d.jsxs)("div",{className:"flex flex-col gap-8 mb-4",children:[(0,d.jsxs)("div",{className:"space-y-6",children:[(0,d.jsx)(C,{availableDatabases:a$,selectedDatabase:am,setSelectedDatabase:be,testDatabaseAccess:bc,isLoading:bl,getConnectionConfig:()=>({...x.directConnection,connectionType:"direct"}),availableTables:a2,selectedTable:ao,setSelectedTable:bf,testTableAccess:bd,onRefreshDatabases:bn,onRefreshTables:bo,readOnly:c}),ao&&(aq.columns.length>0||a7?.length>0)&&!a8&&(0,d.jsxs)("div",{className:"transform transition-all duration-300 ease-in-out translate-y-4 opacity-0 animate-[fadeIn_0.3s_ease-in-out_forwards]",children:[(0,d.jsx)(E,{maxBatchSize:au,maxDelayTime:aw,maxDelayTimeUnit:ay,onMaxBatchSizeChange:av,onMaxDelayTimeChange:ax,onMaxDelayTimeUnitChange:az,readOnly:c}),(0,d.jsx)(y,{eventFields:"single"===Y?aJ:[...aP,...aR],mappedColumns:as,updateColumnMapping:(a,b,c)=>{let d=[...as];d[a]={...d[a],[b]:c},at(d),M({...L,mapping:d})},mapEventFieldToColumn:(a,b,c)=>{let d,e=[...as];if("single"===Y)d=b?(0,r.LJ)(aL,b):void 0;else{let a="secondary"===c?_?.selectedEvent?.event?.event:$?.selectedEvent?.event?.event;d=a?(0,r.LJ)(a,b):void 0}let f=b?(0,r.RU)(d):e[a].jsonType;!f&&b&&(f="string");let g="single"!==Y&&c?"secondary"===c?_?.name:$?.name:void 0;e[a]={...e[a],eventField:b,jsonType:f,...g&&{sourceTopic:g}},(0,r.ry)(f,e[a].type||"string"),at(e)},primaryEventFields:"single"!==Y?aP:void 0,secondaryEventFields:"single"!==Y?aR:void 0,primaryTopicName:"single"!==Y?$?.name:void 0,secondaryTopicName:"single"!==Y?_?.name:void 0,isJoinMapping:"single"!==Y,readOnly:c,unmappedNonNullableColumns:aT.unmappedNonNullableColumns,unmappedDefaultColumns:aT.unmappedDefaultColumns,onRefreshTableSchema:bp,selectedDatabase:am,selectedTable:ao}),(0,d.jsx)("div",{className:"flex gap-2 mt-4",children:(0,d.jsx)(F.A,{standalone:b,onSubmit:bh,onDiscard:bi,isLoading:bl,isSuccess:!!aH,disabled:bl,successText:"Continue",actionType:"primary",showLoadingIcon:!1,regularText:"Continue",loadingText:"Saving...",readOnly:c,toggleEditMode:i,pipelineActionState:j,onClose:k})})]}),bm&&(0,d.jsxs)("div",{className:"p-3 bg-background-neutral-faded text-red-700 rounded-md flex items-center border border-[var(--color-border-neutral)]",children:[(0,d.jsx)(g.A,{className:"h-5 w-5 mr-2"}),(0,d.jsx)("span",{children:bm})]})]}),(0,d.jsx)(h.W,{visible:aY.visible,title:aY.title,description:aY.message,okButtonText:aY.okButtonText,cancelButtonText:aY.cancelButtonText,onComplete:a=>{aZ(a=>({...a,visible:!1})),a===h.R.YES&&("error"===aY.type?aG("Please fix the validation errors before proceeding."):bj()),aW("none")},pendingOperation:aV})]})}},94480:(a,b,c)=>{c(48477),c(48296)},95101:(a,b,c)=>{c.d(b,{J:()=>g});var d=c(48477);c(48296);var e=c(53745),f=c(84621);function g({className:a,...b}){return(0,d.jsx)(e.b,{"data-slot":"label",className:(0,f.cn)("flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",a),...b})}},98489:(a,b,c)=>{c.d(b,{E:()=>g});var d=c(48477),e=c(48296);let f=(0,c(27470).default)(async()=>{},{loadableGenerated:{modules:["components/shared/EventEditor.tsx -> ace-builds/src-noconflict/theme-merbivore"]},ssr:!1}),g=({event:a,topic:b,isLoadingEvent:c,eventError:g,isEmptyTopic:h=!1,onManualEventChange:i,isEditingEnabled:j,readOnly:k})=>{let[l,m]=(0,e.useState)(a),[n,o]=(0,e.useState)(!0),[p,q]=(0,e.useState)("");(0,e.useEffect)(()=>{m(a)},[a]);let r=!(h||j)||k;return(0,d.jsx)("div",{className:"rounded-md p-4 h-full flex flex-col overflow-auto",children:b&&(!c||h)?(0,d.jsxs)(d.Fragment,{children:[h&&(0,d.jsx)("div",{className:"bg-amber-500/20 p-3 mb-3 rounded-md text-amber-500 text-sm",children:"This topic has no events. Please select a different topic with events or enter event schema manually to proceed."}),(0,d.jsx)("div",{className:"flex-grow relative w-full h-full code-editor-container",children:c?(0,d.jsx)("div",{className:"absolute inset-0 flex items-center justify-center bg-black-500 bg-opacity-50",children:(0,d.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-white"})}):(0,d.jsx)(d.Fragment,{children:(0,d.jsx)(f,{mode:"json",theme:"merbivore",name:"event-editor",value:l,onChange:a=>{m(a);try{JSON.parse(a),o(!0),q("")}catch(a){o(!1),q("Invalid JSON format")}i&&i(a)},readOnly:r,width:"100%",height:"100%",minLines:10,maxLines:1/0,fontSize:14,showPrintMargin:!1,showGutter:!0,highlightActiveLine:!0,setOptions:{useWorker:!1,showPrintMargin:!1,showGutter:!0,highlightActiveLine:!1,wrap:!1,verticalScrollbarAlwaysVisible:!0,horizontalScrollbarAlwaysVisible:!0,fontSize:14,tabSize:2,showLineNumbers:!0},editorProps:{$blockScrolling:!0}})})}),!n&&(0,d.jsx)("div",{className:"bg-red-500/20 p-3 mb-3 mt-3 rounded-md text-red-500 text-sm",children:p}),g&&!h&&(0,d.jsx)("div",{className:`mt-2 text-sm ${g.includes("Note:")?"text-amber-500":"text-red-500"}`,children:g})]}):(0,d.jsx)("div",{className:"h-full flex items-center justify-center bg-background-neutral rounded-md",children:(0,d.jsx)("p",{className:"text-white"})})})}}};