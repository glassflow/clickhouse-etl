"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6460],{1475:(e,t,i)=>{i.d(t,{B0:()=>s,Cz:()=>n,JP:()=>d,WQ:()=>m,Xs:()=>l,ej:()=>k,gP:()=>u,j_:()=>f,lY:()=>S,pI:()=>r,pZ:()=>c,sw:()=>p});var a=i(3113),o=i(4345);let n=async()=>{try{let e=(0,a.e9)("pipeline"),t=await fetch(e),i=await t.json();if(i.success){let e=(i.pipelines||[]).map(e=>({...e,status:(0,o.U)(e.status||"")})),t=e.map(e=>e.pipeline_id),a=await h(t);return await Promise.all(e.map(async e=>{try{let t=await s(e.pipeline_id),i=(0,o.t)(t),n=a[e.pipeline_id],r=n&&n.unconsumed_messages>0?"unstable":"stable";return{...e,transformation_type:i,dlq_stats:n?{total_messages:n.total_messages,unconsumed_messages:n.unconsumed_messages,last_received_at:n.last_received_at,last_consumed_at:n.last_consumed_at}:void 0,health_status:r}}catch(t){return{...e,dlq_stats:void 0,health_status:"stable"}}}))}throw{code:t.status,message:i.error||"Failed to fetch pipelines"}}catch(e){if(e.code)throw e;throw{code:500,message:e.message||"Failed to fetch pipelines"}}},s=async e=>{try{let t=(0,a.e9)("pipeline/".concat(e)),i=(0,a.e9)("pipeline/".concat(e,"/health")),[n,s]=await Promise.all([fetch(t),fetch(i)]);if(n.ok){let e=await n.json();if((null==e?void 0:e.success)===!0){let t=e.pipeline,i="active";if(s.ok)try{let e=await s.json();(null==e?void 0:e.overall_status)&&(i=(0,o.U)(e.overall_status))}catch(e){console.warn("Failed to parse health data:",e)}return t.status=i,t}if(e&&"object"==typeof e&&e.pipeline_id){let t="active";if(s.ok)try{let e=await s.json();(null==e?void 0:e.overall_status)&&(t=(0,o.U)(e.overall_status))}catch(e){console.warn("Failed to parse health data:",e)}return e.status=t,e}throw{code:n.status,message:(null==e?void 0:e.error)||"Failed to fetch pipeline"}}throw{code:n.status,message:"Failed to fetch pipeline"}}catch(i){try{let[i,a]=await Promise.all([fetch("/ui-api/mock/pipeline/".concat(e)),fetch("/ui-api/mock/pipeline/".concat(e,"/health"))]),n=await i.json();if(i.ok&&(null==n?void 0:n.success)===!0){let e=n.pipeline,i="active";if(a.ok)try{var t;let e=await a.json();(null==e||null==(t=e.health)?void 0:t.overall_status)&&(i=(0,o.U)(e.health.overall_status))}catch(e){console.warn("Failed to parse mock health data:",e)}return e.status=i,e}throw{code:i.status,message:(null==n?void 0:n.error)||"Failed to fetch pipeline (mock)"}}catch(e){if(i.code)throw i;throw{code:500,message:i.message||"Failed to fetch pipeline"}}}},r=async e=>{try{let t=(0,a.e9)("pipeline/".concat(e)),i=await fetch(t,{method:"GET",headers:{"Content-Type":"application/json"}});return 200===i.status}catch(e){return e.status,!1}},c=async e=>{try{let t=(0,a.e9)("pipeline"),i=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),o=await i.json();if(o.success)return o.pipeline;throw{code:i.status,message:o.error||"Failed to create pipeline"}}catch(e){if(e.code)throw e;throw{code:500,message:e.message||"Failed to create pipeline"}}},l=async(e,t)=>{try{let i=(0,a.e9)("pipeline/".concat(e,"/edit")),o=await fetch(i,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}),n=await o.json();if(n.success)return n.pipeline;{let e=n.error||"Failed to edit pipeline";if(400===o.status&&e.includes("Pipeline must be stopped"))throw{code:400,message:"Pipeline must be stopped before editing. Please pause the pipeline first.",requiresPause:!0};throw{code:o.status,message:e}}}catch(e){if(e.code)throw e;throw{code:500,message:e.message||"Failed to edit pipeline"}}},d=async e=>{try{let t=(0,a.e9)("pipeline/".concat(e,"/stop")),i=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json"}});if(!i.ok){let e=await i.text();throw{code:i.status,message:e||"Failed to stop pipeline"}}}catch(e){if(e.code)throw e;throw{code:500,message:e.message||"Failed to stop pipeline"}}},p=async e=>{try{let t=(0,a.e9)("pipeline/".concat(e,"/terminate")),i=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json"}});if(!i.ok){let e=await i.text();throw{code:i.status,message:e||"Failed to terminate pipeline"}}}catch(e){if(e.code)throw e;throw{code:500,message:e.message||"Failed to terminate pipeline"}}},u=async e=>{try{let t=(0,a.e9)("pipeline/".concat(e)),i=await fetch(t,{method:"DELETE",headers:{"Content-Type":"application/json"}});if(!i.ok){let e=await i.text();throw{code:i.status,message:e||"Failed to delete pipeline"}}}catch(e){if(e.code)throw e;throw{code:500,message:e.message||"Failed to delete pipeline"}}},m=async e=>{try{let t=(0,a.e9)("pipeline/".concat(e,"/resume")),i=await fetch(t,{method:"POST"}),o=await i.json();if(!i.ok||!o.success)throw{code:i.status,message:o.error||"Failed to resume pipeline"};return}catch(e){if(e.code)throw e;throw{code:500,message:e.message||"Failed to resume pipeline"}}},S=async(e,t)=>{try{let i=(0,a.e9)("pipeline/".concat(e)),o=await fetch(i,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:t})}),n=await o.json();if(n.success)return n.pipeline;throw{code:o.status,message:n.error||"Failed to rename pipeline"}}catch(e){if(e.code)throw e;throw{code:500,message:e.message||"Failed to rename pipeline"}}},f=async e=>{try{let t=(0,a.e9)("pipeline/".concat(e,"/dlq/state")),i=await fetch(t);if(!i.ok)throw{code:i.status,message:"Failed to fetch DLQ state"};return await i.json()}catch(e){if(e.code)throw e;throw{code:500,message:e.message||"Failed to fetch DLQ state"}}},h=async e=>{try{let t=e.map(async e=>{try{let t=await f(e);return{pipelineId:e,dlqState:t}}catch(t){return console.warn("Failed to fetch DLQ stats for pipeline ".concat(e,":"),t),{pipelineId:e,dlqState:null}}}),i=await Promise.all(t),a={};return i.forEach(e=>{let{pipelineId:t,dlqState:i}=e;a[t]=i}),a}catch(e){return console.error("Failed to fetch bulk DLQ stats:",e),{}}},k=async e=>{try{let t=(0,a.e9)("pipeline/".concat(e.pipeline_id,"/clickhouse/metrics-from-config")),i=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({pipeline:e})});if(!i.ok)throw{code:i.status,message:"Failed to fetch ClickHouse metrics"};let o=await i.json();if(!o.success)throw{code:500,message:o.error||"Failed to fetch ClickHouse metrics"};return o.metrics}catch(e){if(e.code)throw e;throw{code:500,message:e.message||"Failed to fetch ClickHouse metrics"}}}},3621:(e,t,i)=>{i.d(t,{Cf:()=>d,Es:()=>u,L3:()=>m,LC:()=>l,c7:()=>p,lG:()=>r,rr:()=>S});var a=i(1929);i(2477);var o=i(817),n=i(6107),s=i(8387);function r(e){let{...t}=e;return(0,a.jsx)(o.bL,{"data-slot":"dialog",...t})}function c(e){let{...t}=e;return(0,a.jsx)(o.ZL,{"data-slot":"dialog-portal",...t})}function l(e){let{className:t,...i}=e;return(0,a.jsx)(o.hJ,{"data-slot":"dialog-overlay",className:(0,s.cn)("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",t),...i})}function d(e){let{className:t,children:i,...r}=e;return(0,a.jsxs)(c,{"data-slot":"dialog-portal",children:[(0,a.jsx)(l,{}),(0,a.jsxs)(o.UC,{"data-slot":"dialog-content",className:(0,s.cn)("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg",t),...r,children:[i,(0,a.jsxs)(o.bm,{className:"ring-offset-background focus:ring-ring data-[state=open]:bg-accent data-[state=open]:text-muted-foreground absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",children:[(0,a.jsx)(n.A,{}),(0,a.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})}function p(e){let{className:t,...i}=e;return(0,a.jsx)("div",{"data-slot":"dialog-header",className:(0,s.cn)("flex flex-col gap-2 text-center sm:text-left",t),...i})}function u(e){let{className:t,...i}=e;return(0,a.jsx)("div",{"data-slot":"dialog-footer",className:(0,s.cn)("flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",t),...i})}function m(e){let{className:t,...i}=e;return(0,a.jsx)(o.hE,{"data-slot":"dialog-title",className:(0,s.cn)("text-lg leading-none font-semibold",t),...i})}function S(e){let{className:t,...i}=e;return(0,a.jsx)(o.VY,{"data-slot":"dialog-description",className:(0,s.cn)("text-muted-foreground text-sm",t),...i})}},4345:(e,t,i)=>{i.d(t,{U:()=>a,t:()=>o});let a=e=>{if(!e||""===e.trim())return"active";switch(e.charAt(0).toLowerCase()+e.slice(1)){case"running":case"active":case"deploying":case"no_configuration":default:return"active";case"paused":return"paused";case"pausing":return"pausing";case"resuming":return"resuming";case"stopped":case"terminated":case"deleted":return"stopped";case"stopping":return"stopping";case"terminating":case"deleting":return"terminating";case"failed":case"error":case"deploy_failed":case"delete_failed":return"failed"}},o=e=>{var t,i,a;let o=!!((null==e||null==(t=e.join)?void 0:t.enabled)===!0&&Array.isArray(null==e||null==(i=e.join)?void 0:i.sources)&&e.join.sources.length>0),n=Array.isArray(null==e||null==(a=e.source)?void 0:a.topics)?e.source.topics:[],s=n.filter(e=>{let t=null==e?void 0:e.deduplication,i=(null==t?void 0:t.enabled)===!0||(null==t?void 0:t.enabled)==="true",a="string"==typeof(null==t?void 0:t.id_field)?t.id_field.trim():"";return i&&a.length>0}).length,r=n.length>1&&s>=2;return o&&r?"Join & Deduplication":o?"Join":s>0?"Deduplication":"Ingest Only"}},4648:(e,t,i)=>{i.d(t,{z:()=>a});let a={Consent_Given:{name:"Consent Given",key:"Consent_Given"},Consent_NotGiven:{name:"Consent Not Given",key:"Consent_NotGiven"},Feedback_Submitted:{name:"Feedback Submitted",key:"Feedback_Submitted"},P0_Homepage:{name:"P0 Homepage",key:"P0_Homepage"},P1_SetupKafkaConnection:{name:"P1 Setup Kafka Connection",key:"P1_SetupKafkaConnection"},P2_SelectTopic:{name:"P2 Select Topic",key:"P2_SelectTopic"},P2_SelectLeftTopic:{name:"P2 Select Left Topic",key:"P2_SelectLeftTopic"},P2_1_SelectRightTopic:{name:"P2.1 Select Right Topic",key:"P2_1_SelectRightTopic"},P3_DeduplicationKey:{name:"P3 Deduplication Key",key:"P3_DeduplicationKey"},P3_JoinKey:{name:"P3 Join Key",key:"P3_JoinKey"},P3_TopicDeduplication:{name:"P3 Topic Deduplication",key:"P3_TopicDeduplication"},P4_SetupClickhouseConnection:{name:"P4 Setup Clickhouse Connection",key:"P4_SetupClickhouseConnection"},P5_SelectDestination:{name:"P5 Select Destination",key:"P5_SelectDestination"},P6_Pipelines:{name:"P6 Pipelines",key:"P6_Pipelines"},Deduplication_Clicked:{name:"Deduplication Clicked",key:"Deduplication_Clicked"},Join_Clicked:{name:"Join Clicked",key:"Join_Clicked"},DedupAndJoin_Clicked:{name:"Dedup And Join Clicked",key:"DedupAndJoin_Clicked"},IngestOnly_Clicked:{name:"Ingest Only Clicked",key:"IngestOnly_Clicked"},KafkaConnection_Started:{name:"Kafka Connection Started",key:"KafkaConnection_Started"},KafkaConnection_Failed:{name:"Kafka Connection Failed",key:"KafkaConnection_Failed"},KafkaConnection_Success:{name:"Kafka Connection Success",key:"KafkaConnection_Success"},TopicSelected:{name:"Topic Selected",key:"TopicSelected"},TopicSelected_EventReceived:{name:"Topic Selected Event Received",key:"TopicSelected_EventReceived"},TopicSelected_NoEvent:{name:"Topic Selected No Event",key:"TopicSelected_NoEvent"},TopicSelected_EventError:{name:"Topic Selected Event Error",key:"TopicSelected_EventError"},DedupKeySelected:{name:"Dedup Key Selected",key:"DedupKeySelected"},LeftJoinKeySelected:{name:"Left Join Key Selected",key:"LeftJoinKeySelected"},RightJoinKeySelected:{name:"Right Join Key Selected",key:"RightJoinKeySelected"},JoinConfiguration_Started:{name:"Join Configuration Started",key:"JoinConfiguration_Started"},JoinConfiguration_FieldChanged:{name:"Join Configuration Field Changed",key:"JoinConfiguration_FieldChanged"},JoinConfiguration_StreamConfigured:{name:"Join Configuration Stream Configured",key:"JoinConfiguration_StreamConfigured"},JoinConfiguration_Completed:{name:"Join Configuration Completed",key:"JoinConfiguration_Completed"},JoinConfiguration_ValidationFailed:{name:"Join Configuration Validation Failed",key:"JoinConfiguration_ValidationFailed"},ClickhouseConnection_Started:{name:"Clickhouse Connection Started",key:"ClickhouseConnection_Started"},ClickhouseConnection_Failed:{name:"Clickhouse Connection Failed",key:"ClickhouseConnection_Failed"},ClickhouseConnection_Success:{name:"Clickhouse Connection Success",key:"ClickhouseConnection_Success"},Destination_DatabaseSelected:{name:"Destination Database Selected",key:"Destination_DatabaseSelected"},Destination_TableSelected:{name:"Destination Table Selected",key:"Destination_TableSelected"},Destination_ColumnsShowed:{name:"Destination Columns Showed",key:"Destination_ColumnsShowed"},Destination_ColumnsSelected:{name:"Destination Columns Selected",key:"Destination_ColumnsSelected"},Destination_DatabaseFetched:{name:"Destination Database Fetched",key:"Destination_DatabaseFetched"},Destination_TableFetched:{name:"Destination Table Fetched",key:"Destination_TableFetched"},Destination_MappingCompleted:{name:"Destination Mapping Completed",key:"Destination_MappingCompleted"},Destination_DatabaseFetchedError:{name:"Destination Database Fetched Error",key:"Destination_DatabaseFetchedError"},Destination_TableFetchedError:{name:"Destination Table Fetched Error",key:"Destination_TableFetchedError"},Deploy_Clicked:{name:"Deploy Clicked",key:"Deploy_Clicked"},Deploy_Failed:{name:"Deploy Failed",key:"Deploy_Failed"},Deploy_Success:{name:"Deploy Success",key:"Deploy_Success"},PipelinePause_Clicked:{name:"Pipeline Pause Clicked",key:"PipelinePause_Clicked"},PipelinePause_Failed:{name:"Pipeline Pause Failed",key:"PipelinePause_Failed"},PipelinePause_Success:{name:"Pipeline Pause Success",key:"PipelinePause_Success"},PipelineResume_Clicked:{name:"Pipeline Resume Clicked",key:"PipelineResume_Clicked"},PipelineResume_Failed:{name:"Pipeline Resume Failed",key:"PipelineResume_Failed"},PipelineResume_Success:{name:"Pipeline Resume Success",key:"PipelineResume_Success"},PipelineRename_Clicked:{name:"Pipeline Rename Clicked",key:"PipelineRename_Clicked"},PipelineRename_Failed:{name:"Pipeline Rename Failed",key:"PipelineRename_Failed"},PipelineRename_Success:{name:"Pipeline Rename Success",key:"PipelineRename_Success"},PipelineEdit_Clicked:{name:"Pipeline Edit Clicked",key:"PipelineEdit_Clicked"},PipelineEdit_Failed:{name:"Pipeline Edit Failed",key:"PipelineEdit_Failed"},PipelineEdit_Success:{name:"Pipeline Edit Success",key:"PipelineEdit_Success"},PipelineDelete_Clicked:{name:"Pipeline Delete Clicked",key:"PipelineDelete_Clicked"},PipelineDelete_Failed:{name:"Pipeline Delete Failed",key:"PipelineDelete_Failed"},PipelineDelete_Success:{name:"Pipeline Delete Success",key:"PipelineDelete_Success"},PipelineModify_Clicked:{name:"Pipeline Modify Clicked",key:"PipelineModify_Clicked"},PipelineModify_Failed:{name:"Pipeline Modify Failed",key:"PipelineModify_Failed"},PipelineModify_Success:{name:"Pipeline Modify Success",key:"PipelineModify_Success"},Pipeline_ExistingPipeline:{name:"Pipeline Existing Pipeline",key:"Pipeline_ExistingPipeline"},Pipeline_ExistingSamePipeline:{name:"Pipeline Existing Same Pipeline",key:"Pipeline_ExistingSamePipeline"},Mode_CreateEntered:{name:"Create Mode Entered",key:"Mode_CreateEntered"},Mode_EditEntered:{name:"Edit Mode Entered",key:"Mode_EditEntered"},Mode_ViewEntered:{name:"View Mode Entered",key:"Mode_ViewEntered"}}},5170:(e,t,i)=>{i.d(t,{gt:()=>m,D4:()=>f,cR:()=>S,Al:()=>s,sB:()=>u,sc:()=>l,Nh:()=>p,dx:()=>k,DB:()=>c,Dm:()=>r,$Q:()=>h,fU:()=>d});var a=i(5449),o=i(4648);let n=(e,t)=>{let i=o.z[e];if(!i)return void console.warn("Event with key ".concat(e," not found in dictionary"));(0,a.u4)({event:i,context:i.name,properties:t})},s={consentGiven:e=>n("Consent_Given",e),consentNotGiven:e=>n("Consent_NotGiven",e),feedbackSubmitted:e=>n("Feedback_Submitted",e)},r={homepage:e=>n("P0_Homepage",e),setupKafkaConnection:e=>n("P1_SetupKafkaConnection",e),selectTopic:e=>n("P2_SelectTopic",e),selectLeftTopic:e=>n("P2_SelectLeftTopic",e),selectRightTopic:e=>n("P2_1_SelectRightTopic",e),deduplicationKey:e=>n("P3_DeduplicationKey",e),topicDeduplication:e=>n("P3_TopicDeduplication",e),joinKey:e=>n("P3_JoinKey",e),setupClickhouseConnection:e=>n("P4_SetupClickhouseConnection",e),selectDestination:e=>n("P5_SelectDestination",e),pipelines:e=>n("P6_Pipelines",e)},c={deduplication:e=>n("Deduplication_Clicked",e),join:e=>n("Join_Clicked",e),dedupAndJoin:e=>n("DedupAndJoin_Clicked",e),ingestOnly:e=>n("IngestOnly_Clicked",e)},l={started:e=>n("KafkaConnection_Started",e),failed:e=>n("KafkaConnection_Failed",e),success:e=>n("KafkaConnection_Success",e)},d={selected:e=>n("TopicSelected",e),eventReceived:e=>n("TopicSelected_EventReceived",e),noEvent:e=>n("TopicSelected_NoEvent",e),eventError:e=>n("TopicSelected_EventError",e)},p={dedupKey:e=>n("DedupKeySelected",e),leftJoinKey:e=>n("LeftJoinKeySelected",e),rightJoinKey:e=>n("RightJoinKeySelected",e)},u={configurationStarted:e=>n("JoinConfiguration_Started",e),fieldChanged:e=>n("JoinConfiguration_FieldChanged",e),streamConfigured:e=>n("JoinConfiguration_StreamConfigured",e),configurationCompleted:e=>n("JoinConfiguration_Completed",e),validationFailed:e=>n("JoinConfiguration_ValidationFailed",e)},m={started:e=>n("ClickhouseConnection_Started",e),failed:e=>n("ClickhouseConnection_Failed",e),success:e=>n("ClickhouseConnection_Success",e)},S={databaseSelected:e=>n("Destination_DatabaseSelected",e),tableSelected:e=>n("Destination_TableSelected",e),columnsShowed:e=>n("Destination_ColumnsShowed",e),columnsSelected:e=>n("Destination_ColumnsSelected",e),databasesFetched:e=>n("Destination_DatabasesFetched",e),tablesFetched:e=>n("Destination_TablesFetched",e),mappingCompleted:e=>n("Destination_MappingCompleted",e),databaseFetchedError:e=>n("Destination_DatabaseFetchedError",e),tableFetchedError:e=>n("Destination_TableFetchedError",e)},f={clicked:e=>n("Deploy_Clicked",e),failed:e=>n("Deploy_Failed",e),success:e=>n("Deploy_Success",e)},h={pauseClicked:e=>n("PipelinePause_Clicked",e),pauseFailed:e=>n("PipelinePause_Failed",e),pauseSuccess:e=>n("PipelinePause_Success",e),resumeClicked:e=>n("PipelineResume_Clicked",e),resumeFailed:e=>n("PipelineResume_Failed",e),resumeSuccess:e=>n("PipelineResume_Success",e),renameClicked:e=>n("PipelineRename_Clicked",e),renameFailed:e=>n("PipelineRename_Failed",e),renameSuccess:e=>n("PipelineRename_Success",e),editClicked:e=>n("PipelineEdit_Clicked",e),editFailed:e=>n("PipelineEdit_Failed",e),editSuccess:e=>n("PipelineEdit_Success",e),deleteClicked:e=>n("PipelineDelete_Clicked",e),deleteFailed:e=>n("PipelineDelete_Failed",e),deleteSuccess:e=>n("PipelineDelete_Success",e),modifyClicked:e=>n("PipelineModify_Clicked",e),modifyFailed:e=>n("PipelineModify_Failed",e),modifySuccess:e=>n("PipelineModify_Success",e),existingPipeline:e=>n("Pipeline_ExistingPipeline",e),existingSamePipeline:e=>n("Pipeline_ExistingSamePipeline",e)},k={createEntered:e=>n("Mode_CreateEntered",e),editEntered:e=>n("Mode_EditEntered",e),viewEntered:e=>n("Mode_ViewEntered",e)}},5449:(e,t,i)=>{i.d(t,{Bu:()=>p,sw:()=>u,u4:()=>m});var a=i(4648);let o={[a.z.Consent_Given.name]:!0,[a.z.Consent_NotGiven.name]:!0,[a.z.Feedback_Submitted.name]:!0,[a.z.P0_Homepage.name]:!0,[a.z.P1_SetupKafkaConnection.name]:!0,[a.z.P2_SelectTopic.name]:!0,[a.z.P2_SelectLeftTopic.name]:!0,[a.z.P2_1_SelectRightTopic.name]:!0,[a.z.P3_DeduplicationKey.name]:!0,[a.z.P3_JoinKey.name]:!0,[a.z.P3_TopicDeduplication.name]:!0,[a.z.P4_SetupClickhouseConnection.name]:!0,[a.z.P5_SelectDestination.name]:!0,[a.z.P6_Pipelines.name]:!0,[a.z.Deduplication_Clicked.name]:!0,[a.z.Join_Clicked.name]:!0,[a.z.DedupAndJoin_Clicked.name]:!0,[a.z.IngestOnly_Clicked.name]:!0,[a.z.KafkaConnection_Started.name]:!0,[a.z.KafkaConnection_Failed.name]:!0,[a.z.KafkaConnection_Success.name]:!0,[a.z.TopicSelected.name]:!0,[a.z.TopicSelected_EventReceived.name]:!0,[a.z.TopicSelected_NoEvent.name]:!0,[a.z.TopicSelected_EventError.name]:!0,[a.z.DedupKeySelected.name]:!0,[a.z.LeftJoinKeySelected.name]:!0,[a.z.RightJoinKeySelected.name]:!0,[a.z.JoinConfiguration_Started.name]:!0,[a.z.JoinConfiguration_FieldChanged.name]:!0,[a.z.JoinConfiguration_StreamConfigured.name]:!0,[a.z.JoinConfiguration_Completed.name]:!0,[a.z.JoinConfiguration_ValidationFailed.name]:!0,[a.z.ClickhouseConnection_Started.name]:!0,[a.z.ClickhouseConnection_Failed.name]:!0,[a.z.ClickhouseConnection_Success.name]:!0,[a.z.Destination_DatabaseSelected.name]:!0,[a.z.Destination_TableSelected.name]:!0,[a.z.Destination_ColumnsShowed.name]:!0,[a.z.Destination_ColumnsSelected.name]:!0,[a.z.Destination_DatabaseFetched.name]:!0,[a.z.Destination_TableFetched.name]:!0,[a.z.Destination_MappingCompleted.name]:!0,[a.z.Destination_DatabaseFetchedError.name]:!0,[a.z.Destination_TableFetchedError.name]:!0,[a.z.Deploy_Clicked.name]:!0,[a.z.Deploy_Failed.name]:!0,[a.z.Deploy_Success.name]:!0,[a.z.PipelinePause_Clicked.name]:!0,[a.z.PipelinePause_Failed.name]:!0,[a.z.PipelinePause_Success.name]:!0,[a.z.PipelineResume_Clicked.name]:!0,[a.z.PipelineResume_Failed.name]:!0,[a.z.PipelineResume_Success.name]:!0,[a.z.PipelineRename_Clicked.name]:!0,[a.z.PipelineRename_Failed.name]:!0,[a.z.PipelineRename_Success.name]:!0,[a.z.PipelineEdit_Clicked.name]:!0,[a.z.PipelineEdit_Failed.name]:!0,[a.z.PipelineEdit_Success.name]:!0,[a.z.PipelineDelete_Clicked.name]:!0,[a.z.PipelineDelete_Failed.name]:!0,[a.z.PipelineDelete_Success.name]:!0,[a.z.PipelineModify_Clicked.name]:!0,[a.z.PipelineModify_Failed.name]:!0,[a.z.PipelineModify_Success.name]:!0,[a.z.Pipeline_ExistingPipeline.name]:!0,[a.z.Pipeline_ExistingSamePipeline.name]:!0,[a.z.Mode_CreateEntered.name]:!0,[a.z.Mode_EditEntered.name]:!0,[a.z.Mode_ViewEntered.name]:!0};var n=i(8387),s=i(4214),r=i(9543);let c=new Map,l=r.env.NEXT_PUBLIC_MIXPANEL_TOKEN||"209670ec9b352915013a5dfdb169dd25",d=()=>"true"===localStorage.getItem("glassflow-is-internal"),p=()=>{try{l.substring(0,4),l.substring(l.length-4),s.A.init(l,{persistence:"localStorage",debug:!1,autocapture:!1,track_pageview:"url-with-path"}),s.A.set_config({debug:!1})}catch(e){console.error("Failed to initialize analytics:",e)}},u=e=>{try{s.A.identify(e),s.A.people.set({$distinct_id:e,"First Seen":new Date().toISOString(),"User Type":"Anonymous","App Version":r.env.NEXT_PUBLIC_APP_VERSION||"unknown",Platform:"undefined"!=typeof navigator?navigator.platform:"unknown","User Agent":"undefined"!=typeof navigator?navigator.userAgent:"unknown","Internal User":d()})}catch(e){console.error("Failed to set user identity:",e)}},m=e=>{let{event:t,context:i,properties:a}=e,{overrideTrackingConsent:r}=a||{};try{if(!(0,n.E7)()&&!r||!(t.name in o))return;let e=((e,t,i)=>{try{return"".concat(e,":").concat(String(t),":").concat(JSON.stringify(i||{}))}catch(i){return"".concat(e,":").concat(String(t))}})(t.name,i,a),l=Date.now();if(c.has(e)){let t=c.get(e)||0;if(l-t<1e3)return}if(c.set(e,l),c.size>50){let e=[];c.forEach((t,i)=>{l-t>1e4&&e.push(i)}),e.forEach(e=>c.delete(e))}let p={event:t.name,context:i,isInternalUser:d(),...a};try{s.A.track(t.name,p)}catch(e){console.error("Error during mixpanel.track():",e)}}catch(e){console.error("Error in track function:",e)}}},8090:(e,t,i)=>{i.d(t,{useStore:()=>E});var a=i(2545),o=i(352);let n={availableTopics:["transactions","credit_card_1_transactions","__consumer_offsets"],topicCount:1,topics:{0:{index:0,name:"credit_card_1_transactions",initialOffset:"latest",replicas:3,partitionCount:3,events:[{event:{booking_date:"1970-01-01",value_date:"1970-01-01",transaction_type:"Debit",description:"Commerzbank AG COMMERZBANK AG 5232249017093073 ABR ECHNUNG KREDITKARTE VOM 27.02.25 End-To-End Reference: 9440-8463529828357631-RD-2502272000 Mandate Reference: 100INH0002104832 ID Of Ordering Party: DE3810000000020140 SEPA-CORE-DIRECT DEBIT subsequent",amount:-507,currency:"EUR",iban:"DE47100400000156459000",category:"Banking & Loans",_metadata:{topic:"credit_card_1_transactions",partition:0,offset:"0",timestamp:"1743086033817"},key:"1"},topicIndex:0}],selectedEvent:{event:{booking_date:"1970-01-01",value_date:"1970-01-01",transaction_type:"Debit",description:"Commerzbank AG COMMERZBANK AG 5232249017093073 ABR ECHNUNG KREDITKARTE VOM 27.02.25 End-To-End Reference: 9440-8463529828357631-RD-2502272000 Mandate Reference: 100INH0002104832 ID Of Ordering Party: DE3810000000020140 SEPA-CORE-DIRECT DEBIT subsequent",amount:-507,currency:"EUR",iban:"DE47100400000156459000",category:"Banking & Loans",_metadata:{topic:"credit_card_1_transactions",partition:0,offset:"0",timestamp:"1743086033817"},key:"1"},topicIndex:0}}},updateTopic:()=>{},invalidateTopicDependentState:()=>{},resetTopicsStore:()=>{},markAsValid:()=>{},markAsInvalidated:()=>{},getTopic:e=>n.topics[e.toString()],getEvent:()=>null,validation:{isValid:!0,isInvalidated:!1}},s={deduplicationConfigs:{0:{enabled:!0,window:5,unit:"minutes",key:"booking_date",keyType:"string"}},updateDeduplication:()=>{},invalidateDeduplication:()=>{},getDeduplication:e=>s.deduplicationConfigs[e.toString()],validation:{isValid:!0,isInvalidated:!1}},r={activeStep:"review-configuration",completedSteps:["kafka-connection","topic-selection","deduplication-configurator","clickhouse-connection","clickhouse-mapper"],editingStep:""},c={kafkaStore:{authMethod:"SASL/PLAIN",securityProtocol:"SASL_PLAINTEXT",bootstrapServers:"localhost:9092, localhost:9093, localhost:9094",isConnected:!0,skipAuth:!1,saslPlain:{username:"admin",password:"admin-secret",consumerGroup:"default"},saslJaas:{jaasConfig:""},saslGssapi:{kerberosPrincipal:"",kerberosKeytab:""},saslOauthbearer:{oauthBearerToken:""},saslScram256:{username:"",password:"",consumerGroup:""},saslScram512:{username:"",password:"",consumerGroup:""},noAuth:{consumerGroup:""},awsIam:{awsAccessKey:"",awsAccessKeySecret:"",awsRegion:"",awsIAMRoleArn:""},delegationTokens:{delegationToken:""},ldap:{ldapServerUrl:"",ldapServerPort:"",ldapBaseDn:"",ldapBindDn:"",ldapBindPassword:"",ldapUserSearchFilter:""},mtls:{clientCert:"",clientKey:"",password:""},setKafkaAuthMethod:()=>{},setKafkaSecurityProtocol:()=>{},setKafkaBootstrapServers:()=>{},setKafkaNoAuth:()=>{},setKafkaSaslPlain:()=>{},setKafkaSaslJaas:()=>{},setKafkaSaslGssapi:()=>{},setKafkaSaslOauthbearer:()=>{},setKafkaSaslScram256:()=>{},setKafkaSaslScram512:()=>{},setKafkaAwsIam:()=>{},setKafkaDelegationTokens:()=>{},setKafkaLdap:()=>{},setKafkaMtls:()=>{},setKafkaConnection:()=>{},setKafkaSkipAuth:()=>{},setIsConnected:()=>{},getIsKafkaConnectionDirty:()=>!1,resetKafkaStore:()=>{}},clickhouseConnectionStore:{clickhouseConnection:{connectionType:"direct",directConnection:{host:"https://t6nh3rt60e.eu-central-1.aws.clickhouse.cloud",httpPort:"8443",username:"default",password:"SYEq_Q2KGWO.u",nativePort:"",useSSL:!1,skipCertificateVerification:!1},connectionStatus:"success",connectionError:null},clickhouseMetadata:null,setClickhouseConnection:()=>{},getIsClickhouseConnectionDirty:()=>!1,updateDatabases:()=>{},updateTables:()=>{},updateTableSchema:()=>{},clearData:()=>{},getDatabases:()=>[],getTables:()=>[],getTableSchema:()=>[],getConnectionId:()=>null},clickhouseDestinationStore:{clickhouseDestination:{scheme:"",database:"default",table:"DE47100400000156459000_EUR_10_03_2025_1143",destinationColumns:[{name:"Bookind date",type:"Date",default_type:"",default_expression:"",comment:"",codec_expression:"",ttl_expression:""},{name:"Value date",type:"Date",default_type:"",default_expression:"",comment:"",codec_expression:"",ttl_expression:""},{name:"Transaction type",type:"String",default_type:"",default_expression:"",comment:"",codec_expression:"",ttl_expression:""},{name:"Booking text",type:"String",default_type:"",default_expression:"",comment:"",codec_expression:"",ttl_expression:""},{name:"Amount",type:"Float32",default_type:"",default_expression:"",comment:"",codec_expression:"",ttl_expression:""},{name:"Currency",type:"String",default_type:"",default_expression:"",comment:"",codec_expression:"",ttl_expression:""},{name:"Account IBAN",type:"String",default_type:"",default_expression:"",comment:"",codec_expression:"",ttl_expression:""},{name:"Category",type:"String",default_type:"",default_expression:"",comment:"",codec_expression:"",ttl_expression:""}],mapping:[{name:"Bookind date",type:"Date",default_type:"",default_expression:"",comment:"",codec_expression:"",ttl_expression:"",jsonType:"string",isNullable:!1,isKey:!1,eventField:"booking_date"},{name:"Value date",type:"Date",default_type:"",default_expression:"",comment:"",codec_expression:"",ttl_expression:"",jsonType:"string",isNullable:!1,isKey:!1,eventField:"transaction_type"},{name:"Transaction type",type:"String",default_type:"",default_expression:"",comment:"",codec_expression:"",ttl_expression:"",jsonType:"string",isNullable:!1,isKey:!1,eventField:"value_date"},{name:"Booking text",type:"String",default_type:"",default_expression:"",comment:"",codec_expression:"",ttl_expression:"",jsonType:"number",isNullable:!1,isKey:!1,eventField:"amount"},{name:"Amount",type:"Float32",default_type:"",default_expression:"",comment:"",codec_expression:"",ttl_expression:"",jsonType:"string",isNullable:!1,isKey:!1,eventField:"description"},{name:"Currency",type:"String",default_type:"",default_expression:"",comment:"",codec_expression:"",ttl_expression:"",jsonType:"string",isNullable:!1,isKey:!1,eventField:"_metadata.offset"},{name:"Account IBAN",type:"String",default_type:"",default_expression:"",comment:"",codec_expression:"",ttl_expression:"",jsonType:"string",isNullable:!1,isKey:!1,eventField:"_metadata.offset"},{name:"Category",type:"String",default_type:"",default_expression:"",comment:"",codec_expression:"",ttl_expression:"",jsonType:"string",isNullable:!1,isKey:!1,eventField:"_metadata.timestamp"}],maxBatchSize:1e3,maxDelayTime:1,maxDelayTimeUnit:"m"},setClickhouseDestination:()=>{},resetDestinationState:()=>{},getIsDestinationMappingDirty:()=>!1},topicsStore:n,deduplicationStore:s,coreStore:{pipelineId:"",pipelineName:"",operationsSelected:{operation:"deduplication"},outboundEventPreview:{events:{}},analyticsConsent:!1,consentAnswered:!1,isDirty:!1,apiConfig:{},setPipelineId:()=>{},setPipelineName:()=>{},setOperationsSelected:()=>{},setOutboundEventPreview:()=>{},setAnalyticsConsent:()=>{},setConsentAnswered:()=>{},markAsDirty:()=>{},markAsClean:()=>{},setApiConfig:()=>{},resetPipelineState:()=>{}},joinStore:{enabled:!1,type:"temporal",streams:[],setEnabled:()=>{},setType:()=>{},setStreams:()=>{},getIsJoinDirty:()=>!1,resetJoinStore:()=>{}},stepsStore:{activeStep:r.activeStep,completedSteps:r.completedSteps,editingStep:r.editingStep,setActiveStep:()=>{},setCompletedSteps:()=>{},addCompletedStep:()=>{},removeCompletedStepsAfter:()=>{},setEditingStep:()=>{},resetStepsStore:()=>{}}},l=()=>({status:"not-configured"}),d=()=>({status:"valid",lastModified:new Date}),p=e=>({status:"invalidated",invalidatedBy:e,lastModified:new Date}),u={skipAuth:!1,authMethod:"",securityProtocol:"",bootstrapServers:"",noAuth:{truststore:{location:"",password:"",type:"",algorithm:"",certificates:"",certificatesFileName:""}},saslPlain:{username:"",password:"",truststore:{location:"",password:"",type:"",algorithm:"",certificates:"",certificatesFileName:""},consumerGroup:""},isConnected:!1,validation:l(),saslJaas:{jaasConfig:""},saslGssapi:{kerberosPrincipal:"",kerberosKeytab:"",kerberosKeytabFileName:"",serviceName:"",kerberosRealm:"",kdc:"",krb5Config:"",krb5ConfigFileName:"",truststore:{location:"",password:"",type:"",algorithm:"",certificates:"",certificatesFileName:""}},saslOauthbearer:{oauthBearerToken:""},saslScram256:{username:"",password:"",truststore:{location:"",password:"",type:"",algorithm:"",certificates:"",certificatesFileName:""},consumerGroup:""},saslScram512:{username:"",password:"",truststore:{location:"",password:"",type:"",algorithm:"",certificates:"",certificatesFileName:""},consumerGroup:""},awsIam:{awsRegion:"",awsIAMRoleArn:"",awsAccessKey:"",awsAccessKeySecret:""},delegationTokens:{delegationToken:""},ldap:{ldapServerUrl:"",ldapServerPort:"",ldapBindDn:"",ldapBindPassword:"",ldapUserSearchFilter:"",ldapBaseDn:""},mtls:{clientCert:"",clientKey:"",password:""}},m={clickhouseConnection:{connectionType:"direct",directConnection:{host:"",httpPort:"",username:"",password:"",nativePort:"",useSSL:!0,skipCertificateVerification:!1},connectionStatus:"idle",connectionError:null},clickhouseMetadata:null,validation:l()},S={clickhouseDestination:{scheme:"",database:"",table:"",mapping:[],destinationColumns:[],maxBatchSize:1e3,maxDelayTime:1,maxDelayTimeUnit:"m"},validation:l()},f={activeStep:"",completedSteps:[],editingStep:""},h={enabled:!1,type:"temporal",streams:[],validation:l()};var k=i(9947),y=i(5170);function _(e){var t;if(null==e||null==(t=e.source)?void 0:t.connection_params){let t=function(e){let t=!!e.skip_auth,i=(e.mechanism||"").toString().toUpperCase();return{authMethod:t?"NO_AUTH":"PLAIN"===i?"SASL/PLAIN":"SCRAM-SHA-256"===i?"SASL/SCRAM-256":"SCRAM-SHA-512"===i?"SASL/SCRAM-512":"OAUTHBEARER"===i?"SASL/OAUTHBEARER":"GSSAPI"===i?"SASL/GSSAPI":"JAAS"===i?"SASL/JAAS":"LDAP"===i?"SASL/LDAP":"MTLS"===i?"mTLS":"",securityProtocol:e.protocol||"",bootstrapServers:(e.brokers||[]).join(", "),skipAuth:t,saslPlain:{username:e.username||"",password:e.password||"",truststore:{location:"",password:"",type:"",algorithm:"",certificates:e.root_ca?atob(e.root_ca):""},consumerGroup:e.consumer_group||""},saslScram256:{username:e.username||"",password:e.password||"",truststore:{location:"",password:"",type:"",algorithm:"",certificates:e.root_ca?atob(e.root_ca):""},consumerGroup:e.consumer_group||""},saslScram512:{username:e.username||"",password:e.password||"",truststore:{location:"",password:"",type:"",algorithm:"",certificates:e.root_ca?atob(e.root_ca):""}},saslJaas:{jaasConfig:e.jaas_config||""},saslGssapi:{kerberosPrincipal:e.kerberos_principal||"",kerberosKeytab:e.kerberos_keytab||"",serviceName:e.service_name||"",kerberosRealm:e.kerberos_realm||"",kdc:e.kdc||"",krb5Config:e.krb5_config||"",useTicketCache:e.use_ticket_cache||!1,ticketCachePath:e.ticket_cache_path||"",truststore:{location:"",password:"",type:"",algorithm:"",certificates:e.root_ca?atob(e.root_ca):""}},saslOauthbearer:{oauthBearerToken:e.oauth_bearer_token||""},awsIam:{awsRegion:e.aws_region||"",awsIAMRoleArn:e.aws_iam_role_arn||"",awsAccessKey:e.aws_access_key||"",awsAccessKeySecret:e.aws_access_key_secret||""},delegationTokens:{delegationToken:e.delegation_token||""},ldap:{ldapServerUrl:e.ldap_server_url||"",ldapServerPort:e.ldap_server_port||"",ldapBindDn:e.ldap_bind_dn||"",ldapBindPassword:e.ldap_bind_password||"",ldapUserSearchFilter:e.ldap_user_search_filter||"",ldapBaseDn:e.ldap_base_dn||""},mtls:{clientCert:e.client_cert||"",clientKey:e.client_key||"",password:e.password||""},noAuth:{truststore:{location:"",password:"",type:"",algorithm:"",certificates:e.root_ca?atob(e.root_ca):""}}}}(e.source.connection_params);E.getState().kafkaStore.setKafkaConnection(t)}}function g(e){let t=[];return e.bootstrapServers&&""!==e.bootstrapServers.trim()||t.push("bootstrapServers"),e.securityProtocol&&""!==e.securityProtocol.trim()||t.push("securityProtocol"),e.authMethod&&""!==e.authMethod.trim()||t.push("authMethod"),"SASL/PLAIN"===e.authMethod?(e.saslPlain.username&&""!==e.saslPlain.username.trim()||t.push("saslPlain.username"),e.saslPlain.password&&""!==e.saslPlain.password.trim()||t.push("saslPlain.password")):"SASL/SCRAM-256"===e.authMethod?(e.saslScram256.username&&""!==e.saslScram256.username.trim()||t.push("saslScram256.username"),e.saslScram256.password&&""!==e.saslScram256.password.trim()||t.push("saslScram256.password")):"SASL/SCRAM-512"===e.authMethod&&(e.saslScram512.username&&""!==e.saslScram512.username.trim()||t.push("saslScram512.username"),e.saslScram512.password&&""!==e.saslScram512.password.trim()||t.push("saslScram512.password")),{isValid:0===t.length,missingFields:t}}async function C(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100;for(let i=0;i<e;i++){let a=g(E.getState().kafkaStore);if(a.isValid)return void console.log("✅ Kafka store properly hydrated, proceeding with topics fetch");console.log("⏳ Kafka store not ready (attempt ".concat(i+1,"/").concat(e,"), missing: ").concat(a.missingFields.join(", "))),i<e-1&&await new Promise(e=>setTimeout(e,t))}let i=g(E.getState().kafkaStore);throw Error("Kafka store hydration timeout. Missing fields: ".concat(i.missingFields.join(", ")))}async function v(e){try{var t,i,a,o,n,s,r,c,l,d,p;await C();let u=E.getState().kafkaStore,m={servers:u.bootstrapServers,securityProtocol:u.securityProtocol,authMethod:u.authMethod};switch(u.authMethod){case"SASL/PLAIN":m.username=u.saslPlain.username,m.password=u.saslPlain.password,m.consumerGroup=u.saslPlain.consumerGroup,(null==(a=u.saslPlain)||null==(i=a.truststore)?void 0:i.certificates)&&(m.certificate=u.saslPlain.truststore.certificates);break;case"SASL/SCRAM-256":m.username=u.saslScram256.username,m.password=u.saslScram256.password,m.consumerGroup=u.saslScram256.consumerGroup,(null==(n=u.saslScram256)||null==(o=n.truststore)?void 0:o.certificates)&&(m.certificate=u.saslScram256.truststore.certificates);break;case"SASL/SCRAM-512":m.username=u.saslScram512.username,m.password=u.saslScram512.password,(null==(r=u.saslScram512)||null==(s=r.truststore)?void 0:s.certificates)&&(m.certificate=u.saslScram512.truststore.certificates);break;case"SASL/GSSAPI":(null==(l=u.saslGssapi)||null==(c=l.truststore)?void 0:c.certificates)&&(m.certificate=u.saslGssapi.truststore.certificates);break;case"NO_AUTH":(null==(p=u.noAuth)||null==(d=p.truststore)?void 0:d.certificates)&&(m.certificate=u.noAuth.truststore.certificates)}let[S,f]=await Promise.all([fetch("/ui-api/kafka/topics",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(m)}),fetch("/ui-api/kafka/topic-details",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(m)})]),h=await S.json();if(!h.success)throw Error(h.error||"Failed to fetch topics");let k=await f.json();if(!k.success)throw Error(k.error||"Failed to fetch topic details");E.getState().topicsStore.setAvailableTopics(h.topics),(null==e||null==(t=e.source)?void 0:t.topics)&&(e.source.topics.forEach((e,t)=>{var i,a;let o=null==(i=k.topicDetails)?void 0:i.find(t=>t.name===e.name),n=(null==o?void 0:o.partitionCount)||1,s=E.getState().topicsStore.getTopic(t),r=null==s||null==(a=s.selectedEvent)?void 0:a.event,c=null==s?void 0:s.replicas,l=function(e,t){let i=e.consumer_group_initial_offset||"latest";return{index:t,name:e.name,initialOffset:i,events:[],selectedEvent:{topicIndex:t,position:i,event:void 0},replicas:e.replicas||1,partitionCount:e.partition_count||1}}(e,t);l.partitionCount=n,r&&(l.selectedEvent.event=r,console.log('[Hydration] Preserving existing event data for topic "'.concat(e.name,'"'))),c&&c!==l.replicas&&(l.replicas=c,console.log("[Hydration] Preserving user-modified replica count (".concat(c,') for topic "').concat(e.name,'"'))),E.getState().topicsStore.updateTopic(l);let d=E.getState().deduplicationStore.getDeduplication(t);if(d&&d.key)console.log('[Hydration] Preserving existing deduplication config for topic "'.concat(e.name,'"'));else{let i=function(e,t){if(!e.deduplication)return{enabled:!1,window:0,unit:"hours",key:"",keyType:"string"};let i=e.deduplication.time_window||"1h",a=1,o="hours",n=i.match(/^(\d+d)?(\d+h)?(\d+m)?(\d+s)?$/);if(n){var s,r,c,l;let e=parseInt((null==(s=n[1])?void 0:s.replace("d",""))||"0")||0,t=parseInt((null==(r=n[2])?void 0:r.replace("h",""))||"0")||0,i=parseInt((null==(c=n[3])?void 0:c.replace("m",""))||"0")||0,d=86400*e+3600*t+60*i+(parseInt((null==(l=n[4])?void 0:l.replace("s",""))||"0")||0);d>=86400?(a=Math.round(d/86400),o="days"):d>=3600?(a=Math.round(d/3600),o="hours"):d>=60?(a=Math.round(d/60),o="minutes"):(a=d,o="seconds")}else{let e=i.match(/^(\d+)([smhd])$/);if(e)switch(a=parseInt(e[1])||1,e[2]){case"s":o="seconds";break;case"m":o="minutes";break;case"h":default:o="hours";break;case"d":o="days"}}return{enabled:e.deduplication.enabled,key:e.deduplication.id_field,keyType:e.deduplication.id_field_type,window:a,unit:o}}(e,0);E.getState().deduplicationStore.updateDeduplication(t,i),console.log('[Hydration] Setting initial deduplication config for topic "'.concat(e.name,'"'))}}),console.log("[Hydration] Checking which topics need event data..."),await Promise.all(e.source.topics.map(async(e,t)=>{try{var i;let a=E.getState().topicsStore.getTopic(t);if(null==a||null==(i=a.selectedEvent)?void 0:i.event)return void console.log('[Hydration] ⏭️  Skipping event fetch for topic "'.concat(e.name,'" (already has event data)'));console.log('[Hydration] \uD83D\uDCE5 Fetching event for topic "'.concat(e.name,'"...'));let o=await fetch("/ui-api/kafka/events",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...m,topicName:e.name,offset:e.consumer_group_initial_offset||"latest",partition:0,format:"JSON"})}),n=await o.json();if(n.success&&n.event){let i=E.getState().topicsStore.getTopic(t);i&&(E.getState().topicsStore.updateTopic({...i,selectedEvent:{topicIndex:t,position:e.consumer_group_initial_offset||"latest",event:n.event}}),console.log('[Hydration] ✅ Fetched event for topic "'.concat(e.name,'"')))}else console.warn('[Hydration] ⚠️ Could not fetch event for topic "'.concat(e.name,'":'),n.error)}catch(t){console.error('[Hydration] ❌ Failed to fetch event for topic "'.concat(e.name,'":'),t)}})))}catch(e){throw console.error("❌ Failed to hydrate Kafka topics:",e),e}}function b(e){if(null==e?void 0:e.sink){let t=function(e){var t;let i=e.password||"";try{if(e.password&&"string"==typeof e.password){let t=atob(e.password);t&&!/[\x00-\x1F\x7F]/.test(t)?i=t:console.log("hydrateClickhouseConnection - password appears to be already decoded or contains control characters")}}catch(t){i=e.password||""}return{connectionType:"direct",directConnection:{host:e.host||"",httpPort:e.http_port||"",username:e.username||"",password:i,nativePort:e.port||"",useSSL:null==(t=e.secure)||t,skipCertificateVerification:e.skip_certificate_verification||!1},connectionStatus:"idle",connectionError:null}}(e.sink);E.getState().clickhouseConnectionStore.setClickhouseConnection(t)}}async function P(e){var t,a,o;let n=null==e?void 0:e.sink;if(!n)return;let s=n.password||"";try{if(n.password&&"string"==typeof n.password){let e=atob(n.password);e&&!/[\x00-\x1F\x7F]/.test(e)?s=e:console.log("hydrateClickhouseDestination - password appears to be already decoded or contains control characters")}}catch(e){s=n.password||""}let r=function(e){let t=1,i="m";if(e.max_delay_time)if("string"==typeof e.max_delay_time){let a=e.max_delay_time.match(/(?:(\d+)d)?(?:(\d+)h)?(?:(\d+)m)?(?:(\d+)s)?/);if(a){let e=parseInt(a[1]||"0"),o=parseInt(a[2]||"0"),n=86400*e+3600*o+60*parseInt(a[3]||"0")+parseInt(a[4]||"0");n>=86400&&n%86400==0?(t=Math.round(n/86400),i="d"):n>=3600&&n%3600==0||n>=3600?(t=Math.round(n/3600),i="h"):n>=60?(t=Math.round(n/60),i="m"):(t=n,i="s")}}else"number"==typeof e.max_delay_time&&(t=e.max_delay_time,i="m");return{scheme:"",database:e.database||"",table:e.table||"",mapping:e.table_mapping||[],destinationColumns:[],maxBatchSize:e.max_batch_size||1e3,maxDelayTime:t,maxDelayTimeUnit:i}}(n);E.getState().clickhouseDestinationStore.setClickhouseDestination(r),console.log("[Hydration] Fetching ClickHouse databases...");let c=await fetch("/ui-api/clickhouse/databases",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({host:n.host,httpPort:Number(n.http_port),nativePort:Number(n.port),username:n.username,password:s,useSSL:n.secure,skipCertificateVerification:n.skip_certificate_verification})}),l=await c.json();if(!l.success){console.error("[Hydration] Failed to fetch databases:",l.error),console.warn("[Hydration] Continuing with basic destination setup (databases unavailable)");return}console.log("[Hydration] Databases fetched successfully:",null==(t=l.databases)?void 0:t.length),console.log("[Hydration] Fetching tables for database:",n.database);let d=await fetch("/ui-api/clickhouse/tables",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({host:n.host,httpPort:Number(n.http_port),nativePort:Number(n.port),username:n.username,password:s,useSSL:n.secure,skipCertificateVerification:n.skip_certificate_verification,database:n.database})}),p=await d.json();if(!p.success){console.error("[Hydration] Failed to fetch tables:",p.error),console.warn("[Hydration] Continuing with basic destination setup (tables unavailable)");return}console.log("[Hydration] Tables fetched successfully:",null==(a=p.tables)?void 0:a.length),console.log("[Hydration] Fetching schema for table:",n.database,n.table);let u=await fetch("/ui-api/clickhouse/schema",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({host:n.host,httpPort:Number(n.http_port),nativePort:Number(n.port),username:n.username,password:s,useSSL:n.secure,skipCertificateVerification:n.skip_certificate_verification,database:n.database,table:n.table})}),m=await u.json();if(!m.success){console.error("[Hydration] Failed to fetch schema:",m.error),console.warn("[Hydration] Continuing with basic destination setup (schema unavailable)");return}console.log("[Hydration] Schema fetched successfully:",null==(o=m.columns)?void 0:o.length);let S=m.columns||[],{filterUserMappableColumns:f}=await Promise.all([i.e(3797),i.e(1694)]).then(i.bind(i,3797)),h=f(S),k=Array.isArray(n.table_mapping)?n.table_mapping:[],y=h.map(e=>{let t=k.find(t=>(t.column_name||t.name)===e.name),i=e.type||e.column_type||"",a=function(e){let t=(e||"").toLowerCase();if(!t)return"";let i=t.replace(/nullable\((.*)\)/,"$1").replace(/lowcardinality\((.*)\)/,"$1");return i.startsWith("string")||i.startsWith("fixedstring")||i.includes("uuid")?"string":i.startsWith("bool")||"boolean"===i?"bool":i.startsWith("u")?"uint":i.startsWith("int")?"int":i.startsWith("float")||i.startsWith("decimal")?"float":i.startsWith("date")||i.startsWith("datetime")?"string":i.startsWith("array")?"array":i.startsWith("map")?"bytes":"string"}(i);return{name:e.name,type:i,isNullable:!0===e.isNullable||(e.type||e.column_type||"").includes("Nullable"),jsonType:(null==t?void 0:t.jsonType)||a,eventField:(null==t?void 0:t.field_name)||(null==t?void 0:t.eventField)||"",...(null==t?void 0:t.source_id)?{sourceTopic:t.source_id}:{}}});E.getState().clickhouseDestinationStore.setClickhouseDestination({...r,destinationColumns:h.map(e=>({name:e.name,type:e.type||e.column_type||"",isNullable:!0===e.isNullable||(e.type||e.column_type||"").includes("Nullable"),default_type:e.default_type||"",default_expression:e.default_expression||"",default_kind:e.default_kind||""})),mapping:y})}function w(e){let t=null==e?void 0:e.join;if(t)if(E.getState().joinStore.setEnabled(!!t.enabled),E.getState().joinStore.setType(t.type||"temporal"),t.sources){let e=(t.sources||[]).map(e=>{let{value:t,unit:i}=function(e){let t=e||"1h",i=1,a="hours",o=t.match(/^(\d+d)?(\d+h)?(\d+m)?(\d+s)?$/);if(o){var n,s,r,c;let e=parseInt((null==(n=o[1])?void 0:n.replace("d",""))||"0")||0,t=parseInt((null==(s=o[2])?void 0:s.replace("h",""))||"0")||0,l=86400*e+3600*t+60*(parseInt((null==(r=o[3])?void 0:r.replace("m",""))||"0")||0)+(parseInt((null==(c=o[4])?void 0:c.replace("s",""))||"0")||0);l>=86400?(i=Math.round(l/86400),a="days"):l>=3600?(i=Math.round(l/3600),a="hours"):l>=60?(i=Math.round(l/60),a="minutes"):(i=l,a="seconds")}else{let e=t.match(/^(\d+)([smhd])$/);if(e)switch(i=parseInt(e[1])||1,e[2]){case"s":a="seconds";break;case"m":a="minutes";break;case"h":default:a="hours";break;case"d":a="days"}}return{value:i,unit:a}}(e.time_window);return{streamId:e.source_id,topicName:e.source_id,joinKey:e.join_key,joinTimeWindowValue:t,joinTimeWindowUnit:i,orientation:e.orientation}});E.getState().joinStore.setStreams(e)}else E.getState().joinStore.setStreams([])}let D=e=>{var t,i;let a=(null==e||null==(t=e.source)?void 0:t.topics)||[],o=(null==e||null==(i=e.join)?void 0:i.enabled)||!1,n=e=>{let t=null==e?void 0:e.deduplication,i=(null==t?void 0:t.enabled)===!0,a="string"==typeof(null==t?void 0:t.id_field)&&""!==t.id_field.trim();return i&&a};if(1===a.length&&!o)return n(a[0])?"deduplication":"ingest-only";if(a.length>1&&o){let e=n(a[0]),t=n(a[1]);return e&&t?"deduplication-joining":"joining"}return"ingest-only"},T={pipelineId:"",pipelineName:"",operationsSelected:{operation:""},outboundEventPreview:{events:[]},analyticsConsent:!1,consentAnswered:!1,isDirty:!1,apiConfig:{},mode:"create",baseConfig:void 0,lastSavedConfig:void 0,saveHistory:[]},F=(0,a.v)()((0,o.lt)((e,t,a)=>({...((e,t)=>({kafkaStore:{authMethod:"",securityProtocol:"",bootstrapServers:"",skipAuth:!1,isConnected:!1,validation:l(),noAuth:{truststore:{location:"",password:"",type:"",algorithm:"",certificates:"",certificatesFileName:""}},saslPlain:{username:"",password:"",truststore:{location:"",password:"",type:"",algorithm:"",certificates:"",certificatesFileName:""},consumerGroup:""},saslJaas:{jaasConfig:""},saslGssapi:{kerberosPrincipal:"",kerberosKeytab:"",kerberosKeytabFileName:"",serviceName:"",kerberosRealm:"",kdc:"",krb5Config:"",krb5ConfigFileName:"",useTicketCache:!1,ticketCachePath:"",truststore:{location:"",password:"",type:"",algorithm:"",certificates:"",certificatesFileName:""}},saslOauthbearer:{oauthBearerToken:""},saslScram256:{username:"",password:"",truststore:{location:"",password:"",type:"",algorithm:"",certificates:"",certificatesFileName:""},consumerGroup:""},saslScram512:{username:"",password:"",truststore:{location:"",password:"",type:"",algorithm:"",certificates:"",certificatesFileName:""},consumerGroup:""},awsIam:{awsRegion:"",awsIAMRoleArn:"",awsAccessKey:"",awsAccessKeySecret:""},delegationTokens:{delegationToken:""},ldap:{ldapServerUrl:"",ldapServerPort:"",ldapBindDn:"",ldapBindPassword:"",ldapUserSearchFilter:"",ldapBaseDn:""},mtls:{clientCert:"",clientKey:"",password:""},setKafkaAuthMethod:t=>e(e=>({kafkaStore:{...e.kafkaStore,authMethod:t}})),setKafkaSkipAuth:t=>e(e=>({kafkaStore:{...e.kafkaStore,skipAuth:t}})),setKafkaSecurityProtocol:t=>e(e=>({kafkaStore:{...e.kafkaStore,securityProtocol:t}})),setKafkaBootstrapServers:t=>e(e=>({kafkaStore:{...e.kafkaStore,bootstrapServers:t}})),setKafkaNoAuth:t=>e(e=>({kafkaStore:{...e.kafkaStore,noAuth:t}})),setKafkaSaslPlain:t=>e(e=>({kafkaStore:{...e.kafkaStore,saslPlain:t}})),setKafkaSaslJaas:t=>e(e=>({kafkaStore:{...e.kafkaStore,saslJaas:t}})),setKafkaSaslGssapi:t=>e(e=>({kafkaStore:{...e.kafkaStore,saslGssapi:t}})),setKafkaSaslOauthbearer:t=>e(e=>({kafkaStore:{...e.kafkaStore,saslOauthbearer:t}})),setKafkaSaslScram256:t=>e(e=>({kafkaStore:{...e.kafkaStore,saslScram256:t}})),setKafkaSaslScram512:t=>e(e=>({kafkaStore:{...e.kafkaStore,saslScram512:t}})),setKafkaAwsIam:t=>e(e=>({kafkaStore:{...e.kafkaStore,awsIam:t}})),setKafkaDelegationTokens:t=>e(e=>({kafkaStore:{...e.kafkaStore,delegationTokens:t}})),setKafkaLdap:t=>e(e=>({kafkaStore:{...e.kafkaStore,ldap:t}})),setKafkaMtls:t=>e(e=>({kafkaStore:{...e.kafkaStore,mtls:t}})),setKafkaConnection:t=>e(e=>({kafkaStore:{...e.kafkaStore,...t,validation:d()}})),setIsConnected:t=>e(e=>({kafkaStore:{...e.kafkaStore,isConnected:t}})),getIsKafkaConnectionDirty:()=>{let{authMethod:e,securityProtocol:i,bootstrapServers:a,saslPlain:o,saslJaas:n,saslGssapi:s,saslOauthbearer:r,saslScram256:c,saslScram512:l,awsIam:d,delegationTokens:p,ldap:u,mtls:m}=t().kafkaStore;return Object.entries({authMethod:e,securityProtocol:i,bootstrapServers:a}).filter(e=>{let[t,i]=e;return""!==i}),Object.values({authMethod:e,securityProtocol:i,bootstrapServers:a}).some(e=>""!==e)},resetKafkaStore:()=>e(e=>({kafkaStore:{...e.kafkaStore,...u}})),markAsValid:()=>e(e=>({kafkaStore:{...e.kafkaStore,validation:d()}})),markAsInvalidated:t=>e(e=>({kafkaStore:{...e.kafkaStore,validation:p(t)}})),markAsNotConfigured:()=>e(e=>({kafkaStore:{...e.kafkaStore,validation:l()}})),resetValidation:()=>e(e=>({kafkaStore:{...e.kafkaStore,validation:l()}}))}}))(e,t,a),...((e,t)=>({clickhouseConnectionStore:{clickhouseConnection:{connectionType:"direct",directConnection:{host:"",httpPort:"",username:"",password:"",nativePort:"",useSSL:!0,skipCertificateVerification:!1},connectionStatus:"idle",connectionError:null},clickhouseMetadata:null,validation:l(),setClickhouseConnection:t=>e(e=>{let i=e.clickhouseConnectionStore.clickhouseConnection;return i.directConnection.host!==t.directConnection.host||i.directConnection.httpPort!==t.directConnection.httpPort||i.directConnection.username!==t.directConnection.username||i.directConnection.password!==t.directConnection.password?{clickhouseConnectionStore:{...e.clickhouseConnectionStore,clickhouseConnection:t,clickhouseMetadata:null,validation:"success"===t.connectionStatus?d():e.clickhouseConnectionStore.validation}}:{clickhouseConnectionStore:{...e.clickhouseConnectionStore,clickhouseConnection:t,validation:"success"===t.connectionStatus?d():e.clickhouseConnectionStore.validation}}}),getIsClickhouseConnectionDirty:()=>{let{directConnection:e,connectionStatus:i,connectionError:a}=t().clickhouseConnectionStore.clickhouseConnection;return Object.values(e).some(e=>""!==e)||"idle"!==i||null!==a},updateDatabases:(t,i)=>e(e=>{var a,o;return{clickhouseConnectionStore:{...e.clickhouseConnectionStore,clickhouseMetadata:{lastFetched:Date.now(),connectionId:i,databases:t,tables:(null==(a=e.clickhouseConnectionStore.clickhouseMetadata)?void 0:a.tables)||{},tableSchemas:(null==(o=e.clickhouseConnectionStore.clickhouseMetadata)?void 0:o.tableSchemas)||{}}}}}),updateTables:(t,i,a)=>e(e=>{var o,n,s;return{clickhouseConnectionStore:{...e.clickhouseConnectionStore,clickhouseMetadata:{lastFetched:Date.now(),connectionId:a,databases:(null==(o=e.clickhouseConnectionStore.clickhouseMetadata)?void 0:o.databases)||[],tables:{...null==(n=e.clickhouseConnectionStore.clickhouseMetadata)?void 0:n.tables,[t]:i},tableSchemas:(null==(s=e.clickhouseConnectionStore.clickhouseMetadata)?void 0:s.tableSchemas)||{}}}}}),updateTableSchema:(t,i,a,o)=>e(e=>{var n,s,r;return{clickhouseConnectionStore:{...e.clickhouseConnectionStore,clickhouseMetadata:{lastFetched:Date.now(),connectionId:o,databases:(null==(n=e.clickhouseConnectionStore.clickhouseMetadata)?void 0:n.databases)||[],tables:(null==(s=e.clickhouseConnectionStore.clickhouseMetadata)?void 0:s.tables)||{},tableSchemas:{...null==(r=e.clickhouseConnectionStore.clickhouseMetadata)?void 0:r.tableSchemas,["".concat(t,":").concat(i)]:a}}}}}),clearMetadata:()=>e(e=>({clickhouseConnectionStore:{...e.clickhouseConnectionStore,clickhouseMetadata:null}})),getDatabases:()=>{var e;return(null==(e=t().clickhouseConnectionStore.clickhouseMetadata)?void 0:e.databases)||[]},getTables:e=>{var i,a;return(null==(a=t().clickhouseConnectionStore.clickhouseMetadata)||null==(i=a.tables)?void 0:i[e])||[]},getTableSchema:(e,i)=>{var a,o;return(null==(o=t().clickhouseConnectionStore.clickhouseMetadata)||null==(a=o.tableSchemas)?void 0:a["".concat(e,":").concat(i)])||[]},getConnectionId:()=>{var e;return(null==(e=t().clickhouseConnectionStore.clickhouseMetadata)?void 0:e.connectionId)||null},resetClickhouseStore:()=>e(e=>({clickhouseConnectionStore:{...e.clickhouseConnectionStore,...m}})),markAsValid:()=>e(e=>({clickhouseConnectionStore:{...e.clickhouseConnectionStore,validation:d()}})),markAsInvalidated:t=>e(e=>({clickhouseConnectionStore:{...e.clickhouseConnectionStore,validation:p(t)}})),markAsNotConfigured:()=>e(e=>({clickhouseConnectionStore:{...e.clickhouseConnectionStore,validation:l()}})),resetValidation:()=>e(e=>({clickhouseConnectionStore:{...e.clickhouseConnectionStore,validation:l()}}))}}))(e,t,a),...((e,t)=>({clickhouseDestinationStore:{clickhouseDestination:{scheme:"",database:"",table:"",destinationColumns:[],mapping:[],maxBatchSize:1e3,maxDelayTime:1,maxDelayTimeUnit:"m",useSSL:!0},validation:l(),resetDestinationState:()=>e(e=>({clickhouseDestinationStore:{...e.clickhouseDestinationStore,clickhouseDestination:{scheme:"",database:"",table:"",destinationColumns:[],mapping:[],maxBatchSize:1e3,maxDelayTime:1,maxDelayTimeUnit:"m"}}})),setClickhouseDestination:t=>e(e=>({clickhouseDestinationStore:{...e.clickhouseDestinationStore,clickhouseDestination:t,validation:d()}})),getIsDestinationMappingDirty:()=>{let{mapping:e}=t().clickhouseDestinationStore.clickhouseDestination;return e.some(e=>""!==e)},resetDestinationStore:()=>e(e=>({clickhouseDestinationStore:{...e.clickhouseDestinationStore,...S}})),markAsValid:()=>e(e=>({clickhouseDestinationStore:{...e.clickhouseDestinationStore,validation:d()}})),markAsInvalidated:t=>e(e=>({clickhouseDestinationStore:{...e.clickhouseDestinationStore,validation:p(t)}})),markAsNotConfigured:()=>e(e=>({clickhouseDestinationStore:{...e.clickhouseDestinationStore,validation:l()}})),resetValidation:()=>e(e=>({clickhouseDestinationStore:{...e.clickhouseDestinationStore,validation:l()}}))}}))(e,t,a),...(e=>({stepsStore:{...f,setActiveStep:t=>e(e=>({stepsStore:{...e.stepsStore,activeStep:t}})),setCompletedSteps:t=>{e(e=>({stepsStore:{...e.stepsStore,completedSteps:t}}))},addCompletedStep:t=>{e(e=>e.stepsStore.completedSteps.includes(t)?e:{stepsStore:{...e.stepsStore,completedSteps:[...e.stepsStore.completedSteps,t]}})},removeCompletedStepsAfter:t=>{e(e=>{let i=e.stepsStore.completedSteps.indexOf(t);return -1!==i?{stepsStore:{...e.stepsStore,completedSteps:e.stepsStore.completedSteps.slice(0,i+1)}}:e})},setEditingStep:t=>e(e=>({stepsStore:{...e.stepsStore,editingStep:t}})),resetStepsStore:()=>e(e=>({stepsStore:{...e.stepsStore,...f}}))}}))(e,t,a),...((e,t)=>({topicsStore:{availableTopics:[],topicCount:0,topics:{},validation:l(),setAvailableTopics:t=>e(e=>({topicsStore:{...e.topicsStore,availableTopics:t}})),setTopicCount:t=>e(e=>({topicsStore:{...e.topicsStore,topicCount:t}})),updateTopic:t=>e(e=>({topicsStore:{...e.topicsStore,topics:{...e.topicsStore.topics,[t.index]:t},validation:d()}})),getTopic:e=>t().topicsStore.topics[e],getEvent:(e,i)=>{var a,o;return null==(o=t().topicsStore.topics[e])||null==(a=o.events)?void 0:a[i]},invalidateTopicDependentState:i=>{let a=t().topicsStore.topics[i];if(!a)return;let o=t();o.joinStore&&(o.joinStore.setEnabled(!1),o.joinStore.setType(""),o.joinStore.setStreams([])),o.deduplicationStore&&o.deduplicationStore.invalidateDeduplication(i),e(e=>{let t={name:a.name,index:a.index,initialOffset:a.initialOffset,events:[],selectedEvent:{topicIndex:i,position:a.initialOffset,event:null}};return{topicsStore:{...e.topicsStore,topics:{...e.topicsStore.topics,[i]:t}}}})},resetTopicsStore:()=>{e(e=>({topicsStore:{...e.topicsStore,topics:{},availableTopics:[],topicCount:0,validation:l()}}))},markAsValid:()=>e(e=>({topicsStore:{...e.topicsStore,validation:d()}})),markAsInvalidated:t=>e(e=>({topicsStore:{...e.topicsStore,validation:p(t)}})),markAsNotConfigured:()=>e(e=>({topicsStore:{...e.topicsStore,validation:l()}})),resetValidation:()=>e(e=>({topicsStore:{...e.topicsStore,validation:l()}}))}}))(e,t,a),...((e,t)=>({deduplicationStore:{deduplicationConfigs:{},validation:l(),updateDeduplication:(t,i)=>e(e=>({deduplicationStore:{...e.deduplicationStore,deduplicationConfigs:{...e.deduplicationStore.deduplicationConfigs,[t]:i},validation:d()}})),getDeduplication:e=>t().deduplicationStore.deduplicationConfigs[e],invalidateDeduplication:t=>e(e=>({deduplicationStore:{...e.deduplicationStore,deduplicationConfigs:{...e.deduplicationStore.deduplicationConfigs,[t]:{enabled:!0,window:1,unit:"minutes",key:"",keyType:""}},validation:p("topic-changed")}})),resetDeduplicationStore:()=>e(e=>({deduplicationStore:{...e.deduplicationStore,deduplicationConfigs:{},validation:l()}})),markAsValid:()=>e(e=>({deduplicationStore:{...e.deduplicationStore,validation:d()}})),markAsInvalidated:t=>e(e=>({deduplicationStore:{...e.deduplicationStore,validation:p(t)}})),markAsNotConfigured:()=>e(e=>({deduplicationStore:{...e.deduplicationStore,validation:l()}})),resetValidation:()=>e(e=>({deduplicationStore:{...e.deduplicationStore,validation:l()}}))}}))(e,t,a),...((e,t)=>({joinStore:{enabled:!1,type:"temporal",streams:[],validation:l(),setEnabled:t=>e(e=>({joinStore:{...e.joinStore,enabled:t}})),setType:t=>e(e=>({joinStore:{...e.joinStore,type:t}})),setStreams:t=>e(e=>({joinStore:{...e.joinStore,streams:t.map(e=>({topicName:e.topicName,streamId:e.streamId,joinKey:e.joinKey,joinTimeWindowValue:e.joinTimeWindowValue,joinTimeWindowUnit:e.joinTimeWindowUnit,orientation:e.orientation})),validation:d()}})),getIsJoinDirty:()=>{let{streams:e}=t().joinStore;return e.length>0},resetJoinStore:()=>e(e=>({joinStore:{...e.joinStore,...h}})),markAsValid:()=>e(e=>({joinStore:{...e.joinStore,validation:d()}})),markAsInvalidated:t=>e(e=>({joinStore:{...e.joinStore,validation:p(t)}})),markAsNotConfigured:()=>e(e=>({joinStore:{...e.joinStore,validation:l()}})),resetValidation:()=>e(e=>({joinStore:{...e.joinStore,validation:l()}}))}}))(e,t,a),...((e,t)=>({coreStore:{...T,setPipelineId:t=>e(e=>({coreStore:{...e.coreStore,pipelineId:t}})),setPipelineName:t=>e(e=>({coreStore:{...e.coreStore,pipelineName:t}})),setOperationsSelected:t=>e(e=>({coreStore:{...e.coreStore,operationsSelected:t}})),setAnalyticsConsent:t=>e(e=>({coreStore:{...e.coreStore,analyticsConsent:t}})),setConsentAnswered:t=>e(e=>({coreStore:{...e.coreStore,consentAnswered:t}})),setOutboundEventPreview:t=>e(e=>({coreStore:{...e.coreStore,outboundEventPreview:t}})),markAsDirty:()=>{e(e=>({coreStore:{...e.coreStore,isDirty:!0}})),k.A.set("isDirty","true",{expires:1})},markAsClean:()=>{e(e=>({coreStore:{...e.coreStore,isDirty:!1}})),k.A.set("isDirty","false",{expires:1})},setApiConfig:t=>e(e=>({coreStore:{...e.coreStore,apiConfig:t}})),resetPipelineState:function(i){let a=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=t().coreStore;a||o.isDirty&&i!==o.operationsSelected.operation?e(e=>({coreStore:{...e.coreStore,operationsSelected:{operation:i},outboundEventPreview:{events:[]},isDirty:!1}})):e(e=>({coreStore:{...e.coreStore,operationsSelected:{operation:i}}}))},setMode:t=>e(e=>({coreStore:{...e.coreStore,mode:t}})),setBaseConfig:t=>e(e=>({coreStore:{...e.coreStore,baseConfig:t}})),hydrateFromConfig:async i=>{e(e=>({coreStore:{...e.coreStore,pipelineId:i.pipeline_id,pipelineName:i.name,isDirty:!1}}));let a=t();await a.coreStore.hydrateSection("all",i)},resetToInitial:()=>{let{baseConfig:i}=t().coreStore;i&&e(e=>({coreStore:{...e.coreStore,pipelineId:i.pipeline_id,pipelineName:i.name,operationsSelected:{operation:""},outboundEventPreview:{events:[]},analyticsConsent:!1,consentAnswered:!1,isDirty:!1,apiConfig:{}}}))},discardChanges:()=>{let e=t(),{baseConfig:i}=e.coreStore;i&&e.coreStore.resetToInitial()},enterCreateMode:()=>{let i=t().coreStore.mode;e(e=>({coreStore:{...e.coreStore,...T,mode:"create",baseConfig:void 0,lastSavedConfig:void 0,saveHistory:[],analyticsConsent:e.coreStore.analyticsConsent,consentAnswered:e.coreStore.consentAnswered}})),y.dx.createEntered({fromMode:i,trigger:"enterCreateMode",resetState:!0})},enterEditMode:i=>{let a=D(i),o=t().coreStore.mode;e(e=>({coreStore:{...e.coreStore,mode:"edit",baseConfig:i,lastSavedConfig:i,saveHistory:[i],operationsSelected:{operation:a}}})),t().coreStore.hydrateFromConfig(i),y.dx.editEntered({fromMode:o,trigger:"enterEditMode",pipelineId:i.pipeline_id,pipelineName:i.name,operationType:a,hasBaseConfig:!0})},enterViewMode:async i=>{let a=D(i),o=t().coreStore.mode;e(e=>({coreStore:{...e.coreStore,mode:"view",baseConfig:i,lastSavedConfig:i,saveHistory:[i],operationsSelected:{operation:a}}}));let n=t();await n.coreStore.hydrateFromConfig(i),y.dx.viewEntered({fromMode:o,trigger:"enterViewMode",pipelineId:i.pipeline_id,pipelineName:i.name,hasBaseConfig:!0,isReadOnly:!0,operationType:a})},isDirtyComparedToBase:()=>{let{baseConfig:e,pipelineId:i,pipelineName:a}=t().coreStore;return!!e&&(i!==e.pipeline_id||a!==e.name)},setLastSavedConfig:t=>e(e=>({coreStore:{...e.coreStore,lastSavedConfig:t}})),addToSaveHistory:t=>e(e=>({coreStore:{...e.coreStore,saveHistory:[...e.coreStore.saveHistory,t],lastSavedConfig:t}})),getLastSavedConfig:()=>t().coreStore.lastSavedConfig,getSaveHistory:()=>t().coreStore.saveHistory,clearSaveHistory:()=>e(e=>({coreStore:{...e.coreStore,saveHistory:[],lastSavedConfig:void 0}})),discardToLastSaved:async()=>{let i=t(),{lastSavedConfig:a}=i.coreStore;if(a)try{await i.coreStore.hydrateFromConfig(a),e(e=>({coreStore:{...e.coreStore,isDirty:!1}}))}catch(e){throw console.error("Failed to discard to last saved config:",e),e}},hydrateSection:async(e,t)=>{try{switch(e){case"kafka":_(t);break;case"topics":case"deduplication":await v(t);break;case"join":w(t);break;case"clickhouse-connection":b(t);break;case"clickhouse-destination":await P(t);break;case"all":console.log("\uD83D\uDD04 Starting pipeline hydration..."),_(t),await v(t),b(t),await P(t),w(t),console.log("✅ Pipeline hydration completed successfully");break;default:console.warn("Unknown section for hydration: ".concat(e))}}catch(t){if(console.error("❌ Hydration failed for section '".concat(e,"':"),t),t instanceof Error&&t.message.includes("Kafka")){let{useStore:e}=await Promise.resolve().then(i.bind(i,8090)),t=e.getState();t.kafkaStore.markAsInvalidated("hydration-failed"),t.topicsStore.markAsInvalidated("hydration-failed")}throw t}},discardSection:async e=>{let i=t(),{lastSavedConfig:a}=i.coreStore;if(a)try{await i.coreStore.hydrateSection(e,a)}catch(t){throw console.error("Failed to discard section '".concat(e,"':"),t),t}else console.warn("No lastSavedConfig available for section discard")},discardSections:e=>{let i=t(),{lastSavedConfig:a}=i.coreStore;a?e.forEach(e=>{i.coreStore.hydrateSection(e,a)}):console.warn("No lastSavedConfig available for sections discard")}}}))(e,t,a),resetAllPipelineState:function(i){let a=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=t(),n=o.coreStore,s=(e=>{switch(e){case"joining":case"deduplication_joining":return 2;default:return 1}})(i);a||n.isDirty&&i!==n.operationsSelected.operation?(console.log("\uD83E\uDDF9 Complete state reset for new pipeline creation"),o.kafkaStore.resetKafkaStore(),o.topicsStore.resetTopicsStore(),o.deduplicationStore.resetDeduplicationStore(),o.joinStore.resetJoinStore(),o.clickhouseConnectionStore.resetClickhouseStore(),o.clickhouseDestinationStore.resetDestinationStore(),o.stepsStore.resetStepsStore(),o.coreStore.enterCreateMode(),o.coreStore.setOperationsSelected({operation:i}),e(e=>({topicsStore:{...e.topicsStore,topicCount:s}}))):(console.log("\uD83D\uDD04 Partial state reset - operation change only"),e(e=>({coreStore:{...e.coreStore,operationsSelected:{operation:i}},topicsStore:{...e.topicsStore,topicCount:s}})))},resetForNewPipeline:e=>{console.log("\uD83C\uDD95 Resetting state for new pipeline creation");let i=t();i.resetAllPipelineState(e,!0),k.A.remove("isDirty"),i.coreStore.clearSaveHistory()},resetFormValidationStates:()=>{console.log("\uD83D\uDD04 Resetting form validation states");let e=t();e.kafkaStore.resetValidation(),e.topicsStore.resetValidation(),e.deduplicationStore.resetValidation(),e.joinStore.resetValidation(),e.clickhouseConnectionStore.resetValidation(),e.clickhouseDestinationStore.resetValidation()},clearAllUserData:()=>{console.log("\uD83D\uDCA3 Nuclear reset - clearing ALL user data");let e=t();e.kafkaStore.resetKafkaStore(),e.topicsStore.resetTopicsStore(),e.deduplicationStore.resetDeduplicationStore(),e.joinStore.resetJoinStore(),e.clickhouseConnectionStore.resetClickhouseStore(),e.clickhouseDestinationStore.resetDestinationStore(),e.stepsStore.resetStepsStore(),e.coreStore.enterCreateMode(),k.A.remove("isDirty"),e.coreStore.clearSaveHistory()}}),{name:"app-clickhouse-pivot-store",enabled:!1}));(0,a.v)()((0,o.lt)(e=>({...F.getState(),...c})));let E=F},9985:(e,t,i)=>{i.d(t,{R:()=>s,W:()=>r});var a=i(1929),o=i(3621),n=i(1869);let s={CANCEL:"CANCEL",YES:"YES",NO:"NO"};function r(e){let{visible:t,title:i,description:r,okButtonText:c,cancelButtonText:l,onComplete:d,pendingOperation:p,criticalOperation:u}=e;return(0,a.jsxs)(o.lG,{open:t,onOpenChange:e=>{e||d(s.NO,p||"")},children:[(0,a.jsx)(o.LC,{className:"!fixed !inset-0","aria-hidden":"true",style:{backgroundColor:"rgba(17, 25, 40, 0.25)",backdropFilter:"blur(4px) saturate(30%)",WebkitBackdropFilter:"blur(4px) saturate(30%)",border:"1px solid rgba(255, 255, 255, 0.125)"}}),(0,a.jsxs)(o.Cf,{className:"sm:max-w-[500px] info-modal-container px-9 py-6 shadow-lg bg-[var(--color-background-elevation-raised-faded-2)] border border-[var(--color-border-neutral)] rounded-md",children:[(0,a.jsxs)(o.c7,{children:[(0,a.jsx)(o.L3,{className:"modal-title flex items-center gap-2 mb-8",children:i}),(0,a.jsx)(o.rr,{className:"modal-description gap-2",children:r})]}),(0,a.jsxs)(o.Es,{className:"mt-6",children:[(0,a.jsx)(n.$,{variant:"outline",className:"btn-tertiary",onClick:()=>{d(s.NO,p||"")},children:l}),(0,a.jsx)(n.$,{className:u?"btn-critical":"btn-primary",onClick:()=>{d(s.YES,p||"")},children:c})]})]})]})}}}]);