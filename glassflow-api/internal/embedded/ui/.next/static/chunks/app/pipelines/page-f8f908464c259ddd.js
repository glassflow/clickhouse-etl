(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4398],{579:(e,t,i)=>{"use strict";i.d(t,{s:()=>n});var s=i(2147);let n=()=>{let{platform:e,loading:t,error:i}=(0,s.V)(),n=(null==e?void 0:e.orchestrator)==="docker",a=(null==e?void 0:e.orchestrator)==="k8s",l=(null==e?void 0:e.orchestrator)==="local",r=(null==e?void 0:e.orchestrator)==="unknown";return{platform:e,loading:t,error:i,isDocker:n,isKubernetes:a,isLocal:l,isUnknown:r,isFeatureDisabled:s=>{if(t||i||!e)return!1;switch(s){case"docker-only":return!n;case"k8s-only":return!a;case"local-only":return!l;default:return!1}}}}},2147:(e,t,i)=>{"use strict";i.d(t,{PlatformProvider:()=>c,V:()=>o});var s=i(1929),n=i(2477),a=i(3113);let l=async()=>{try{let e=(0,a.e9)("platform"),t=await fetch(e);if(!t.ok)throw{code:t.status,message:"Failed to fetch platform info"};let i=await t.json();return{orchestrator:({docker:"docker",k8s:"k8s",kubernetes:"k8s",local:"local",unknown:"unknown"})[i.orchestrator]||"unknown",api_version:i.api_version}}catch(e){if(e.code)throw e;throw{code:500,message:e.message||"Failed to fetch platform info"}}},r=(0,n.createContext)(void 0),o=()=>{let e=(0,n.useContext)(r);if(void 0===e)throw Error("usePlatform must be used within a PlatformProvider");return e},c=e=>{let{children:t}=e,[i,a]=(0,n.useState)(null),[o,c]=(0,n.useState)(!0),[d,p]=(0,n.useState)(null),u=async()=>{try{c(!0),p(null);let e=await l();a(e)}catch(e){p(e.message||"Failed to fetch platform info"),console.error("Platform fetch error:",e)}finally{c(!1)}};return(0,n.useEffect)(()=>{u()},[]),(0,s.jsx)(r.Provider,{value:{platform:i,loading:o,error:d,refetch:u},children:t})}},4855:(e,t,i)=>{Promise.resolve().then(i.bind(i,9405))},5855:(e,t,i)=>{"use strict";i.d(t,{A:()=>s});let s={src:"/_next/static/media/loader-small.ac73cbe2.svg",height:24,width:24,blurWidth:0,blurHeight:0}},9120:(e,t,i)=>{"use strict";i.d(t,{A:()=>s});let s={src:"/_next/static/media/plus.54159413.svg",height:16,width:16,blurWidth:0,blurHeight:0}},9313:(e,t,i)=>{"use strict";i(1929),i(2477),i(8387)},9405:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>J});var s=i(1929),n=i(2477),a=i(9596),l=i(8090),r=i(7161),o=i(3534),c=i(1869);i(3621),i(1611),i(9313);var d=i(4775),p=i(8387);let u={src:"/_next/static/media/sort.1687e1f4.svg",height:16,width:16,blurWidth:0,blurHeight:0},m={src:"/_next/static/media/sort-up.8e29f883.svg",height:16,width:16,blurWidth:0,blurHeight:0},h={src:"/_next/static/media/sort-down.2f9b683d.svg",height:16,width:16,blurWidth:0,blurHeight:0},x={active:1,resuming:2,pausing:3,paused:4,stopping:5,stopped:6,failed:7};function f(e){let{data:t,columns:i,emptyMessage:l="No data found",className:r,onRowClick:o,isLoading:c=!1,onPause:d,onEdit:f,onRename:g,onDelete:v}=e,j=i.map(e=>e.width||"1fr").join(" "),[b,w]=(0,n.useState)(null),[y,N]=(0,n.useState)(null),k=(0,n.useMemo)(()=>b&&y?[...t].sort((e,t)=>{let i,s;if(b.includes(".")){let n=b.split(".");i=n.reduce((e,t)=>null==e?void 0:e[t],e),s=n.reduce((e,t)=>null==e?void 0:e[t],t)}else i=e[b],s=t[b];if(null==i&&null==s)return 0;if(null==i)return"asc"===y?1:-1;if(null==s)return"asc"===y?-1:1;if("status"===b){let e=x[String(i).toLowerCase()]||999,t=x[String(s).toLowerCase()]||999;return"asc"===y?e-t:t-e}if("string"==typeof i&&"string"==typeof s){let e=i.toLowerCase().localeCompare(s.toLowerCase());return"asc"===y?e:-e}if("number"==typeof i&&"number"==typeof s)return"asc"===y?i-s:s-i;if("created_at"===b){let e=new Date(i).getTime(),t=new Date(s).getTime();return"asc"===y?e-t:t-e}let n=String(i),a=String(s),l=n.toLowerCase().localeCompare(a.toLowerCase());return"asc"===y?l:-l}):t,[t,b,y]),_=e=>e.sortable?b!==(e.sortKey||e.key)?(0,s.jsx)(a.default,{src:u,alt:"Sort",width:14,height:14,className:"ml-1 text-gray-400"}):"asc"===y?(0,s.jsx)(a.default,{src:m,alt:"Sort Ascending",width:14,height:14,className:"ml-1"}):(0,s.jsx)(a.default,{src:h,alt:"Sort Descending",width:14,height:14,className:"ml-1"}):null;return c?(0,s.jsxs)("div",{className:(0,p.cn)("table-container",r),children:[(0,s.jsx)("div",{className:"table-header",children:(0,s.jsx)("div",{className:"table-header-row",style:{gridTemplateColumns:j},children:i.map(e=>(0,s.jsx)("div",{className:(0,p.cn)("table-header-cell",e.align&&"text-".concat(e.align),e.sortable&&"cursor-pointer select-none"),children:(0,s.jsxs)("div",{className:(0,p.cn)("flex items-center","center"===e.align&&"justify-center","right"===e.align&&"justify-end",(!e.align||"left"===e.align)&&"justify-start"),children:[e.header,_(e)]})},e.key))})}),(0,s.jsx)("div",{className:"table-body",children:(0,s.jsx)("div",{className:"table-cell-empty",children:"Loading..."})})]}):(0,s.jsxs)("div",{className:(0,p.cn)("table-container",r),children:[(0,s.jsx)("div",{className:"table-header",children:(0,s.jsx)("div",{className:"table-header-row",style:{gridTemplateColumns:j},children:i.map(e=>(0,s.jsx)("div",{className:(0,p.cn)("table-header-cell",e.align&&"text-".concat(e.align),e.sortable&&"cursor-pointer select-none hover:opacity-70"),onClick:()=>(e=>{if(!e.sortable)return;let t=e.sortKey||e.key;b===t?"asc"===y?N("desc"):"desc"===y&&(N(null),w(null)):(w(t),N("asc"))})(e),children:(0,s.jsxs)("div",{className:(0,p.cn)("flex items-center","center"===e.align&&"justify-center","right"===e.align&&"justify-end",(!e.align||"left"===e.align)&&"justify-start"),children:[e.header,_(e)]})},e.key))})}),(0,s.jsxs)("div",{className:"table-body",children:[k.map((e,t)=>(0,s.jsx)("div",{className:(0,p.cn)("table-row",o&&"cursor-pointer"),onClick:()=>null==o?void 0:o(e),style:{gridTemplateColumns:j},children:i.map(t=>(0,s.jsx)("div",{className:(0,p.cn)("table-cell",t.align&&"text-".concat(t.align)),"data-label":t.header,children:t.render?t.render(e):e[t.key]},t.key))},t)),0===k.length&&(0,s.jsx)("div",{className:"table-row",style:{gridTemplateColumns:j},children:(0,s.jsx)("div",{className:"table-cell-empty",children:l})})]})]})}let g=(0,i(3747).A)("EllipsisVertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]]);var v=i(5555);let j={src:"/_next/static/media/play-white.be5817b4.svg",height:16,width:17,blurWidth:0,blurHeight:0};var b=i(302),w=i(6696),y=i(7924),N=i(2526),k=i(1240);let _=e=>{let{pipelineStatus:t,isLoading:i=!1,onStop:l,onResume:r,onEdit:o,onRename:d,onTerminate:u,onDelete:m,onDownload:h,disabled:x=!1,onOpen:f}=e,[_,C]=(0,n.useState)(!1),S=(0,v.zg)("stop",t),P=(0,v.zg)("resume",t);(0,v.zg)("edit",t);let E=(0,v.zg)("rename",t);(0,v.zg)("terminate",t);let L=(0,v.zg)("delete",t),R="active"===t&&!S.isDisabled,D=("stopped"===t||"terminated"===t)&&!P.isDisabled,F="stopped"!==t&&"terminated"!==t&&"terminating"!==t,T=(e,t,i)=>{e.stopPropagation(),!i&&t&&t(),C(!1)};return(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)(c.$,{variant:"ghost",size:"sm",className:(0,p.cn)("h-8 w-8 p-0 hover:bg-muted",(x||i)&&"opacity-50 cursor-not-allowed"),onClick:e=>{e.stopPropagation(),f&&f(e),x||i||C(!_)},disabled:x||i,children:(0,s.jsx)(g,{className:"h-4 w-4"})}),_&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"fixed inset-0 z-10",onClick:e=>{e.stopPropagation(),C(!1)}}),(0,s.jsxs)("div",{className:"absolute right-0 top-full mt-1 z-20 w-48 bg-[var(--color-background-regular)] border border-[var(--color-border-neutral)] rounded-md shadow-lg p-1 min-w-[160px] sm:min-w-[180px]",onClick:e=>e.stopPropagation(),children:[R&&l&&(0,s.jsxs)(c.$,{variant:"ghost",className:(0,p.cn)("flex justify-start items-center w-full px-3 py-2 text-sm transition-colors",S.isDisabled||i?"text-muted-foreground cursor-not-allowed opacity-50":"text-foreground hover:bg-[var(--color-background-neutral-faded)]"),onClick:e=>T(e,l,S.isDisabled||i),disabled:S.isDisabled||i,title:S.disabledReason,children:[(0,s.jsx)(a.default,{src:k.A,alt:"Stop",width:16,height:16,className:"filter brightness-100 group-hover:brightness-0"}),(0,s.jsx)("span",{className:"truncate",children:"Stop"})]}),D&&r&&(0,s.jsxs)(c.$,{variant:"ghost",className:(0,p.cn)("flex justify-start items-center w-full px-3 py-2 text-sm transition-colors",P.isDisabled||i?"text-muted-foreground cursor-not-allowed opacity-50":"text-foreground hover:bg-[var(--color-background-neutral-faded)]"),onClick:e=>T(e,r,P.isDisabled||i),disabled:P.isDisabled||i,title:P.disabledReason,children:[(0,s.jsx)(a.default,{src:j,alt:"Resume",width:16,height:16}),(0,s.jsx)("span",{className:"truncate",children:"Resume"})]}),d&&(0,s.jsxs)(c.$,{variant:"ghost",className:(0,p.cn)("flex justify-start items-center w-full px-3 py-2 text-sm transition-colors",E.isDisabled||i?"text-muted-foreground cursor-not-allowed opacity-50":"text-foreground hover:bg-[var(--color-background-neutral-faded)]"),onClick:e=>{e.stopPropagation(),T(e,d,E.isDisabled||i)},disabled:E.isDisabled||i,title:E.disabledReason,children:[(0,s.jsx)(a.default,{src:b.A,alt:"Rename",width:16,height:16,className:"filter brightness-100 group-hover:brightness-0"}),(0,s.jsx)("span",{className:"truncate",children:"Rename"})]}),F&&u&&(0,s.jsxs)(c.$,{variant:"ghost",className:(0,p.cn)("flex justify-start items-center w-full px-3 py-2 text-sm transition-colors",i?"text-muted-foreground cursor-not-allowed opacity-50":"text-destructive hover:bg-[var(--color-background-neutral-faded)]"),onClick:e=>{e.stopPropagation(),T(e,u,i)},disabled:i,title:"Immediately terminate pipeline",children:[(0,s.jsx)(a.default,{src:N.A,alt:"Terminate",width:16,height:16,className:"filter brightness-100 group-hover:brightness-0"}),(0,s.jsx)("span",{className:"truncate",children:"Terminate"})]}),m&&(0,s.jsxs)(c.$,{variant:"ghost",className:(0,p.cn)("flex justify-start items-center w-full px-3 py-2 text-sm transition-colors",L.isDisabled||i?"text-muted-foreground cursor-not-allowed opacity-50":"text-destructive hover:bg-[var(--color-background-neutral-faded)]"),onClick:e=>{e.stopPropagation(),T(e,m,L.isDisabled||i)},disabled:L.isDisabled||i,title:L.disabledReason,children:[(0,s.jsx)(a.default,{src:w.A,alt:"Delete",width:16,height:16,className:"filter brightness-100 group-hover:brightness-0"}),(0,s.jsx)("span",{className:"truncate",children:"Delete"})]}),h&&(0,s.jsxs)(c.$,{variant:"ghost",className:(0,p.cn)("flex justify-start items-center w-full px-3 py-2 text-sm transition-colors","text-foreground hover:bg-[var(--color-background-neutral-faded)]"),onClick:e=>{e.stopPropagation(),T(e,h,!1)},disabled:!1,title:"Download configuration",children:[(0,s.jsx)(a.default,{src:y.A,alt:"Download",width:16,height:16,className:"filter brightness-100 group-hover:brightness-0"}),(0,s.jsx)("span",{className:"truncate",children:"Download"})]})]})]})]})};var C=i(8821),S=i(5855);function P(e){let{pipelines:t,healthMap:i,onStop:n,onResume:l,onEdit:r,onRename:c,onTerminate:d,onDelete:u,onRowClick:m,isPipelineLoading:h,getPipelineOperation:x}=e;return 0===t.length?(0,s.jsx)("div",{className:"flex flex-col items-center justify-center py-12 px-4",children:(0,s.jsx)("div",{className:"text-center",children:(0,s.jsx)("p",{className:"text-muted-foreground text-lg",children:"No pipelines found. Create your first pipeline to get started."})})}):(0,s.jsx)("div",{className:"space-y-4",children:t.map(e=>{var t,i,f,g,v;let j,b=(null==h?void 0:h(e.pipeline_id))||!1,w=null==x?void 0:x(e.pipeline_id);return(0,s.jsxs)("div",{className:(0,p.cn)("bg-background border border-[var(--color-border-neutral)] rounded-lg p-4 shadow-sm",m&&"cursor-pointer hover:bg-muted/50 transition-colors"),onClick:()=>null==m?void 0:m(e),children:[(0,s.jsxs)("div",{className:"flex items-start justify-between mb-3",children:[(0,s.jsx)("div",{className:"flex-1 min-w-0",children:(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[b&&(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[(0,s.jsx)(a.default,{src:S.A,alt:"Loading",width:16,height:16,className:"animate-spin"}),(0,s.jsxs)("span",{className:"text-xs text-blue-600",children:["pause"===w&&"Pausing...","resume"===w&&"Resuming...","delete"===w&&"Deleting...","rename"===w&&"Renaming...","edit"===w&&"Pausing..."]})]}),(0,s.jsx)("h3",{className:"font-semibold text-foreground truncate",children:e.name})]})}),(0,s.jsx)("div",{className:"ml-3 flex-shrink-0",children:(0,s.jsx)(_,{pipelineStatus:e.status||"no_configuration",isLoading:b,onStop:n?()=>n(e):void 0,onResume:l?()=>l(e):void 0,onEdit:r?()=>r(e):void 0,onRename:c?()=>c(e):void 0,onTerminate:d?()=>d(e):void 0,onDelete:u?()=>u(e):void 0})})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("span",{className:"text-sm text-muted-foreground",children:"Transformation"}),(0,s.jsx)("span",{className:"text-sm font-medium",children:e.transformation_type||"None"})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("span",{className:"text-sm text-muted-foreground",children:"Status"}),(0,s.jsx)(o.E,{variant:((e,t)=>{switch(e){case C.zO.active:return"success";case C.zO.paused:case C.zO.pausing:case C.zO.stopping:return"warning";case C.zO.stopped:return"secondary";case C.zO.failed:return"error";default:return"default"}})(e.status||"no_configuration",e.pipeline_id),children:(j=e.status||"no_configuration",e.pipeline_id,j||"No Configuration")})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("span",{className:"text-sm text-muted-foreground",children:"Events in DLQ"}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(o.E,{variant:0===((null==(t=e.dlq_stats)?void 0:t.unconsumed_messages)||0)?"success":10>((null==(i=e.dlq_stats)?void 0:i.unconsumed_messages)||0)?"warning":"error",children:((null==(f=e.dlq_stats)?void 0:f.unconsumed_messages)||0).toLocaleString()}),((null==(g=e.dlq_stats)?void 0:g.total_messages)||0)>0&&(0,s.jsxs)("span",{className:"text-xs text-gray-500",children:["of ",((null==(v=e.dlq_stats)?void 0:v.total_messages)||0).toLocaleString()]})]})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("span",{className:"text-sm text-muted-foreground",children:"Stability"}),(0,s.jsx)(o.E,{variant:"stable"===(e.health_status||"stable")?"success":"error",children:"stable"===(e.health_status||"stable")?"Stable":"Unstable"})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("span",{className:"text-sm text-muted-foreground",children:"Created"}),(0,s.jsx)("span",{className:"text-sm",children:new Date(e.created_at).toLocaleDateString()})]})]})]},e.pipeline_id)})})}let E=e=>{let{className:t,size:i=16}=e;return(0,s.jsx)("svg",{width:i,height:i,viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:t,children:(0,s.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M7.99984 2.66797C8.36803 2.66797 8.6665 2.96645 8.6665 3.33464V7.33464H12.6665C13.0347 7.33464 13.3332 7.63311 13.3332 8.0013C13.3332 8.36949 13.0347 8.66797 12.6665 8.66797H8.6665V12.668C8.6665 13.0362 8.36803 13.3346 7.99984 13.3346C7.63165 13.3346 7.33317 13.0362 7.33317 12.668V8.66797H3.33317C2.96498 8.66797 2.6665 8.36949 2.6665 8.0013C2.6665 7.63311 2.96498 7.33464 3.33317 7.33464H7.33317V3.33464C7.33317 2.96645 7.63165 2.66797 7.99984 2.66797Z",fill:"currentColor"})})},L=e=>{let{className:t,size:i=20}=e;return(0,s.jsx)("svg",{width:i,height:i,viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:t,children:(0,s.jsx)("path",{d:"M2.5 5H17.5M5 10H15M7.5 15H12.5",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})})};var R=i(9985),D=i(9507),F=i(2856),T=i(3061);let A=()=>(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("span",{className:"text-sm",children:"To edit the pipeline, it must be paused. Any events currently in the queue will be processed before pausing, which may take some time."}),(0,s.jsx)("br",{}),(0,s.jsx)("br",{}),(0,s.jsx)("span",{className:"text-sm",children:"Are you sure you want to proceed with editing?"})]}),z={title:"Edit Pipeline Configuration",description:(0,s.jsx)(A,{}),okButtonText:"Edit Pipeline",cancelButtonText:"Cancel"},U=function(e){let{visible:t,onOk:i,onCancel:n}=e;return(0,s.jsx)(R.W,{visible:t,title:z.title,description:(0,s.jsx)(A,{}),okButtonText:z.okButtonText,cancelButtonText:z.cancelButtonText,onComplete:e=>{e===R.R.YES?i():n()}})};function O(e){let{isOpen:t,onClose:i,filters:a,onFiltersChange:l,anchorEl:r}=e,o=(0,n.useRef)(null);return((0,n.useEffect)(()=>{if(!t)return;let e=e=>{o.current&&!o.current.contains(e.target)&&r&&!r.contains(e.target)&&i()};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[t,i,r]),t)?(0,s.jsx)("div",{ref:o,className:"absolute z-50 w-64 rounded-lg shadow-lg",style:{top:r?"".concat(r.getBoundingClientRect().bottom+4,"px"):void 0,left:r?"".concat(r.getBoundingClientRect().left,"px"):void 0,backgroundColor:"var(--color-background-elevation-raised-faded-2)"},children:(0,s.jsxs)("div",{className:"p-4 space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-sm font-semibold mb-3",style:{color:"var(--color-foreground-neutral)"},children:"Status"}),(0,s.jsx)("div",{className:"space-y-2",children:["active","paused","stopped","failed"].map(e=>(0,s.jsxs)("label",{className:"flex items-center gap-3 cursor-pointer p-2 rounded transition-all duration-200 hover:opacity-80",children:[(0,s.jsxs)("div",{className:"relative flex items-center justify-center",children:[(0,s.jsx)("input",{type:"checkbox",checked:a.status.includes(e),onChange:()=>(e=>{let t=a.status.includes(e)?a.status.filter(t=>t!==e):[...a.status,e];l({...a,status:t})})(e),className:"peer sr-only"}),(0,s.jsx)("div",{className:"w-5 h-5 rounded border-2 transition-all duration-200 flex items-center justify-center",style:{borderColor:a.status.includes(e)?"transparent":"var(--color-border-regular)",background:a.status.includes(e)?"linear-gradient(134deg, #ffa959 18.07%, #e7872e 76.51%)":"transparent"},children:a.status.includes(e)&&(0,s.jsx)("svg",{width:"12",height:"12",viewBox:"0 0 12 12",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,s.jsx)("path",{d:"M2 6L5 9L10 3",stroke:"black",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})})]}),(0,s.jsx)("span",{className:"text-sm",style:{color:"var(--color-foreground-neutral)"},children:e.charAt(0).toUpperCase()+e.slice(1)})]},e))})]}),(0,s.jsx)("div",{className:"border-t",style:{borderColor:"var(--color-foreground-neutral-faded)"}}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-sm font-semibold mb-3",style:{color:"var(--color-foreground-neutral)"},children:"Health"}),(0,s.jsx)("div",{className:"space-y-2",children:["stable","unstable"].map(e=>(0,s.jsxs)("label",{className:"flex items-center gap-3 cursor-pointer p-2 rounded transition-all duration-200 hover:opacity-80",children:[(0,s.jsxs)("div",{className:"relative flex items-center justify-center",children:[(0,s.jsx)("input",{type:"checkbox",checked:a.health.includes(e),onChange:()=>(e=>{let t=a.health.includes(e)?a.health.filter(t=>t!==e):[...a.health,e];l({...a,health:t})})(e),className:"peer sr-only"}),(0,s.jsx)("div",{className:"w-5 h-5 rounded border-2 transition-all duration-200 flex items-center justify-center",style:{borderColor:a.health.includes(e)?"transparent":"var(--color-border-regular)",background:a.health.includes(e)?"linear-gradient(134deg, #ffa959 18.07%, #e7872e 76.51%)":"transparent"},children:a.health.includes(e)&&(0,s.jsx)("svg",{width:"12",height:"12",viewBox:"0 0 12 12",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,s.jsx)("path",{d:"M2 6L5 9L10 3",stroke:"black",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})})]}),(0,s.jsx)("span",{className:"text-sm",style:{color:"var(--color-foreground-neutral)"},children:e.charAt(0).toUpperCase()+e.slice(1)})]},e))})]})]})}):null}function I(e){let{label:t,values:i,onRemove:n,onClick:a,className:l}=e;if(0===i.length)return null;let r="".concat(t,": ").concat(i.join(", "));return(0,s.jsxs)("div",{className:(0,p.cn)("inline-flex items-center gap-2 px-3 py-2 rounded-lg","bg-[var(--color-background-elevation-raised-faded)] text-[var(--color-foreground-neutral)] text-sm font-medium","transition-all duration-200",a&&"cursor-pointer hover:opacity-90",l),onClick:a,style:{backgroundColor:"var(--color-background-elevation-raised-faded)",color:"var(--color-foreground-neutral)"},children:[(0,s.jsx)("span",{children:r}),(0,s.jsx)("button",{onClick:e=>{e.stopPropagation(),n()},className:"ml-1 hover:opacity-70 rounded p-0.5 transition-opacity duration-200","aria-label":"Remove filter",children:(0,s.jsx)("svg",{width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,s.jsx)("path",{d:"M10.5 3.5L3.5 10.5M3.5 3.5L10.5 10.5",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})})})]})}var B=i(4493),H=i(1475),M=i(579),W=i(1296),q=i(1224);function $(e){let{pipelines:t,onRefresh:i,onUpdatePipelineStatus:u,onUpdatePipelineName:m,onRemovePipeline:h}=e,x=(0,d.U)(),{coreStore:g,resetAllPipelineState:j}=(0,l.useStore)(),{pipelineId:b,setPipelineId:w}=g,[y,N]=(0,n.useState)("active"),[k,C]=(0,n.useState)(null),{isRenameModalVisible:A,selectedPipeline:z,openRenameModal:$,closeRenameModal:V}=(0,B.h_)(),{isTerminateModalVisible:K,selectedPipeline:J,openTerminateModal:Q,closeTerminateModal:Y}=(0,B.er)(),{isStopModalVisible:Z,selectedPipeline:G,openStopModal:X,closeStopModal:ee}=(0,B.xJ)(),{isEditModalVisible:et,selectedPipeline:ei,openEditModal:es,closeEditModal:en}=(0,B.lB)(),{isFeatureDisabled:ea,isDocker:el,isLocal:er}=(0,M.s)(),[eo,ec]=(0,n.useState)(!1),[ed,ep]=(0,n.useState)(!1),[eu,em]=(0,n.useState)({status:[],health:[]}),[eh,ex]=(0,n.useState)(!1),ef=n.useRef(null),[eg,ev]=(0,n.useState)({}),ej=(0,r.useRouter)(),[eb,ew]=(0,n.useState)(!1),ey=(0,n.useMemo)(()=>t.map(e=>e.pipeline_id),[t]),eN=(0,W.RP)(ey),ek=(0,W.c7)();(0,W.qs)(ey);let e_=(e,t)=>{ev(i=>({...i,[e]:{isLoading:!0,operation:t}}))},eC=e=>{ev(t=>({...t,[e]:{isLoading:!1,operation:null}}))},eS=e=>{var t;return(null==(t=eg[e])?void 0:t.isLoading)||!1},eP=e=>{var t;return(null==(t=eg[e])?void 0:t.operation)||null},eE=e=>eN[e.pipeline_id]||e.status||"active",eL=(0,n.useMemo)(()=>t.filter(e=>{if(eu.status.length>0){let t=eE(e);if(!eu.status.includes(t))return!1}if(eu.health.length>0){let t=e.health_status||"stable";if(!eu.health.includes(t))return!1}return!0}),[t,eu,eN]),eR=(0,n.useMemo)(()=>(0,v.vF)(t),[t]),eD=(0,n.useMemo)(()=>(!!el||!!er)&&eR>0,[el,er,eR]);(0,n.useEffect)(()=>{x.page.pipelines({})},[]),(0,n.useEffect)(()=>{let e=()=>{ec(window.innerWidth<=768)};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]);let eF=[{key:"name",header:"Name",width:"2fr",sortable:!0,render:e=>{let t=eS(e.pipeline_id);return eP(e.pipeline_id),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[t&&(0,s.jsx)("div",{className:"flex items-center gap-1",children:(0,s.jsx)(a.default,{src:S.A,alt:"Loading",width:16,height:16,className:"animate-spin"})}),(0,s.jsx)("span",{className:"font-medium",children:e.name})]})}},{key:"operations",header:"Transformation",width:"2fr",sortable:!0,sortKey:"transformation_type",render:e=>e.transformation_type||"None"},{key:"health",header:"Health",width:"1fr",align:"left",sortable:!0,sortKey:"health_status",render:e=>{let t=e.health_status||"stable";return e.dlq_stats,(0,s.jsxs)("div",{className:"flex flex-row items-center justify-start gap-2 text-content",children:["stable"===t?(0,s.jsx)("div",{className:"w-3 h-3 rounded-full bg-green-500 items-center"}):(0,s.jsx)("div",{className:"w-3 h-3 rounded-full bg-red-500 items-center"}),"stable"===t?"Stable":"Unstable"]})}},{key:"dlqStats",header:"Events in DLQ",width:"1fr",align:"left",sortable:!0,sortKey:"dlq_stats.unconsumed_messages",render:e=>{let t=e.dlq_stats,i=(null==t?void 0:t.unconsumed_messages)||0;return(0,s.jsx)("div",{className:"flex flex-row items-center justify-start gap-1 text-content",children:(0,p.ZV)(i)})}},{key:"status",header:"Status",width:"1fr",align:"center",sortable:!0,render:e=>{let t=eE(e);return(0,s.jsx)("div",{className:"flex flex-row items-center justify-center gap-2 text-content w-full",children:(0,s.jsx)(o.E,{className:"rounded-xl my-2 mx-4",variant:(e=>{switch(e){case"active":return"success";case"paused":case"pausing":case"resuming":case"stopping":case"terminating":return"warning";case"stopped":case"terminated":return"secondary";case"failed":return"error";default:return"default"}})(t),children:(e=>{switch(e){case"active":return"Active";case"pausing":return"Pausing...";case"paused":return"Paused";case"resuming":return"Resuming...";case"stopping":return"Stopping...";case"stopped":return"Stopped";case"terminating":return"Terminating...";case"terminated":return"Terminated";case"failed":return"Failed";default:return"Unknown status"}})(t)})})}},{key:"created_at",header:"Created",width:"1.5fr",align:"left",sortable:!0,render:e=>(0,s.jsx)("div",{className:"flex flex-row items-center justify-start text-content",children:(0,p.zO)(e.created_at)})},{key:"actions",header:"Actions",align:"center",width:"1fr",render:e=>{let t=eE(e);return(0,s.jsx)(_,{pipelineStatus:t,isLoading:eS(e.pipeline_id),onStop:()=>eT(e),onResume:()=>eA(e),onEdit:()=>ez(e),onRename:()=>eU(e),onTerminate:()=>eO(e),onDelete:()=>eI(e),onDownload:()=>eB(e)})}}],eT=e=>{X(e)},eA=async e=>{x.pipeline.resumeClicked({pipelineId:e.pipeline_id,pipelineName:e.name,currentStatus:e.status}),e_(e.pipeline_id,"resume");try{ek.reportResume(e.pipeline_id),await (0,H.WQ)(e.pipeline_id),x.pipeline.resumeSuccess({pipelineId:e.pipeline_id,pipelineName:e.name})}catch(t){console.error("Failed to resume pipeline:",t),x.pipeline.resumeFailed({pipelineId:e.pipeline_id,pipelineName:e.name,error:t instanceof Error?t.message:"Unknown error"}),ek.revertOptimisticUpdate(e.pipeline_id,"stopped")}finally{eC(e.pipeline_id)}},ez=e=>{es(e)},eU=e=>{$(e)},eO=e=>{Q(e)},eI=async e=>{x.pipeline.deleteClicked({pipelineId:e.pipeline_id,pipelineName:e.name,currentStatus:e.status,processEvents:!1}),e_(e.pipeline_id,"delete");try{ek.reportDelete(e.pipeline_id),await (0,H.gP)(e.pipeline_id),x.pipeline.deleteSuccess({pipelineId:e.pipeline_id,pipelineName:e.name,processEvents:!1}),null==h||h(e.pipeline_id),setTimeout(()=>null==i?void 0:i(),1e3)}catch(i){console.error("Failed to delete pipeline:",i),x.pipeline.deleteFailed({pipelineId:e.pipeline_id,pipelineName:e.name,error:i instanceof Error?i.message:"Unknown error",processEvents:!1});let t=e.status||"active";ek.revertOptimisticUpdate(e.pipeline_id,t)}finally{eC(e.pipeline_id)}},eB=async e=>{try{await (0,q.Tt)(e)}catch(e){console.error("Failed to download pipeline configuration:",e)}};return(0,s.jsxs)("div",{className:"flex flex-col w-full gap-6",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between w-full flex-wrap gap-3",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3 flex-wrap",children:[(0,s.jsx)("h1",{className:"text-xl sm:text-2xl font-semibold",children:"Pipelines"}),(0,s.jsxs)("button",{ref:ef,onClick:()=>ex(!eh),className:"p-2 hover:opacity-70 rounded-lg transition-opacity duration-200 relative","aria-label":"Filter pipelines",children:[(0,s.jsx)(L,{size:20,className:"text-gray-600"}),(eu.status.length>0||eu.health.length>0)&&(0,s.jsx)("span",{className:"absolute top-1 right-1 w-2 h-2 rounded-full",style:{background:"linear-gradient(134deg, #ffa959 18.07%, #e7872e 76.51%)"}})]}),eu.status.length>0&&(0,s.jsx)(I,{label:"Status",values:eu.status.map(e=>e.charAt(0).toUpperCase()+e.slice(1)),onRemove:()=>{em({...eu,status:[]})},onClick:()=>ex(!0)}),eu.health.length>0&&(0,s.jsx)(I,{label:"Health",values:eu.health.map(e=>e.charAt(0).toUpperCase()+e.slice(1)),onRemove:()=>{em({...eu,health:[]})},onClick:()=>ex(!0)})]}),(0,s.jsxs)(c.$,{variant:"default",className:"btn-primary btn-text",onClick:()=>{if(eD)return void ep(!0);ej.push("/home")},children:[(0,s.jsx)(E,{className:"action-icon",size:16}),"New Pipeline"]})]}),(0,s.jsx)(O,{isOpen:eh,onClose:()=>ex(!1),filters:eu,onFiltersChange:em,anchorEl:ef.current}),(0,s.jsx)("div",{className:"hidden md:block",children:(0,s.jsx)(f,{data:eL,columns:eF,emptyMessage:"No pipelines found. Create your first pipeline to get started.",onRowClick:e=>ej.push("/pipelines/".concat(e.pipeline_id))})}),(0,s.jsx)("div",{className:"md:hidden",children:(0,s.jsx)(P,{pipelines:eL,healthMap:eN,onStop:eT,onResume:eA,onEdit:ez,onRename:eU,onTerminate:eO,onDelete:eI,onRowClick:e=>ej.push("/pipelines/".concat(e.pipeline_id)),isPipelineLoading:eS,getPipelineOperation:eP})}),(0,s.jsx)(D.A,{visible:Z,onOk:async()=>{if(G){x.pipeline.pauseClicked({pipelineId:G.pipeline_id,pipelineName:G.name,currentStatus:G.status}),ee(),e_(G.pipeline_id,"stop");try{ek.reportStop(G.pipeline_id),await (0,H.JP)(G.pipeline_id),x.pipeline.pauseSuccess({pipelineId:G.pipeline_id,pipelineName:G.name})}catch(e){console.error("Failed to stop pipeline:",e),x.pipeline.pauseFailed({pipelineId:G.pipeline_id,pipelineName:G.name,error:e instanceof Error?e.message:"Unknown error"}),ek.revertOptimisticUpdate(G.pipeline_id,"active")}finally{eC(G.pipeline_id)}}},onCancel:()=>{ee()}}),(0,s.jsx)(T.A,{visible:A,currentName:(null==z?void 0:z.name)||"",onOk:async e=>{if(!z||!e)return;x.pipeline.renameClicked({pipelineId:z.pipeline_id,pipelineName:z.name,newName:e}),V(),e_(z.pipeline_id,"rename");let t=z.name;null==m||m(z.pipeline_id,e);try{await (0,H.lY)(z.pipeline_id,e),x.pipeline.renameSuccess({pipelineId:z.pipeline_id,oldName:t,newName:e})}catch(i){console.error("Failed to rename pipeline:",i),x.pipeline.renameFailed({pipelineId:z.pipeline_id,pipelineName:t,newName:e,error:i instanceof Error?i.message:"Unknown error"}),null==m||m(z.pipeline_id,t)}finally{eC(z.pipeline_id)}},onCancel:()=>{V()}}),(0,s.jsx)(U,{visible:et,onOk:async()=>{if(ei){x.pipeline.editClicked({pipelineId:ei.pipeline_id,pipelineName:ei.name,currentStatus:ei.status}),en(),e_(ei.pipeline_id,"edit");try{"active"===ei.status?(null==u||u(ei.pipeline_id,"stopping"),await (0,H.JP)(ei.pipeline_id),null==u||u(ei.pipeline_id,"stopped")):console.log("Pipeline already stopped, proceeding to edit:",ei.pipeline_id),x.pipeline.editSuccess({pipelineId:ei.pipeline_id,pipelineName:ei.name,wasPausedForEdit:"active"===ei.status}),ej.push("/pipelines/".concat(ei.pipeline_id))}catch(e){console.error("Failed to prepare pipeline for edit:",e),x.pipeline.editFailed({pipelineId:ei.pipeline_id,pipelineName:ei.name,error:e instanceof Error?e.message:"Unknown error",currentStatus:ei.status}),null==u||u(ei.pipeline_id,ei.status||"no_configuration")}finally{eC(ei.pipeline_id)}}},onCancel:()=>{en()}}),(0,s.jsx)(F.A,{visible:K,onOk:async()=>{if(J){x.pipeline.deleteClicked({pipelineId:J.pipeline_id,pipelineName:J.name,currentStatus:J.status,processEvents:!1}),Y(),e_(J.pipeline_id,"delete");try{ek.reportTerminate(J.pipeline_id),await (0,H.sw)(J.pipeline_id),x.pipeline.deleteSuccess({pipelineId:J.pipeline_id,pipelineName:J.name,processEvents:!1})}catch(t){console.error("Failed to terminate pipeline:",t),x.pipeline.deleteFailed({pipelineId:J.pipeline_id,pipelineName:J.name,error:t instanceof Error?t.message:"Unknown error",processEvents:!1});let e=J.status||"active";ek.revertOptimisticUpdate(J.pipeline_id,e)}finally{eC(J.pipeline_id)}}},onCancel:()=>{Y()}}),(0,s.jsx)(R.W,{visible:ed,title:"Pipeline Limit Reached",description:"Only one active pipeline is allowed on ".concat(el?"Docker":"Local"," version. To create a new pipeline, you must first terminate or delete any currently active pipelines."),okButtonText:"Manage Pipelines",cancelButtonText:"Cancel",onComplete:e=>{ep(!1),R.R.YES}})]})}var V=i(9120);function K(){let e=(0,d.U)(),t=(0,r.useRouter)();return(0,n.useEffect)(()=>{e.page.pipelines({})},[]),(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center min-h-[calc(100vh-200px)] gap-6",children:[(0,s.jsxs)("div",{className:"flex flex-col items-center gap-3 text-center",children:[(0,s.jsx)("h2",{className:"text-2xl font-semibold text-foreground",children:"There is no pipeline to display"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"Create your first pipeline to get started"})]}),(0,s.jsxs)(c.$,{variant:"outline",className:"btn-primary flex items-center gap-2",onClick:()=>{t.push("/home")},children:[(0,s.jsx)(a.default,{src:V.A,alt:"New Pipeline",width:16,height:16,className:"filter brightness-0"}),"New Pipeline"]})]})}function J(){let[e,t]=(0,n.useState)([]),[i,a]=(0,n.useState)(!0),l=(0,n.useCallback)(async()=>{try{a(!0);let e=await (0,H.Cz)();t(e)}catch(e){console.error("Failed to fetch pipelines:",e)}finally{a(!1)}},[]),r=(0,n.useCallback)((e,i)=>{t(t=>t.map(t=>t.pipeline_id===e?{...t,status:i,state:i}:t))},[]),o=(0,n.useCallback)((e,i)=>{t(t=>t.map(t=>t.pipeline_id===e?{...t,name:i}:t))},[]),c=(0,n.useCallback)(e=>{t(t=>t.filter(t=>t.pipeline_id!==e))},[]);return((0,n.useEffect)(()=>{l()},[l]),i)?(0,s.jsx)("div",{className:"container mx-auto p-4",children:(0,s.jsx)("div",{className:"flex flex-col items-center justify-start min-h-[calc(100vh-200px)] gap-12",children:(0,s.jsx)("div",{className:"text-center",children:"Loading pipelines..."})})}):(0,s.jsx)("div",{className:"container mx-auto p-4",children:(0,s.jsx)("div",{className:"flex flex-col items-center justify-start min-h-[calc(100vh-200px)] gap-12",children:e.length>0?(0,s.jsx)($,{pipelines:e,onRefresh:l,onUpdatePipelineStatus:r,onUpdatePipelineName:o,onRemovePipeline:c}):(0,s.jsx)(K,{})})})}}},e=>{e.O(0,[2270,2765,3878,5037,6460,1279,3736,3888,5704,7358],()=>e(e.s=4855)),_N_E=e.O()}]);