(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5332],{132:(e,t,l)=>{"use strict";l.d(t,{PipelineNotFound:()=>r});var i=l(1929),n=l(2477),a=l(1869),s=l(7161),o=l(4775);function r(e){let{pipelineId:t}=e,l=(0,o.U)(),r=(0,s.useRouter)();return(0,n.useEffect)(()=>{l.page.pipelines({})},[l]),(0,i.jsxs)("div",{className:"flex flex-col items-center justify-center min-h-[calc(100vh-200px)] gap-6",children:[(0,i.jsxs)("div",{className:"flex flex-col items-center gap-3 text-center",children:[(0,i.jsx)("h2",{className:"text-2xl font-semibold text-foreground",children:"Pipeline not found"}),(0,i.jsxs)("p",{className:"text-sm text-content",children:["Pipeline with ID ",(0,i.jsx)("span",{className:"font-mono bg-muted px-2 py-1 rounded",children:t})," does not exist or has been deleted."]})]}),(0,i.jsx)(a.$,{variant:"outline",className:"btn-primary flex items-center gap-2",onClick:()=>{r.push("/pipelines")},children:"← Back to Pipelines"})]})}},869:(e,t,l)=>{"use strict";l.d(t,{default:()=>ef});var i=l(1929),n=l(2477),a=l(1869),s=l(3534),o=l(4903);let r=(0,l(3747).A)("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);var c=l(2856),d=l(3061),u=l(9507),p=l(9152);let m=function(e){let{visible:t,onOk:l,onCancel:n}=e;return(0,i.jsx)(p.R,{visible:t,title:"Unsaved Changes Detected",description:'<div>\n        <div style="margin-bottom: 16px;">You have unsaved changes that haven\'t been deployed yet.</div>\n        <div style="margin-bottom: 16px;">The downloaded configuration will reflect the <strong>currently deployed version</strong>, not your local changes.</div>\n        <div>To include your changes in the configuration:</div>\n        <ol style="margin-top: 8px; margin-left: 20px; list-style-type: decimal;">\n          <li>Click "Resume" to deploy your changes</li>\n          <li>Wait for the pipeline to become active</li>\n          <li>Download the configuration</li>\n        </ol>\n      </div>',okButtonText:"Download Anyway",cancelButtonText:"Cancel",onComplete:e=>{e===p.i.YES?l():n()},criticalOperation:!1})};var f=l(2272),x=l(3427),h=l(8090),g=l(9596),v=l(5855);let N={src:"/_next/static/media/play.01cbd0f0.svg",height:16,width:17,blurWidth:0,blurHeight:0},j={src:"/_next/static/media/edit.0bcb30f5.svg",height:16,width:16,blurWidth:0,blurHeight:0};var b=l(302),C=l(6696),y=l(2526),w=l(7924),T=l(1240),I=l(4345),S=l(1296),O=l(1224),_=l(8387);let E=function(e){let{pipeline:t,onPipelineUpdate:p,onPipelineDeleted:E,actions:P,showHeader:F=!0}=e,[k,R]=(0,n.useState)(null),[D,A]=(0,n.useState)(!1),[L,U]=(0,n.useState)(!1),H=(0,n.useRef)(null),{coreStore:M}=(0,h.useStore)(),K=(0,S.Tu)(t.pipeline_id),G=(0,S.c7)();(0,S.qs)([t.pipeline_id]);let V=K||t.status||"active",B="pausing"===V||"stopping"===V||"resuming"===V,{health:J,isLoading:Z,error:z}=(0,x.O)({pipelineId:t.pipeline_id,enabled:!B,pollingInterval:5e3,stopOnStatuses:["Running","Terminated","Failed"],maxRetries:2,onStatusChange:(e,l)=>{console.log("Pipeline ".concat(t.pipeline_id," health status changed: ").concat(l," → ").concat(e))},onError:e=>{console.error("Pipeline ".concat(t.pipeline_id," health check error:"),e)}}),Q={...t,status:V},{actionState:q,executeAction:W,getActionConfiguration:Y,getButtonText:$,isActionDisabled:X,shouldShowModal:ee,clearError:et}=(0,f.z)(Q),el=async e=>{if(!Y(e).isDisabled)if(ee(e))R(e);else try{if("stop"===e)G.reportStop(t.pipeline_id);else if("resume"===e){let{coreStore:e}=h.useStore.getState();if(e.isDirty){let{generateApiConfig:t}=await Promise.resolve().then(l.bind(l,3797)),{kafkaStore:i,topicsStore:n,clickhouseConnectionStore:a,clickhouseDestinationStore:s,joinStore:o,deduplicationStore:r}=h.useStore.getState(),c=t({pipelineId:e.pipelineId,pipelineName:e.pipelineName,setPipelineId:e.setPipelineId,clickhouseConnection:a.clickhouseConnection,clickhouseDestination:s.clickhouseDestination,selectedTopics:Object.values(n.topics||{}),getMappingType:(e,t)=>{let l=t.find(t=>t.eventField===e);return l?l.jsonType:"string"},joinStore:o,kafkaStore:i,deduplicationStore:r});await W("edit",c),e.markAsClean()}G.reportResume(t.pipeline_id)}else"terminate"===e?G.reportTerminate(t.pipeline_id):"delete"===e&&(G.reportDelete(t.pipeline_id),null==E||E());let i=await W(e);i&&p&&p(i),H.current={action:e,timestamp:Date.now()}}catch(l){if("stop"===e)G.revertOptimisticUpdate(t.pipeline_id,"active");else if("resume"===e)G.revertOptimisticUpdate(t.pipeline_id,"stopped");else if("terminate"===e){let e=t.status||"active";G.revertOptimisticUpdate(t.pipeline_id,e)}else if("delete"===e){let e=t.status||"active";G.revertOptimisticUpdate(t.pipeline_id,e)}}},ei=async()=>{if(M.isDirty)return void U(!0);await en()},en=async()=>{try{await (0,O.Tt)(t),U(!1)}catch(e){console.error("Failed to download pipeline configuration:",e)}},ea=async(e,l)=>{try{"stop"===e?G.reportStop(t.pipeline_id):"resume"===e?G.reportResume(t.pipeline_id):"terminate"===e?G.reportTerminate(t.pipeline_id):"delete"===e&&G.reportDelete(t.pipeline_id),R(null);let i=await W(e,l);if("delete"===e)null==E||E();else if(i&&p)p(i);else if("rename"===e&&p){let e={...t,name:(null==l?void 0:l.name)||t.name};p(e)}H.current={action:e,timestamp:Date.now()}}catch(l){if("stop"===e)G.revertOptimisticUpdate(t.pipeline_id,"active");else if("resume"===e)G.revertOptimisticUpdate(t.pipeline_id,"stopped");else if("terminate"===e){let e=t.status||"active";G.revertOptimisticUpdate(t.pipeline_id,e)}}},es=()=>{R(null),et()},eo=async()=>{try{await navigator.clipboard.writeText(t.pipeline_id),A(!0),setTimeout(()=>A(!1),2e3)}catch(l){let e=document.createElement("textarea");e.value=t.pipeline_id,document.body.appendChild(e),e.select();try{document.execCommand("copy"),A(!0),setTimeout(()=>A(!1),2e3)}catch(e){console.error("Fallback copy failed:",e)}document.body.removeChild(e)}},er=e=>{let t=Y(e),l=$(e),n=X(e);return(0,i.jsx)(a.$,{variant:"outline",onClick:()=>el(e),disabled:n,className:"group ".concat("resume"===e?"btn-primary":"btn-action"),title:t.disabledReason,children:q.isLoading&&q.lastAction===e?(0,i.jsxs)("span",{className:"flex items-center gap-3",children:[(0,i.jsx)(g.default,{src:v.A,alt:"Loading",width:16,height:16,className:"animate-spin"}),"Loading..."]}):(0,i.jsxs)("div",{className:"flex items-center gap-3",children:["resume"===e&&(0,i.jsx)(g.default,{src:N,alt:"Start",width:16,height:16,className:"filter brightness-100 group-hover:brightness-0"}),"stop"===e&&(0,i.jsx)(g.default,{src:T.A,alt:"Stop",width:16,height:16,className:"filter brightness-100 group-hover:brightness-0"}),"rename"===e&&(0,i.jsx)(g.default,{src:b.A,alt:"Rename",width:16,height:16,className:"filter brightness-100 group-hover:brightness-0"}),"terminate"===e&&(0,i.jsx)(g.default,{src:y.A,alt:"Terminate",width:16,height:16,className:"filter brightness-100 group-hover:brightness-0"}),"delete"===e&&(0,i.jsx)(g.default,{src:C.A,alt:"Delete",width:16,height:16,className:"filter brightness-100 group-hover:brightness-0"}),"edit"===e&&(0,i.jsx)(g.default,{src:j,alt:"Edit",width:16,height:16,className:"filter brightness-0 group-hover:brightness-0"}),l]})},e)};return(0,i.jsxs)("div",{className:(0,_.cn)("flex flex-col gap-4 transition-all duration-750 ease-out",F?"opacity-100 translate-y-0":"opacity-0 translate-y-4"),children:[(0,i.jsx)(o.Zp,{className:"border-[var(--color-border-neutral)] radius-large py-2 px-6 mb-4",children:(0,i.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,i.jsxs)("div",{className:"flex flex-row justify-between gap-2",children:[(0,i.jsxs)("div",{className:"flex flex-row flex-start gap-2 items-center",children:[q.isLoading&&(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[(0,i.jsx)(g.default,{src:v.A,alt:"Loading",width:24,height:24,className:"animate-spin"}),(0,i.jsxs)("span",{className:"text-sm text-blue-600 font-medium",children:["stop"===q.lastAction&&"Stopping pipeline...","resume"===q.lastAction&&"Resuming pipeline...","terminate"===q.lastAction&&"Terminating pipeline...","delete"===q.lastAction&&"Deleting pipeline...","rename"===q.lastAction&&"Renaming pipeline...","edit"===q.lastAction&&"Updating pipeline..."]})]}),(0,i.jsx)("h2",{className:"text-2xl font-bold",children:t.name}),(0,i.jsx)(s.E,{variant:(e=>{let t=V,l=H.current,i=l&&Date.now()-l.timestamp<5e3;if(!K&&(null==J?void 0:J.overall_status)&&!q.isLoading&&!i&&("active"===e||!e||"no_configuration"===e)){let l=(0,I.U)(J.overall_status);("active"!==l||"no_configuration"===e)&&(t=l)}switch(t){case"active":return"success";case"paused":case"pausing":case"resuming":case"stopping":case"terminating":return"warning";case"stopped":case"terminated":return"secondary";case"failed":return"error";default:return"default"}})(V),className:"rounded-xl my-2 mx-4",children:Z&&!K?"Checking...":(e=>{let t=V,l=H.current,i=l&&Date.now()-l.timestamp<5e3;if(!K&&(null==J?void 0:J.overall_status)&&!q.isLoading&&!i&&("active"===e||!e||"no_configuration"===e)){let l=(0,I.U)(J.overall_status);("active"!==l||"no_configuration"===e)&&(t=l)}switch(t){case"active":return"Active";case"pausing":return"Pausing...";case"paused":return"Paused";case"resuming":return"Resuming...";case"stopping":return"Stopping...";case"stopped":return"Stopped";case"terminating":return"Terminating...";case"terminated":return"Terminated";case"failed":return"Failed";default:return"Unknown status"}})(V)}),z&&(0,i.jsx)(s.E,{variant:"destructive",className:"ml-2",children:"Health Error"}),q.error&&(0,i.jsx)(s.E,{variant:"destructive",className:"ml-2",children:q.error})]}),(0,i.jsx)("div",{className:"flex flex-row flex-end gap-2",children:P||(()=>{let e="active"===V||"stopping"===V,t="stopped"===V||"terminated"===V,l="stopped"!==V&&"terminated"!==V&&"terminating"!==V,n="stopped"===V||"terminated"===V,o=!Y("rename").isDisabled;return(0,i.jsxs)(i.Fragment,{children:[t&&er("resume"),o&&er("rename"),l&&er("terminate"),n&&er("delete"),e&&er("stop"),(0,i.jsxs)(a.$,{variant:"outline",onClick:()=>ei(),disabled:!1,className:"group btn-action relative",title:M.isDirty?"Unsaved changes will not be included in downloaded config":"Download configuration",children:[(0,i.jsxs)("div",{className:"flex items-center gap-3",children:[(0,i.jsx)(g.default,{src:w.A,alt:"Download",width:16,height:16,className:"filter brightness-100 group-hover:brightness-0"}),M.isDirty&&(0,i.jsx)(s.E,{variant:"warning",className:"ml-1 px-1.5 py-0.5 text-[10px] leading-none",title:"Unsaved changes",children:"⚠️"})]}),"Download config"]},"download")]})})()})]}),(0,i.jsx)("div",{className:"flex flex-start items-center gap-1 text-sm text-muted-foreground",children:t.pipeline_id?(0,i.jsxs)("div",{className:"group flex items-center gap-1",children:[(0,i.jsxs)("span",{className:"cursor-pointer hover:text-foreground transition-colors",onClick:eo,title:"Click to copy pipeline ID",children:["Pipeline ID: ",t.pipeline_id]}),(0,i.jsx)(r,{className:"h-3 w-3 opacity-0 group-hover:opacity-100 transition-opacity"}),D&&(0,i.jsx)(s.E,{variant:"secondary",className:"ml-2 h-6 w-18 text-sm",children:"Copied"})]}):(0,i.jsx)("span",{children:"Pipeline ID: None"})})]})}),(0,i.jsx)(c.A,{visible:"terminate"===k,onOk:()=>{ea("terminate",{graceful:!1})},onCancel:es}),(0,i.jsx)(d.A,{visible:"rename"===k,currentName:t.name,onOk:e=>{ea("rename",{name:e})},onCancel:es}),(0,i.jsx)(m,{visible:L,onOk:en,onCancel:()=>{U(!1)}}),(0,i.jsx)(u.A,{visible:"stop"===k,onOk:()=>{ea("stop")},onCancel:es})]})},P={src:"/_next/static/media/dlq2.e07001e3.svg",height:24,width:24,blurWidth:0,blurHeight:0},F={src:"/_next/static/media/maximize-2.175afa19.svg",height:20,width:20,blurWidth:0,blurHeight:0},k={src:"/_next/static/media/minimize-2.5855f4dc.svg",height:20,width:20,blurWidth:0,blurHeight:0};var R=l(1475);let D={totalDlq:"0",lastEventReceived:"-",unconsumedEvents:"0",lastConsumedAt:"-"},A=e=>e.toLocaleString(),L=e=>{if(!e||""===e||"0"===e)return"-";let t=new Date,l=new Date(e);if(isNaN(l.getTime())||2e3>l.getFullYear())return"-";let i=t.getTime()-l.getTime();if(i<0)return"-";let n=Math.floor(i/6e4);if(n<1)return"Just now";if(n<60)return"".concat(n," min. ago");let a=Math.floor(n/60);if(a<24)return"".concat(a," hour").concat(a>1?"s":""," ago");let s=Math.floor(a/24);return s>365?"Over a year ago":"".concat(s," day").concat(s>1?"s":""," ago")},U=function(e){let{pipelineId:t}=e,[l,a]=(0,n.useState)(!1),[s,r]=(0,n.useState)(D),[c,d]=(0,n.useState)(!0),[u,p]=(0,n.useState)(null),[m,f]=(0,n.useState)(!1),x=(0,n.useRef)(null),[h,v]=(0,n.useState)(0);return((0,n.useEffect)(()=>{let e=async()=>{try{d(!0),p(null);let e=await (0,R.j_)(t);r({totalDlq:A(e.total_messages),lastEventReceived:L(e.last_received_at),unconsumedEvents:A(e.unconsumed_messages),lastConsumedAt:L(e.last_consumed_at)})}catch(e){console.error("Failed to fetch DLQ state:",e),p(e.message||"Failed to fetch DLQ data"),r(D)}finally{d(!1)}};t&&e()},[t]),(0,n.useEffect)(()=>{x.current&&requestAnimationFrame(()=>{x.current&&v(x.current.scrollHeight+4)})},[s,l]),c)?(0,i.jsx)(o.Zp,{className:"border-[var(--color-border-neutral)] radius-large py-4 px-6 mb-4 w-full",children:(0,i.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,i.jsxs)("div",{className:"flex flex-row justify-between gap-2 items-center",children:[(0,i.jsxs)("div",{className:"flex flex-start flex-row gap-2 items-center",children:[(0,i.jsx)(g.default,{src:P,alt:"Dead Letter Queue",className:"w-6 h-6",width:24,height:24}),(0,i.jsx)("h3",{className:"text-lg font-bold",children:"Dead Letter Queue"})]}),(0,i.jsx)("div",{className:"w-6 h-6"})," "]}),(0,i.jsx)("div",{className:"text-sm text-muted-foreground animate-pulse",children:"Loading DLQ data..."})]})}):u?(0,i.jsx)(o.Zp,{className:"border-[var(--color-border-neutral)] radius-large py-4 px-6 mb-4 w-full",children:(0,i.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,i.jsxs)("div",{className:"flex flex-row justify-between gap-2 items-center",children:[(0,i.jsxs)("div",{className:"flex flex-start flex-row gap-2 items-center",children:[(0,i.jsx)(g.default,{src:P,alt:"Dead Letter Queue",className:"w-6 h-6",width:24,height:24}),(0,i.jsx)("h3",{className:"text-lg font-bold",children:"Dead Letter Queue"})]}),(0,i.jsx)("div",{className:"w-6 h-6"})," "]}),(0,i.jsxs)("div",{className:"text-sm text-muted-foreground animate-fadeIn",children:["Missing DLQ data: ",u]})]})}):(0,i.jsx)(o.Zp,{className:"border-[var(--color-border-neutral)] radius-large py-4 px-6 mb-4 w-full",children:(0,i.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,i.jsxs)("div",{className:"flex flex-row justify-between gap-2 items-center",children:[(0,i.jsxs)("div",{className:"flex flex-start flex-row gap-2 items-center",children:[(0,i.jsx)(g.default,{src:P,alt:"Dead Letter Queue",className:"w-6 h-6",width:24,height:24}),(0,i.jsx)("h3",{className:"text-lg font-bold",children:"Dead Letter Queue"})]}),(0,i.jsx)(g.default,{src:l?k:F,alt:"Toggle expand",className:"w-6 h-6 cursor-pointer transition-transform duration-200 hover:scale-110 ".concat(m?"animate-pulse":""),width:24,height:24,onClick:()=>{f(!0),a(!l),setTimeout(()=>{f(!1)},300)}})]}),(0,i.jsx)("div",{className:"transition-all duration-300 ease-out",style:{maxHeight:l?"".concat(h,"px"):"40px",opacity:c?.7:1,overflow:"hidden"},children:(0,i.jsx)("div",{ref:x,className:"pb-1",children:l?(0,i.jsx)("div",{className:"animate-fadeIn",children:(e=>{let{totalDlq:t,lastEventReceived:l,unconsumedEvents:n,lastConsumedAt:a}=e;return(0,i.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,i.jsxs)("div",{className:"flex flex-row gap-2 items-center",children:[(0,i.jsx)("span",{className:"text-md font-bold",children:t}),(0,i.jsx)("span",{className:"text-sm font-normal text-[var(--color-foreground-neutral-faded)]",children:"Total events in DLQ"})]}),(0,i.jsxs)("div",{className:"flex flex-row gap-2 items-center",children:[(0,i.jsx)("span",{className:"text-md font-bold",children:l}),(0,i.jsx)("span",{className:"text-sm font-normal text-[var(--color-foreground-neutral-faded)]",children:"Last event received"})]}),(0,i.jsxs)("div",{className:"flex flex-row gap-2 items-center",children:[(0,i.jsx)("span",{className:"text-md font-bold",children:n}),(0,i.jsx)("span",{className:"text-sm font-normal text-[var(--color-foreground-neutral-faded)]",children:"Unconsumed events"})]}),(0,i.jsxs)("div",{className:"flex flex-row gap-2 items-center",children:[(0,i.jsx)("span",{className:"text-md font-bold",children:a}),(0,i.jsx)("span",{className:"text-sm font-normal text-[var(--color-foreground-neutral-faded)]",children:"Last consumed at"})]})]})})(s)}):(0,i.jsx)("div",{className:"animate-fadeIn",children:(e=>{let{unconsumedEvents:t}=e;return(0,i.jsx)("div",{className:"flex flex-row gap-2 items-center",children:(0,i.jsxs)("div",{className:"flex flex-row gap-2 items-center",children:[(0,i.jsx)("div",{className:"w-3 h-3 rounded-full bg-green-500"}),(0,i.jsx)("span",{className:"text-md font-bold",children:t}),(0,i.jsx)("span",{className:"text-sm font-normal",children:"Unconsumed events"})]})})})({unconsumedEvents:s.unconsumedEvents})})})})]})})},H={src:"/_next/static/media/clickhouse.9d6c8bc7.svg",height:20,width:21,blurWidth:0,blurHeight:0},M={rowCount:"0",insertRateRows:"0 rows/sec",insertRateBytes:"0 B/sec",latencyP50:"0ms",latencyP95:"0ms",tableSize:"0B",queryMemory:"0B",activeQueries:"0",failedInserts:"0",lastUpdated:"-"},K=function(e){let{pipeline:t}=e,[l,a]=(0,n.useState)(!1),[s,r]=(0,n.useState)(M),[c,d]=(0,n.useState)(null),[u,p]=(0,n.useState)(!0),[m,f]=(0,n.useState)(null),[x,h]=(0,n.useState)(!1),v=(0,n.useRef)(null),[N,j]=(0,n.useState)(0),[b,C]=(0,n.useState)(new Date);return((0,n.useEffect)(()=>{let e=setInterval(()=>{C(new Date)},1e3);return()=>clearInterval(e)},[]),(0,n.useEffect)(()=>{c&&r({rowCount:(0,_.ZV)(c.rowCount),insertRateRows:"".concat((0,_.ZV)(Math.round(c.insertRateRowsPerSec))," rows/sec"),insertRateBytes:"".concat((0,_.z3)(Math.round(c.insertRateBytesPerSec)),"/sec"),latencyP50:"".concat(Math.round(c.insertLatencyP50Ms),"ms"),latencyP95:"".concat(Math.round(c.insertLatencyP95Ms),"ms"),tableSize:(0,_.z3)(c.compressedSizeBytes),queryMemory:(0,_.z3)(c.memoryUsageBytes),activeQueries:(0,_.ZV)(c.activeQueries),failedInserts:(0,_.ZV)(c.failedInsertsLast5Min),lastUpdated:(0,_.fw)(c.lastUpdated,b)})},[b,c]),(0,n.useEffect)(()=>{let e=async()=>{try{p(!0),f(null);let e=await (0,R.ej)(t);d(e),r({rowCount:(0,_.ZV)(e.rowCount),insertRateRows:"".concat((0,_.ZV)(Math.round(e.insertRateRowsPerSec))," rows/sec"),insertRateBytes:"".concat((0,_.z3)(Math.round(e.insertRateBytesPerSec)),"/sec"),latencyP50:"".concat(Math.round(e.insertLatencyP50Ms),"ms"),latencyP95:"".concat(Math.round(e.insertLatencyP95Ms),"ms"),tableSize:(0,_.z3)(e.compressedSizeBytes),queryMemory:(0,_.z3)(e.memoryUsageBytes),activeQueries:(0,_.ZV)(e.activeQueries),failedInserts:(0,_.ZV)(e.failedInsertsLast5Min),lastUpdated:(0,_.fw)(e.lastUpdated)})}catch(t){var e;console.error("Failed to fetch ClickHouse metrics:",t),404===t.code?f("Pipeline not found in backend"):(null==(e=t.message)?void 0:e.includes("Pipeline does not have a ClickHouse sink"))?f("Pipeline does not have a ClickHouse sink"):f(t.message||"Failed to fetch ClickHouse metrics"),r(M),d(null)}finally{p(!1)}};if(null==t?void 0:t.pipeline_id){e();let t=setInterval(e,3e4);return()=>clearInterval(t)}},[t]),(0,n.useEffect)(()=>{v.current&&requestAnimationFrame(()=>{v.current&&j(v.current.scrollHeight+4)})},[s,l]),u)?(0,i.jsx)(o.Zp,{className:"border-[var(--color-border-neutral)] radius-large py-4 px-6 mb-4 w-full",children:(0,i.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,i.jsxs)("div",{className:"flex flex-row justify-between gap-2 items-center",children:[(0,i.jsxs)("div",{className:"flex flex-start flex-row gap-2 items-center",children:[(0,i.jsx)(g.default,{src:H,alt:"ClickHouse Table Metrics",className:"w-6 h-6",width:24,height:24}),(0,i.jsx)("h3",{className:"text-lg font-bold",children:"ClickHouse Table Metrics"})]}),(0,i.jsx)("div",{className:"w-6 h-6"})," "]}),(0,i.jsx)("div",{className:"text-sm text-muted-foreground animate-pulse",children:"Loading ClickHouse metrics..."})]})}):m?(0,i.jsx)(o.Zp,{className:"border-[var(--color-border-neutral)] radius-large py-4 px-6 mb-4 w-full",children:(0,i.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,i.jsxs)("div",{className:"flex flex-row justify-between gap-2 items-center",children:[(0,i.jsxs)("div",{className:"flex flex-start flex-row gap-2 items-center",children:[(0,i.jsx)(g.default,{src:H,alt:"ClickHouse Table Metrics",className:"w-6 h-6",width:24,height:24}),(0,i.jsx)("h3",{className:"text-lg font-bold",children:"ClickHouse Table Metrics"})]}),(0,i.jsx)("div",{className:"w-6 h-6"})," "]}),(0,i.jsxs)("div",{className:"text-sm text-muted-foreground animate-fadeIn",children:["Missing ClickHouse metrics: ",m]})]})}):(0,i.jsx)(o.Zp,{className:"border-[var(--color-border-neutral)] radius-large py-4 px-6 mb-4 w-full",children:(0,i.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,i.jsxs)("div",{className:"flex flex-row justify-between gap-2 items-center",children:[(0,i.jsxs)("div",{className:"flex flex-start flex-row gap-2 items-center",children:[(0,i.jsx)(g.default,{src:H,alt:"ClickHouse Table Metrics",className:"w-6 h-6",width:24,height:24}),(0,i.jsx)("h3",{className:"text-lg font-bold",children:"ClickHouse Table Metrics"})]}),(0,i.jsx)(g.default,{src:l?k:F,alt:"Toggle expand",className:"w-6 h-6 cursor-pointer transition-transform duration-200 hover:scale-110 ".concat(x?"animate-pulse":""),width:24,height:24,onClick:()=>{h(!0),a(!l),setTimeout(()=>{h(!1)},300)}})]}),(0,i.jsx)("div",{className:"transition-all duration-300 ease-out",style:{maxHeight:l?"".concat(N,"px"):"40px",opacity:u?.7:1,overflow:"hidden"},children:(0,i.jsx)("div",{ref:v,className:"pb-1",children:l?(0,i.jsx)("div",{className:"animate-fadeIn",children:(e=>{let{rowCount:t,insertRateRows:l,insertRateBytes:n,latencyP50:a,latencyP95:s,tableSize:o,queryMemory:r,activeQueries:c,failedInserts:d,lastUpdated:u}=e;return(0,i.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,i.jsxs)("div",{className:"flex flex-row gap-2 items-center",children:[(0,i.jsx)("span",{className:"text-md font-bold",children:t}),(0,i.jsx)("span",{className:"text-sm font-normal text-[var(--color-foreground-neutral-faded)]",children:"Total rows"})]}),(0,i.jsxs)("div",{className:"flex flex-row gap-2 items-center",children:[(0,i.jsx)("span",{className:"text-md font-bold",children:l}),(0,i.jsx)("span",{className:"text-sm font-normal text-[var(--color-foreground-neutral-faded)]",children:"Insert rate (rows)"})]}),(0,i.jsxs)("div",{className:"flex flex-row gap-2 items-center",children:[(0,i.jsx)("span",{className:"text-md font-bold",children:n}),(0,i.jsx)("span",{className:"text-sm font-normal text-[var(--color-foreground-neutral-faded)]",children:"Insert rate (bytes)"})]}),(0,i.jsxs)("div",{className:"flex flex-row gap-2 items-center",children:[(0,i.jsx)("span",{className:"text-md font-bold",children:a}),(0,i.jsx)("span",{className:"text-sm font-normal text-[var(--color-foreground-neutral-faded)]",children:"Latency P50"})]}),(0,i.jsxs)("div",{className:"flex flex-row gap-2 items-center",children:[(0,i.jsx)("span",{className:"text-md font-bold",children:s}),(0,i.jsx)("span",{className:"text-sm font-normal text-[var(--color-foreground-neutral-faded)]",children:"Latency P95"})]}),(0,i.jsxs)("div",{className:"flex flex-row gap-2 items-center",children:[(0,i.jsx)("span",{className:"text-md font-bold",children:o}),(0,i.jsx)("span",{className:"text-sm font-normal text-[var(--color-foreground-neutral-faded)]",children:"Table size (disk)"})]}),(0,i.jsxs)("div",{className:"flex flex-row gap-2 items-center",children:[(0,i.jsx)("span",{className:"text-md font-bold",children:r}),(0,i.jsx)("span",{className:"text-sm font-normal text-[var(--color-foreground-neutral-faded)]",children:"Query memory"})]}),(0,i.jsxs)("div",{className:"flex flex-row gap-2 items-center",children:[(0,i.jsx)("span",{className:"text-md font-bold",children:c}),(0,i.jsx)("span",{className:"text-sm font-normal text-[var(--color-foreground-neutral-faded)]",children:"Active queries"})]}),(0,i.jsxs)("div",{className:"flex flex-row gap-2 items-center",children:[(0,i.jsx)("span",{className:"text-md font-bold",children:d}),(0,i.jsx)("span",{className:"text-sm font-normal text-[var(--color-foreground-neutral-faded)]",children:"Failed inserts (5min)"})]}),(0,i.jsxs)("div",{className:"flex flex-row gap-2 items-center",children:[(0,i.jsx)("span",{className:"text-md font-bold",children:u}),(0,i.jsx)("span",{className:"text-sm font-normal text-[var(--color-foreground-neutral-faded)]",children:"Last updated"})]})]})})(s)}):(0,i.jsx)("div",{className:"animate-fadeIn",children:(e=>{let{rowCount:t,insertRateRows:l}=e;return(0,i.jsxs)("div",{className:"flex flex-row gap-2 items-center",children:[(0,i.jsxs)("div",{className:"flex flex-row gap-2 items-center",children:[(0,i.jsx)("div",{className:"w-3 h-3 rounded-full bg-blue-500"}),(0,i.jsx)("span",{className:"text-md font-bold",children:t}),(0,i.jsx)("span",{className:"text-sm font-normal",children:"rows"})]}),(0,i.jsxs)("div",{className:"flex flex-row gap-2 items-center",children:[(0,i.jsx)("div",{className:"w-3 h-3 rounded-full bg-green-500"}),(0,i.jsx)("span",{className:"text-md font-bold",children:l})]})]})})({rowCount:s.rowCount,insertRateRows:s.insertRateRows})})})})]})})},G=function(e){let{pipeline:t,showStatusOverview:l}=e;return(0,i.jsx)("div",{className:(0,_.cn)("flex flex-col gap-4 transition-all duration-750 ease-out",l?"opacity-100 translate-y-0":"opacity-0 translate-y-4"),children:(0,i.jsx)(o.Zp,{className:"py-0 px-0 mb-4 border-none",children:(0,i.jsxs)("div",{className:"flex flex-row gap-4 items-start",children:[(0,i.jsx)(U,{pipelineId:t.pipeline_id}),(0,i.jsx)(K,{pipeline:t})]})})})},V=function(e){let{label:t,value:l,orientation:n="center",width:a="half",onClick:s,disabled:r,validation:c,selected:d}=e;return(0,i.jsx)(o.Zp,{className:(0,_.cn)("border-[var(--color-border-neutral)] radius-large p-4","full"===a?"w-full":"w-1/2",r?"opacity-50 cursor-not-allowed":"",(null==c?void 0:c.status)==="invalidated"&&"border-red-500",d&&"border-primary"),onClick:s,children:(0,i.jsx)("div",{className:"flex flex-col gap-4 ".concat("left"===n?"items-start":"right"===n?"items-end":"items-center"),children:(0,i.jsxs)("div",{className:"flex flex-col gap-2 ".concat("left"===n?"text-left":"right"===n?"text-right":"text-center"),children:[(0,i.jsx)("span",{className:"text-lg font-bold text-[var(--color-foreground-neutral-faded)]",children:t[0]}),(0,i.jsx)("span",{className:"text-sm font-normal",children:l[0]}),t[1]&&(0,i.jsx)("span",{className:"text-lg font-bold text-[var(--color-foreground-neutral-faded)]",children:t[1]}),l[1]&&(0,i.jsx)("span",{className:"text-sm font-normal",children:l[1]})]})})})},B=function(e){var t,l,n,a;let{label:s,value:r,width:c="half",onClick:d,disabled:u,validation:p,selected:m}=e;return(0,i.jsx)(o.Zp,{className:(0,_.cn)("border-[var(--color-border-neutral)] radius-large p-4","full"===c?"w-full":"w-1/2",u?"opacity-50 cursor-not-allowed":"",(null==p||null==(t=p.topicsValidation)?void 0:t.status)==="invalidated"||(null==p||null==(l=p.joinValidation)?void 0:l.status)==="invalidated"||(null==p||null==(n=p.deduplicationValidation)?void 0:n.status)==="invalidated"||(null==p||null==(a=p.clickhouseDestinationValidation)?void 0:a.status)==="invalidated"||(null==p?void 0:p.status)==="invalidated"?"border-red-500":"",m&&"border-primary"),onClick:d,children:(0,i.jsxs)("div",{className:"flex flex-row justify-between gap-4",children:[(0,i.jsxs)("div",{className:"flex flex-col gap-2 text-left",children:[(0,i.jsx)("span",{className:"text-lg font-bold text-[var(--color-foreground-neutral-faded)]",children:s[0]}),(0,i.jsx)("span",{className:"text-sm font-normal",children:r[0]})]}),(0,i.jsxs)("div",{className:"flex flex-col gap-2 text-right",children:[(0,i.jsx)("span",{className:"text-lg font-bold text-[var(--color-foreground-neutral-faded)]",children:s[1]}),(0,i.jsx)("span",{className:"text-sm font-normal",children:r[1]})]})]})})};var J=l(8821);let Z=e=>{let{topic:t,hasDedup:l,destinationTable:n,totalSourceFields:a,totalDestinationColumns:s,onStepClick:o,disabled:r,validation:c,activeStep:d}=e;return(0,i.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,i.jsx)(V,{label:["Topic"],value:[t.name],orientation:"center",width:"full",onClick:()=>o(J.Fn.TOPIC_SELECTION_1),disabled:r,validation:c,selected:d===J.Fn.TOPIC_SELECTION_1}),l&&(()=>{let e=h.useStore.getState().deduplicationStore.getDeduplication(0);return(0,i.jsx)(V,{label:["Deduplication Key"],value:[(null==e?void 0:e.key)||"N/A"],orientation:"center",width:"full",onClick:()=>o(J.Fn.DEDUPLICATION_CONFIGURATOR),disabled:r,validation:c.deduplicationValidation,selected:d===J.Fn.DEDUPLICATION_CONFIGURATOR})})(),(0,i.jsx)(B,{label:["Destination Table","Schema Mapping"],value:[n,"".concat(a," fields → ").concat(s," columns")],width:"full",onClick:()=>o(J.Fn.CLICKHOUSE_MAPPER),disabled:r,validation:c,selected:d===J.Fn.CLICKHOUSE_MAPPER})]})},z=e=>{let{leftTopic:t,rightTopic:l,leftSource:n,rightSource:a,destinationTable:s,totalSourceFields:o,totalDestinationColumns:r,onStepClick:c,disabled:d,validation:u,activeStep:p}=e;return(0,i.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,i.jsxs)("div",{className:"flex flex-row gap-4",children:[(0,i.jsx)(V,{label:["Left Topic"],orientation:"left",value:[(null==t?void 0:t.name)||"N/A"],width:"full",onClick:()=>c(J.Fn.TOPIC_SELECTION_1),disabled:d,validation:u.topicsValidation,selected:p===J.Fn.TOPIC_SELECTION_1}),(0,i.jsx)(V,{label:["Right Topic"],orientation:"right",value:[(null==l?void 0:l.name)||"N/A"],width:"full",onClick:()=>c(J.Fn.TOPIC_SELECTION_2),disabled:d,validation:u.topicsValidation,selected:p===J.Fn.TOPIC_SELECTION_2})]}),(0,i.jsxs)("div",{className:"flex flex-row gap-4",children:[(0,i.jsx)(V,{label:["Left Join Key"],orientation:"left",value:[(null==n?void 0:n.join_key)||"N/A"],width:"full",onClick:()=>c(J.Fn.JOIN_CONFIGURATOR),disabled:d,selected:p===J.Fn.JOIN_CONFIGURATOR}),(0,i.jsx)(V,{label:["Right Join Key"],orientation:"right",value:[(null==a?void 0:a.join_key)||"N/A"],width:"full",onClick:()=>c(J.Fn.JOIN_CONFIGURATOR),disabled:d,selected:p===J.Fn.JOIN_CONFIGURATOR})]}),(0,i.jsx)(B,{label:["Destination Table","Schema Mapping"],value:[s,"".concat(o," fields → ").concat(r," columns")],width:"full",onClick:()=>c(J.Fn.CLICKHOUSE_MAPPER),disabled:d,validation:u,selected:p===J.Fn.CLICKHOUSE_MAPPER})]})},Q=e=>{let{leftTopic:t,rightTopic:l,leftSource:n,rightSource:a,destinationTable:s,totalSourceFields:o,totalDestinationColumns:r,onStepClick:c,disabled:d,validation:u,activeStep:p}=e;return(0,i.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,i.jsxs)("div",{className:"flex flex-row gap-4",children:[(0,i.jsx)(B,{label:["Left Topic","Dedup Key"],value:[(null==t?void 0:t.name)||"N/A",(()=>{let e=h.useStore.getState().deduplicationStore.getDeduplication(0);return(null==e?void 0:e.enabled)?e.key:"None"})()],width:"full",onClick:()=>c(J.Fn.TOPIC_DEDUPLICATION_CONFIGURATOR_1),disabled:d,validation:u.topicsValidation,selected:p===J.Fn.TOPIC_DEDUPLICATION_CONFIGURATOR_1}),(0,i.jsx)(B,{label:["Dedup Key","Right Topic"],value:[(()=>{let e=h.useStore.getState().deduplicationStore.getDeduplication(1);return(null==e?void 0:e.enabled)?e.key:"None"})(),(null==l?void 0:l.name)||"N/A"],width:"full",onClick:()=>c(J.Fn.TOPIC_DEDUPLICATION_CONFIGURATOR_2),disabled:d,validation:u.topicsValidation,selected:p===J.Fn.TOPIC_DEDUPLICATION_CONFIGURATOR_2})]}),(0,i.jsxs)("div",{className:"flex flex-row gap-4",children:[(0,i.jsx)(V,{label:["Left Join Key"],orientation:"left",value:[(null==n?void 0:n.join_key)||"N/A"],width:"full",onClick:()=>c(J.Fn.JOIN_CONFIGURATOR),disabled:d,validation:u.joinValidation,selected:p===J.Fn.JOIN_CONFIGURATOR}),(0,i.jsx)(V,{label:["Right Join Key"],orientation:"right",value:[(null==a?void 0:a.join_key)||"N/A"],width:"full",onClick:()=>c(J.Fn.JOIN_CONFIGURATOR),disabled:d,validation:u.joinValidation,selected:p===J.Fn.JOIN_CONFIGURATOR})]}),(0,i.jsx)(B,{label:["Destination Table","Schema Mapping"],value:[s,"".concat(o," fields → ").concat(r," columns")],width:"full",onClick:()=>c(J.Fn.CLICKHOUSE_MAPPER),disabled:d,validation:u.clickhouseDestinationValidation,selected:p===J.Fn.CLICKHOUSE_MAPPER})]})},q=function(e){var t,l,n,a,s,o,r,c;let{pipeline:d,onStepClick:u,disabled:p,validation:m,activeStep:f}=e,{topicsStore:x,joinStore:g,clickhouseDestinationStore:v}=(0,h.useStore)(),N=Object.values(x.topics).map(e=>({name:e.name,deduplication:{enabled:!1}})),j=N.length>0?N:(null==d||null==(t=d.source)?void 0:t.topics)||[],b=!!(g.enabled&&((null==(l=g.streams)?void 0:l.length)||0)>0||(null==d||null==(n=d.join)?void 0:n.enabled)&&((null==d||null==(s=d.join)||null==(a=s.sources)?void 0:a.length)||0)>0),{deduplicationStore:C}=(0,h.useStore)(),y=C.getDeduplication(0),w=C.getDeduplication(1),T=j[0],S=j[1],O=(e,t)=>{var l,i;let n=(null==e?void 0:e.enabled)===!0||(null==t||null==(l=t.deduplication)?void 0:l.enabled)===!0,a=((null==e?void 0:e.key)||(null==t||null==(i=t.deduplication)?void 0:i.id_field)||"").trim();return n&&a.length>0},_=O(y,T),E=O(w,S),P=g.streams.map(e=>({source_id:e.topicName,join_key:e.joinKey,orientation:e.orientation}))||[],F=P.length>0?P:(null==d||null==(o=d.join)?void 0:o.sources)||[],k=v.clickhouseDestination.table,R=v.clickhouseDestination.mapping||[],D=k||(null==d||null==(r=d.sink)?void 0:r.table)||"N/A",A=R.length>0?R:(null==d||null==(c=d.sink)?void 0:c.table_mapping)||[],L=A.length,U=A.length,H=null;if(1!==j.length||b)if(j.length>1&&b&&!(_&&E)){let e=F.find(e=>"left"===e.orientation),t=F.find(e=>"right"===e.orientation),l=j.find(t=>t.name===(null==e?void 0:e.source_id)),n=j.find(e=>e.name===(null==t?void 0:t.source_id));return(0,i.jsx)(z,{leftTopic:l,rightTopic:n,leftSource:e,rightSource:t,destinationTable:D,totalSourceFields:L,totalDestinationColumns:U,onStepClick:u,disabled:p,validation:m,activeStep:f})}else H=j.length>1&&b&&_&&E?(0,i.jsx)(Q,{leftTopic:j[0],rightTopic:j[1],leftSource:F.find(e=>"left"===e.orientation),rightSource:F.find(e=>"right"===e.orientation),destinationTable:D,totalSourceFields:L,totalDestinationColumns:U,onStepClick:u,disabled:p,validation:m,activeStep:f}):(0,i.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,i.jsx)(V,{label:["Configuration"],value:["".concat(j.length," topic(s), Join: ").concat(b?"Yes":"No")],orientation:"center",width:"full",disabled:p}),(0,i.jsx)(B,{label:["Destination Table","Schema Mapping"],value:[D,"".concat(L," fields → ").concat(U," columns")],width:"full",disabled:p})]});else{let e=j[0],t=O(y,e);H=(0,i.jsx)(Z,{topic:e,hasDedup:t,destinationTable:D,totalSourceFields:L,totalDestinationColumns:U,onStepClick:u,disabled:p,validation:m,activeStep:f})}return(0,i.jsxs)("div",{className:"flex flex-col gap-4 w-3/5",children:[(0,i.jsx)("div",{className:"text-center",children:(0,i.jsxs)("span",{className:"text-lg font-bold text-[var(--color-foreground-neutral-faded)]",children:["Transformation: ",(()=>{try{var e,t,l,i,n,a,s,o,r,c,u,p,m;let f=h.useStore.getState(),x=!!((null==(e=f.joinStore)?void 0:e.enabled)&&((null==(t=f.joinStore.streams)?void 0:t.length)||0)>0||(null==d||null==(l=d.join)?void 0:l.enabled)&&((null==d||null==(n=d.join)||null==(i=n.sources)?void 0:i.length)||0)>0),g=null==(s=f.deduplicationStore)||null==(a=s.getDeduplication)?void 0:a.call(s,0),v=null==(r=f.deduplicationStore)||null==(o=r.getDeduplication)?void 0:o.call(r,1),N=null==d||null==(u=d.source)||null==(c=u.topics)?void 0:c[0],j=null==d||null==(m=d.source)||null==(p=m.topics)?void 0:p[1],b=(e,t)=>{var l,i;let n=(null==e?void 0:e.enabled)===!0||(null==t||null==(l=t.deduplication)?void 0:l.enabled)===!0,a=((null==e?void 0:e.key)||(null==t||null==(i=t.deduplication)?void 0:i.id_field)||"").trim();return n&&a.length>0},C=b(g,N),y=b(v,j);if(x&&C&&y)return"Join & Deduplication";if(x)return"Join";return(0,I.t)(d)}catch(e){return(0,I.t)(d)}})()]})}),H]})};var W=l(4370),Y=l(3132),$=l(8099),X=l(827),ee=l(669),et=l(4511);let el=function(e){let{children:t,stepInfo:l,handleBack:n,onClose:a,isLoading:s=!1,loadingText:o="Processing..."}=e;return(0,i.jsxs)("div",{className:"mt-6 w-full bg-[var(--color-background-elevation-raised-faded-2)] border border-[var(--color-border-neutral)] rounded-xl animate-in fade-in slide-in-from-top-2 duration-300",children:[(0,i.jsxs)("div",{className:"flex items-center justify-between p-6",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("h2",{className:"text-xl font-semibold mb-2",children:l.title}),(0,i.jsx)("p",{className:"text-sm text-gray-600",children:l.description})]}),s&&(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[(0,i.jsx)(g.default,{src:v.A,alt:"Loading",width:16,height:16,className:"animate-spin"}),(0,i.jsx)("span",{className:"text-sm text-blue-600",children:o})]})]}),(0,i.jsx)("div",{className:"p-6 overflow-y-auto max-h-[calc(90vh-120px)]",children:t})]})};var ei=l(2627);function en(e){let{isLoading:t,error:l,progress:n,onRetry:a,stepTitle:s}=e;return l?(0,i.jsx)("div",{className:"flex flex-col items-center justify-center py-8 px-4",children:(0,i.jsxs)("div",{className:"text-center max-w-md",children:[(0,i.jsxs)("p",{className:"text-red-500 text-sm mb-3",children:["Failed to load data for ",s,". ",l]}),(0,i.jsx)("button",{onClick:a,className:"text-blue-600 hover:text-blue-700 text-sm font-medium underline",children:"Try again"})]})}):t?(0,i.jsx)("div",{className:"flex flex-col items-center justify-center py-8 px-4",children:(0,i.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,i.jsx)(g.default,{src:v.A,alt:"Loading",width:20,height:20,className:"animate-spin"}),(0,i.jsx)("span",{className:"text-sm text-primary font-medium",children:"Loading..."})]})}):null}var ea=l(4493);let es=function(e){let{visible:t,onOk:l,onCancel:n,stepName:a}=e;return(0,i.jsx)(p.R,{visible:t,title:"Edit Pipeline Configuration?",description:a?'You are about to edit the "'.concat(a,'" configuration. This will pause the pipeline temporarily to allow editing. Any events currently in the queue will be processed before pausing, which may take some time.'):"You are about to edit this pipeline configuration. This will pause the pipeline temporarily to allow editing. Any events currently in the queue will be processed before pausing, which may take some time.",content:(0,i.jsx)("div",{className:"text-sm text-muted-foreground",children:"Are you sure you want to proceed with editing?"}),okButtonText:"Edit Configuration",cancelButtonText:"Cancel",onComplete:e=>{e===p.i.YES?l():n()}})},eo=function(e){let{stepKey:t,onClose:l,pipeline:a,onPipelineStatusUpdate:s}=e,{kafkaStore:o,clickhouseConnectionStore:r,clickhouseDestinationStore:c,coreStore:d}=(0,h.useStore)(),[u,p]=(0,n.useState)(null),[m,x]=(0,n.useState)({}),[g,v]=(0,n.useState)(!1),{enterEditMode:N,mode:j}=d,b=(0,S.Tu)(null==a?void 0:a.pipeline_id),C=b||(null==a?void 0:a.status)||"stopped",{executeAction:y,actionState:w}=(0,f.z)(a),{isEditConfirmationModalVisible:T,selectedPipeline:I,selectedStep:O,openEditConfirmationModal:_,closeEditConfirmationModal:E}=(0,ea.uv)(),P=function(e,t){let{topicsStore:l,kafkaStore:i}=(0,h.useStore)(),[a,s]=(0,n.useState)({isLoading:!1,isComplete:!1,error:null,progress:{current:0,total:0,description:""}}),o=(0,n.useRef)(null),r=(0,n.useRef)(!1),c=(0,n.useCallback)(e=>{let t=h.useStore.getState().topicsStore.topicCount;switch(e){case J.Fn.TOPIC_SELECTION_1:case J.Fn.TOPIC_SELECTION_2:return{needsTopicEvents:!0,topicIndices:[+(e!==J.Fn.TOPIC_SELECTION_1)],description:"Loading topic event data..."};case J.Fn.DEDUPLICATION_CONFIGURATOR:return{needsTopicEvents:!0,topicIndices:[0],description:"Loading event data for deduplication configuration..."};case J.Fn.TOPIC_DEDUPLICATION_CONFIGURATOR_1:return{needsTopicEvents:!0,topicIndices:[0],description:"Loading left topic event data..."};case J.Fn.TOPIC_DEDUPLICATION_CONFIGURATOR_2:return{needsTopicEvents:!0,topicIndices:[1],description:"Loading right topic event data..."};case J.Fn.JOIN_CONFIGURATOR:return{needsTopicEvents:!0,topicIndices:[0,1],description:"Loading event data for join configuration..."};case J.Fn.CLICKHOUSE_MAPPER:return{needsTopicEvents:!0,topicIndices:Array.from({length:t},(e,t)=>t),description:"Loading source data for schema mapping..."};case J.Fn.KAFKA_CONNECTION:case J.Fn.CLICKHOUSE_CONNECTION:default:return{needsTopicEvents:!1,topicIndices:[],description:""}}},[]),d=(0,n.useCallback)(async e=>{try{var t,l;let{topicsStore:i,kafkaStore:n}=h.useStore.getState(),a=i.getTopic(e);if(!a||!a.name)return console.warn("No topic configured at index ".concat(e)),!1;if(null==(t=a.selectedEvent)?void 0:t.event)return console.log("Event already available for topic ".concat(a.name)),!0;let s=await ei.Y.fetchEvent(n,{topic:a.name,format:J.us.JSON,runConsumerFirst:!0,position:a.initialOffset});if(!s.success)throw Error(s.error||"Failed to fetch event");let o=(null==(l=s.data)?void 0:l.event)||s.event;if(!o)return console.warn("No event data received for topic: ".concat(a.name)),!1;let r={...a,selectedEvent:{...a.selectedEvent,event:o},events:[{event:o,topicIndex:e,position:a.initialOffset}]};return i.updateTopic(r),!0}catch(t){return console.error("Failed to fetch event for topic at index ".concat(e,":"),t),!1}},[]),u=(0,n.useCallback)(async()=>{if(r.current)return void console.log("Preloading already in progress, skipping");if(o.current===e&&a.isComplete)return void console.log("Step already preloaded, skipping");r.current=!0,o.current=e;try{let t=c(e);if(!t.needsTopicEvents||0===t.topicIndices.length)return void s({isLoading:!1,isComplete:!0,error:null,progress:{current:0,total:0,description:""}});s({isLoading:!0,isComplete:!1,error:null,progress:{current:0,total:t.topicIndices.length,description:t.description}});for(let e=0;e<t.topicIndices.length;e++){let l=t.topicIndices[e];if(s(l=>({...l,progress:{...l.progress,current:e,description:"".concat(t.description," (").concat(e+1,"/").concat(t.topicIndices.length,")")}})),!await d(l)){let e=h.useStore.getState().topicsStore.getTopic(l),t=(null==e?void 0:e.name)||"topic at index ".concat(l);throw Error("Failed to load event data for ".concat(t))}}s({isLoading:!1,isComplete:!0,error:null,progress:{current:t.topicIndices.length,total:t.topicIndices.length,description:"Data loaded successfully"}})}catch(e){console.error("Preloading failed:",e),s({isLoading:!1,isComplete:!1,error:e instanceof Error?e.message:"Failed to load required data",progress:{current:0,total:0,description:""}})}finally{r.current=!1}},[e,c,d]);(0,n.useEffect)(()=>{o.current!==e&&(console.log("Starting preload for step: ".concat(e)),u())},[e,u]);let p=(0,n.useCallback)(()=>{console.log("Retrying preload..."),o.current=null,r.current=!1,u()},[u]);return{...a,retry:p}}(t,0);(0,n.useEffect)(()=>{t&&(p(t),v(!1)),t===J.Fn.KAFKA_CONNECTION?x({[J.Fn.KAFKA_CONNECTION]:{component:W.c,title:"Kafka Connection",description:"Configure your Kafka connection settings"}}):t===J.Fn.TOPIC_SELECTION_1?x({[J.Fn.TOPIC_SELECTION_1]:{component:Y.B,title:"Kafka Topic Selection",description:"Select the Kafka topic to use"}}):t===J.Fn.TOPIC_SELECTION_2?x({[J.Fn.TOPIC_SELECTION_2]:{component:Y.B,title:"Kafka Topic Selection",description:"Select the Kafka topic to use"}}):t===J.Fn.DEDUPLICATION_CONFIGURATOR?x({[J.Fn.DEDUPLICATION_CONFIGURATOR]:{component:$.z,title:"Deduplication",description:"Configure deduplication settings"}}):t===J.Fn.TOPIC_DEDUPLICATION_CONFIGURATOR_1?x({[J.Fn.TOPIC_DEDUPLICATION_CONFIGURATOR_1]:{component:Y.B,title:"Topic Deduplication",description:"Configure topic deduplication settings"}}):t===J.Fn.TOPIC_DEDUPLICATION_CONFIGURATOR_2?x({[J.Fn.TOPIC_DEDUPLICATION_CONFIGURATOR_2]:{component:Y.B,title:"Topic Deduplication",description:"Configure topic deduplication settings"}}):t===J.Fn.JOIN_CONFIGURATOR?x({[J.Fn.JOIN_CONFIGURATOR]:{component:et.I,title:"Join Configuration",description:"Configure join settings"}}):t===J.Fn.CLICKHOUSE_CONNECTION?x({[J.Fn.CLICKHOUSE_CONNECTION]:{component:ee.w,title:"ClickHouse Connection",description:"Configure your ClickHouse connection settings"}}):t===J.Fn.CLICKHOUSE_MAPPER&&x({[J.Fn.CLICKHOUSE_MAPPER]:{component:X.g,title:"ClickHouse Mapping",description:"Configure ClickHouse table mapping"}})},[t]);let F=async()=>{if(I){E();try{await y("stop",{graceful:!0}),null==s||s("stopped"),await new Promise(e=>setTimeout(e,1e3)),v(!0),"edit"!==j?(console.log("[StandaloneStepRenderer] Entering edit mode after stopping pipeline"),N(a)):console.log("[StandaloneStepRenderer] Already in global edit mode after stopping, preserving existing changes")}catch(e){console.error("Failed to stop pipeline for editing:",e)}}};if(P.isLoading||P.error){let e=m[t];return(0,i.jsx)(en,{isLoading:P.isLoading,error:P.error,progress:P.progress,onRetry:P.retry,stepTitle:(null==e?void 0:e.title)||"Configuration Step"})}if(!P.isComplete||!t||!u||!m[u])return null;let k=m[u].component,R=m[u],D=t===J.Fn.TOPIC_DEDUPLICATION_CONFIGURATOR_1||t===J.Fn.TOPIC_DEDUPLICATION_CONFIGURATOR_2,A=t===J.Fn.TOPIC_SELECTION_1||t===J.Fn.TOPIC_SELECTION_2||t===J.Fn.TOPIC_DEDUPLICATION_CONFIGURATOR_1||t===J.Fn.TOPIC_DEDUPLICATION_CONFIGURATOR_2,L={steps:m,onCompleteStep:e=>{p(e)},validate:async()=>!0,standalone:!0,onCompleteStandaloneEditing:(e,t)=>{l()},readOnly:!g,toggleEditMode:()=>{console.log("handleToggleEditMode called",{pipelineStatus:null==a?void 0:a.status,centralizedStatus:b,effectiveStatus:C,editMode:g}),"stopped"!==C&&"terminated"!==C||g?"active"!==C&&"paused"!==C||g?"stopping"===C||"pausing"===C||"resuming"===C||"terminating"===C?console.warn("Edit mode not available while pipeline is in transitional state:",C):(console.warn("Edit mode requested for pipeline status:",C),g||(v(!0),"edit"!==j?(console.log("[StandaloneStepRenderer] Entering edit mode for first time"),N(a)):console.log("[StandaloneStepRenderer] Already in global edit mode, preserving existing changes"))):_(a,m[t]):(v(!0),"edit"!==j?(console.log("[StandaloneStepRenderer] Entering edit mode for first time"),N(a)):console.log("[StandaloneStepRenderer] Already in global edit mode, preserving existing changes"))},pipelineActionState:w,pipeline:a},U=A?{...L,currentStep:t,enableDeduplication:D}:L;return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(el,{stepInfo:R,handleBack:()=>{l()},onClose:l,isLoading:w.isLoading,loadingText:"stop"===w.lastAction?"Stopping pipeline for editing...":"resume"===w.lastAction?"Resuming pipeline...":"delete"===w.lastAction?"Deleting pipeline...":"rename"===w.lastAction?"Renaming pipeline...":"edit"===w.lastAction?"Saving pipeline configuration...":"Processing...",children:(0,i.jsx)(k,{...U})}),(0,i.jsx)(es,{visible:T,onOk:F,onCancel:E,stepName:null==O?void 0:O.title})]})};var er=l(7161),ec=l(5555);let ed=function(e){let{title:t,children:l,onClick:n,isClickable:a=!1,disabled:s=!1,validation:r,selected:c=!1}=e;return(0,i.jsx)(o.Zp,{className:(0,_.cn)("border-[var(--color-border-neutral)] radius-large p-6 h-48 flex flex-col items-center justify-center",a&&"cursor-pointer transition-all duration-200 hover:shadow-md hover:border-gray-300 hover:scale-[1.02]",s&&"opacity-50 cursor-not-allowed",(null==r?void 0:r.status)==="invalidated"&&"border-red-500",c&&"border-primary"),onClick:()=>{s||null==n||n()},children:(0,i.jsxs)("div",{className:"flex flex-col items-center justify-center gap-4",children:[(0,i.jsx)("div",{className:"flex items-center justify-center",children:l}),(0,i.jsx)("h3",{className:"text-lg font-bold text-center text-[var(--color-foreground-neutral-faded)]","text-":!0,children:t}),a&&(0,i.jsx)("p",{className:"text-sm text-gray-500 text-center",children:"Click to edit"})]})})},eu={src:"/_next/static/media/kafka.90a38d70.svg",height:20,width:20,blurWidth:0,blurHeight:0};function ep(e){let{disabled:t,selected:l,onStepClick:n}=e,a=(0,h.useStore)(e=>e.kafkaStore.validation);return(0,i.jsxs)("div",{className:"flex flex-col gap-4 w-1/5",children:[(0,i.jsx)("div",{className:"text-center",children:(0,i.jsx)("span",{className:"text-lg font-bold",children:"Source"})}),(0,i.jsx)(ed,{validation:a,title:"Kafka",onClick:()=>n(J.Fn.KAFKA_CONNECTION),disabled:t,selected:l,children:(0,i.jsx)(g.default,{src:eu,alt:"Kafka",className:"w-8 h-8",width:32,height:32})})]})}function em(e){let{disabled:t,selected:l,onStepClick:n}=e,a=(0,h.useStore)(e=>e.clickhouseConnectionStore.validation);return(0,i.jsxs)("div",{className:"flex flex-col gap-4 w-1/5",children:[(0,i.jsx)("div",{className:"text-center",children:(0,i.jsx)("span",{className:"text-lg font-bold",children:"Sink"})}),(0,i.jsx)(ed,{validation:a,title:"ClickHouse",onClick:()=>n(J.Fn.CLICKHOUSE_CONNECTION),disabled:t,selected:l,children:(0,i.jsx)(g.default,{src:H,alt:"ClickHouse",className:"w-8 h-8",width:32,height:32})})]})}let ef=function(e){let{pipeline:t}=e,l=(0,er.useRouter)(),[a,s]=(0,n.useState)(t),[o,r]=(0,n.useState)(null),[c,d]=(0,n.useState)(!1),[u,p]=(0,n.useState)(!1),[m,x]=(0,n.useState)(!1),{actionState:g}=(0,f.z)(a),v=(0,S.c7)(),N=(0,h.useStore)(e=>e.kafkaStore.validation),j=(0,h.useStore)(e=>e.clickhouseConnectionStore.validation),b=(0,h.useStore)(e=>e.clickhouseDestinationStore.validation),C=(0,h.useStore)(e=>e.joinStore.validation),y=(0,h.useStore)(e=>e.topicsStore.validation),w=(0,h.useStore)(e=>e.deduplicationStore.validation),{coreStore:T}=(0,h.useStore)(),{enterViewMode:I,mode:O}=T,P=(0,ec.rT)(a.status)||g.isLoading,F=(0,n.useCallback)(async()=>{try{let e=await (0,R.B0)(a.pipeline_id);s(e)}catch(e){console.error("Failed to refresh pipeline data:",e)}},[a.pipeline_id,a.status]);(0,n.useEffect)(()=>{(async()=>{if(a&&(null==a?void 0:a.source)&&(null==a?void 0:a.sink)&&!1===g.isLoading&&"edit"!==O){let e="".concat(a.pipeline_id,"-").concat(a.name);if(sessionStorage.getItem("lastHydratedPipeline")===e)return console.log("[PipelineDetailsModule] Already hydrated, skipping:",e);console.log("[PipelineDetailsModule] Hydrating pipeline:",e);try{await I(a),sessionStorage.setItem("lastHydratedPipeline",e)}catch(e){console.error("Failed to hydrate pipeline data:",e)}}})()},[a,I,O,g.isLoading,g.lastAction]),(0,n.useEffect)(()=>{d(!0);let e=setTimeout(()=>{p(!0)},500),t=setTimeout(()=>{x(!0)},1e3);return()=>{clearTimeout(e),clearTimeout(t)}},[]),(0,n.useEffect)(()=>{if(!g.isLoading&&g.lastAction)if("stop"===g.lastAction)v.reportStop(a.pipeline_id);else if("resume"===g.lastAction)v.reportResume(a.pipeline_id);else if("terminate"===g.lastAction)v.reportTerminate(a.pipeline_id);else{let e=setTimeout(()=>{F()},500);return()=>clearTimeout(e)}},[g.isLoading,g.lastAction,a.pipeline_id,F,v]);let k=e=>{P||r(e)},D=new Set([J.Fn.KAFKA_CONNECTION]);J.Fn.TOPIC_SELECTION_1,J.Fn.TOPIC_SELECTION_2,J.Fn.DEDUPLICATION_CONFIGURATOR,J.Fn.TOPIC_DEDUPLICATION_CONFIGURATOR_1,J.Fn.TOPIC_DEDUPLICATION_CONFIGURATOR_2,J.Fn.JOIN_CONFIGURATOR,J.Fn.CLICKHOUSE_MAPPER;let A=new Set([J.Fn.CLICKHOUSE_CONNECTION]),L=!!o&&D.has(o),U=!!o&&A.has(o);return(0,i.jsxs)("div",{children:[(0,i.jsx)(E,{pipeline:a,onPipelineUpdate:e=>{s(e)},onPipelineDeleted:()=>{l.push("/pipelines")},showHeader:c}),(0,i.jsx)(G,{pipeline:a,showStatusOverview:u}),(0,i.jsxs)("div",{className:(0,_.cn)("flex flex-row gap-4 items-stretch transition-all duration-750 ease-out",m?"opacity-100 translate-y-0":"opacity-0 translate-y-4"),children:[(0,i.jsx)(ep,{disabled:P,selected:L,onStepClick:k}),(0,i.jsx)(q,{pipeline:a,onStepClick:k,disabled:P,validation:{kafkaValidation:N,topicsValidation:y,joinValidation:C,deduplicationValidation:w,clickhouseConnectionValidation:j,clickhouseDestinationValidation:b},activeStep:o}),(0,i.jsx)(em,{disabled:P,selected:U,onStepClick:k})]}),o&&(0,i.jsx)(eo,{stepKey:o,onClose:()=>{r(null)},pipeline:a,onPipelineStatusUpdate:e=>{s(t=>({...t,status:e}))}})]})}},1902:(e,t,l)=>{Promise.resolve().then(l.bind(l,3096)),Promise.resolve().then(l.bind(l,869)),Promise.resolve().then(l.bind(l,132))},3096:(e,t,l)=>{"use strict";l.d(t,{default:()=>C});var i=l(1929),n=l(2477),a=l(7161),s=l(1475),o=l(869),r=l(4903),c=l(3427),d=l(8387);let u={src:"/_next/static/media/icon-check-green.052d5738.svg",height:11,width:16,blurWidth:0,blurHeight:0},p={src:"/_next/static/media/icon-x-red.c87d8f17.svg",height:12,width:12,blurWidth:0,blurHeight:0};var m=l(9596),f=l(5855);let x=e=>{let{label:t}=e;return(0,i.jsxs)("div",{className:"flex items-center gap-3",children:[(0,i.jsx)("div",{className:"flex-shrink-0 w-5 h-5 flex items-center justify-center",children:(0,i.jsx)(m.default,{src:u,alt:"Success",width:16,height:16})}),(0,i.jsx)("span",{className:"text-sm",children:t})]})},h=e=>{let{label:t}=e;return(0,i.jsxs)("div",{className:"flex items-center gap-3",children:[(0,i.jsx)("div",{className:"flex-shrink-0 w-5 h-5 flex items-center justify-center",children:(0,i.jsx)(m.default,{src:p,alt:"Failed",width:16,height:16})}),(0,i.jsx)("span",{className:"text-sm",children:t})]})},g=e=>{let{label:t}=e;return(0,i.jsxs)("div",{className:"flex items-center gap-3",children:[(0,i.jsx)("div",{className:"flex-shrink-0 w-5 h-5 flex items-center justify-center",children:(0,i.jsx)(m.default,{src:f.A,alt:"Loading",width:16,height:16})}),(0,i.jsx)("span",{className:"text-sm",children:t})]})},v=e=>{let{deploymentPhase:t}=e;return(0,i.jsx)("div",{className:"flex items-center gap-3",children:"deploying"===t?(0,i.jsx)(g,{label:"Deploying..."}):"deployed"===t?(0,i.jsx)(x,{label:"Pipeline deployed."}):"failed"===t?(0,i.jsx)(h,{label:"Deployment failed."}):(0,i.jsx)(g,{label:"Loading..."})})},N=e=>{let{pipelineId:t,pipelineName:l,onDeploymentComplete:a,onDeploymentFailed:s,onNavigateToList:o}=e,[u,p]=(0,n.useState)(!1),{deploymentPhase:m,deploymentHistory:f,error:h,isPolling:g,retryDeployment:N,timeoutReached:j}=(e=>{let{pipelineId:t,onDeploymentComplete:l,onDeploymentFailed:i,maxDeploymentTime:a=3e5,autoNavigateDelay:s=2e3}=e,[o,r]=(0,n.useState)("created"),[d,u]=(0,n.useState)([]),[p,m]=(0,n.useState)(null),[f,x]=(0,n.useState)(!1),[h]=(0,n.useState)(Date.now()),g=(0,n.useCallback)((e,t,l)=>{let i={phase:e,message:t,timestamp:new Date,error:l};u(e=>[...e,i])},[]);(0,n.useEffect)(()=>{g("created","Pipeline configuration saved successfully");let e=setTimeout(()=>{r("deploying"),g("deploying","Starting pipeline deployment...")},1500);return()=>clearTimeout(e)},[g]),(0,n.useEffect)(()=>{let e=setTimeout(()=>{if("deploying"===o){x(!0),r("failed");let e="Deployment timeout: Pipeline took too long to deploy";m(e),g("failed","Deployment timed out after 5 minutes",e),setTimeout(()=>{null==i||i(e)},s)}},a);return()=>clearTimeout(e)},[o,a,g,i]);let{health:v,isLoading:N,error:j}=(0,c.O)({pipelineId:t,enabled:"deploying"===o&&!f,pollingInterval:2e3,stopOnStatuses:["Running","Failed","Terminated"],maxRetries:5,onStatusChange:(e,t)=>{if(console.log("[DeploymentProgress] Status change: ".concat(t," → ").concat(e)),"Running"===e)r("deployed"),g("deployed","Pipeline deployed successfully and is now running"),setTimeout(()=>{null==l||l()},s);else if("Failed"===e||"Terminated"===e){r("failed");let t="Failed"===e?"Pipeline deployment failed":"Pipeline was terminated during deployment";m(t),g("failed",t,t),setTimeout(()=>{null==i||i(t)},s)}},onError:e=>{console.error("[DeploymentProgress] Health check error:",e);let t=Date.now()-h,l=404===e.code||500===e.code;if(t>3e4||l){r("failed");let t="Deployment monitoring failed: ".concat(e.message);m(t),g("failed","Unable to monitor deployment progress",t),setTimeout(()=>{null==i||i(t)},s)}}});return{deploymentPhase:o,deploymentHistory:d,error:p,isPolling:N&&"deploying"===o,retryDeployment:(0,n.useCallback)(()=>{r("deploying"),m(null),x(!1),g("deploying","Retrying pipeline deployment...")},[g]),timeoutReached:f}})({pipelineId:t,onDeploymentComplete:()=>{p(!0),setTimeout(()=>{a()},1e3)},onDeploymentFailed:e=>{p(!0),setTimeout(()=>{null==s||s(e)},1e3)}});return(0,i.jsx)("div",{className:(0,d.cn)("transition-opacity duration-500",u&&"opacity-0"),children:(0,i.jsx)("div",{className:"flex flex-col gap-4",children:(0,i.jsx)(r.Zp,{className:"border-[var(--color-border-neutral)] radius-large py-2 px-6 mb-4",children:(0,i.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,i.jsx)("div",{className:"flex flex-col flex-start gap-2",children:(0,i.jsx)("h2",{className:"text-2xl font-bold",children:l})}),(0,i.jsx)(x,{label:"Pipeline created."}),(0,i.jsx)(v,{deploymentPhase:m})]})})})})};var j=l(132),b=l(8090);function C(e){let{pipelineId:t}=e,[l,r]=(0,n.useState)(null),[c,d]=(0,n.useState)(!0),[u,p]=(0,n.useState)(null),[m,f]=(0,n.useState)(!1),[x,h]=(0,n.useState)(!1),g=(0,a.useSearchParams)(),v=(0,a.useRouter)(),C=(null==g?void 0:g.get("deployment"))==="progress",{coreStore:y}=(0,b.useStore)(),{pipelineName:w}=y;if((0,n.useEffect)(()=>{if(C){h(!0),d(!1);return}(async()=>{try{d(!0),p(null),f(!1);let e=await (0,s.B0)(t);r(e)}catch(e){console.error("Failed to fetch pipeline:",e),(null==e?void 0:e.code)===404?f(!0):p(e.message||"Failed to fetch pipeline")}finally{d(!1)}})()},[t,C]),c)return(0,i.jsx)("div",{className:"flex items-center justify-center min-h-[400px]",children:(0,i.jsxs)("div",{className:"text-center",children:[(0,i.jsx)("div",{className:"animate-spin h-8 w-8 border-4 border-blue-500 border-t-transparent rounded-full mx-auto mb-4"}),(0,i.jsx)("p",{className:"text-gray-600",children:"Loading pipeline details..."})]})});if(m)return(0,i.jsx)(j.PipelineNotFound,{pipelineId:t});if(u)return(0,i.jsx)("div",{className:"flex items-center justify-center min-h-[400px]",children:(0,i.jsxs)("div",{className:"text-center",children:[(0,i.jsx)("div",{className:"text-red-500 text-lg font-semibold mb-2",children:"Error"}),(0,i.jsx)("p",{className:"text-gray-600 mb-4",children:u}),(0,i.jsx)("button",{onClick:()=>window.location.reload(),className:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600 transition-colors",children:"Retry"})]})});if(x){let e=w||"Pipeline ".concat(t.slice(0,8));return(0,i.jsx)("div",{children:(0,i.jsx)(N,{pipelineId:t,pipelineName:e,onDeploymentComplete:()=>{h(!1),v.replace("/pipelines/".concat(t)),(async()=>{try{d(!0),p(null),f(!1);let e=await (0,s.B0)(t);r(e)}catch(e){console.error("Failed to fetch pipeline after deployment:",e),(null==e?void 0:e.code)===404?f(!0):p(e.message||"Failed to fetch pipeline")}finally{d(!1)}})()},onDeploymentFailed:e=>{console.error("Pipeline deployment failed:",e),v.push("/pipelines")},onNavigateToList:()=>{v.push("/pipelines")}})})}return l?(0,i.jsx)(o.default,{pipeline:l}):(0,i.jsx)("div",{className:"flex items-center justify-center min-h-[400px]",children:(0,i.jsxs)("div",{className:"text-center",children:[(0,i.jsx)("div",{className:"text-gray-500 text-lg font-semibold mb-2",children:"Pipeline Not Found"}),(0,i.jsxs)("p",{className:"text-gray-600",children:['Pipeline with ID "',t,'" could not be found.']})]})})}},3427:(e,t,l)=>{"use strict";l.d(t,{O:()=>a});var i=l(2477),n=l(7323);let a=e=>{let{pipelineId:t,enabled:l=!0,pollingInterval:a=5e3,onStatusChange:s,onError:o,onHealthUpdate:r,stopOnStatuses:c=["Running","Terminated","Failed"],maxRetries:d=3}=e,[u,p]=(0,i.useState)(null),[m,f]=(0,i.useState)(!1),[x,h]=(0,i.useState)(null),[g,v]=(0,i.useState)(!1),[N,j]=(0,i.useState)(!1),[b,C]=(0,i.useState)(0),y=(0,i.useRef)(null),w=(0,i.useRef)(null);console.log("[usePipelineHealth] Pipeline: ".concat(t,", enabled: ").concat(l,", started: ").concat(g,", stopped: ").concat(N));let T=(0,i.useCallback)(async()=>{if(!l||!t||N)return void console.log("[usePipelineHealth] Skipping fetch - enabled: ".concat(l,", pipelineId: ").concat(!!t,", stopped: ").concat(N));console.log("[usePipelineHealth] Fetching health for ".concat(t)),f(!0);try{let e=await (0,n.nk)(t),i=e.overall_status,o=w.current;if(console.log("[usePipelineHealth] Got status: ".concat(i," for ").concat(t)),p(e),h(null),C(0),w.current=i,o!==i&&(null==s||s(i,o)),null==r||r(e),c.includes(i)){console.log("[usePipelineHealth] Status ".concat(i," is final, stopping polling for ").concat(t)),j(!0),y.current&&(clearTimeout(y.current),y.current=null);return}!N&&l&&(y.current=setTimeout(T,a),console.log("[usePipelineHealth] Scheduled next fetch in ".concat(a,"ms for ").concat(t)))}catch(i){let e=b+1;if(console.log("[usePipelineHealth] Error ".concat(i.code," for ").concat(t,", count: ").concat(e,"/").concat(d)),h(i),C(e),null==o||o(i),404===i.code||i.code>=500||e>=d){console.log("[usePipelineHealth] Critical error or max retries reached, stopping polling for ".concat(t)),j(!0),y.current&&(clearTimeout(y.current),y.current=null);return}!N&&l&&(y.current=setTimeout(T,a),console.log("[usePipelineHealth] Scheduled retry in ".concat(a,"ms for ").concat(t)))}finally{f(!1)}},[t,l,N,b,d,a,s,o,r,c]);(0,i.useEffect)(()=>{l&&t&&!g&&!N&&(console.log("[usePipelineHealth] Starting health monitoring for ".concat(t)),v(!0),T())},[l,t,g,N,T]),(0,i.useEffect)(()=>()=>{console.log("[usePipelineHealth] Cleanup for ".concat(t)),y.current&&(clearTimeout(y.current),y.current=null)},[t]);let I=(0,i.useCallback)(()=>{N||(v(!0),T())},[N,T]),S=(0,i.useCallback)(()=>{console.log("[usePipelineHealth] Manual stop for ".concat(t)),j(!0),y.current&&(clearTimeout(y.current),y.current=null)},[t]),O=(0,i.useCallback)(async()=>{N||await T()},[N,T]);return{health:u,isLoading:m,error:x,isPolling:g&&!N,refetch:O,startPolling:I,stopPolling:S}}}},e=>{e.O(0,[2270,2765,3878,5993,5037,6460,1279,3797,6091,3736,3888,5704,7358],()=>e(e.s=1902)),_N_E=e.O()}]);